% Created 2021-09-16 Thu 16:47
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
% \usepackage{hyperref}
\usepackage{minted}
\usepackage[dvipsnames]{xcolor}
\usemintedstyle{}
\usepackage[hidelinks]{hyperref}
\hypersetup{
     colorlinks=true,
     linkcolor=Purple,
     filecolor=black,
     citecolor =black,      
     urlcolor=blue,
     }
\date{\today}
\title{}
\hypersetup{
 pdfauthor={},
 pdftitle={},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 27.2 (Org mode 9.4.4)}, 
 pdflang={English}}
\begin{document}

\tableofcontents


\section{Infarto}
\label{sec:org8b1d153}
\subsection{Download de pacotes}
\label{sec:org84177f4}
\subsubsection{Fixando Reposit√≥rio}
\label{sec:org55f917c}
\href{https://stackoverflow.com/questions/1189759/expert-r-users-whats-in-your-rprofile/1189826\#1189826}{Fix repository from Brazil}
\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
r = getOption("repos")  # hard code the BR repo for CRAN
r["CRAN"] = "https://vps.fmvz.usp.br/CRAN/" # usp repository
options(repos = r)
## rm(r)
\end{minted}

\subsubsection{Instalando pacotes}
\label{sec:orgaced5fe}

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
install.packages(c("tidyverse","janitor","glmnet","ggthemes","patchwork"))
\end{minted}


\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
  library(tidyverse)
  library(janitor)
#  library(glmnet)
  library(ggthemes)
  library(patchwork)
\end{minted}

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
heart_data <- readr::read_csv("~/PP/MonitoriaEstatistica/data/csv/infarto_logistica.csv") %>% janitor::clean_names() %>% janitor::remove_empty(which = "rows") %>% as.data.frame() %>% na.omit()
\end{minted}

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
heart_data[1:10,]
\end{minted}



\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
set.seed(1234)

trein <- sample(1:nrow(heart_data), round(0.8 * nrow(heart_data), digits = 0))
test <- setdiff(1:nrow(heart_data), train)

heart_data_train_x <- model.matrix(object = morte ~ ., data = heart_data[train, ])[, -1]
heart_data_train_y <- factor(heart_data[train, "morte"])

success_rates <- vector(mode = "double", length = 3)
names(success_rates) <- c("lasso", "ridge", "logistic")
\end{minted}

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
glm_heart_model <- glm(formula = morte ~ ., data = heart_data[train, ], family = "binomial")
\end{minted}

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
glm_heart_predict <- predict(object = glm_heart_model, newdata = heart_data[test, ], type = "response")

glm_heart_classes <- ifelse(glm_heart_predict > 0.5, 1, 0)


success_rates["logistic"] <- round(mean(ifelse(glm_heart_classes == heart_data[test, "morte"], 1, 0)), digits = 2)

success_rates["logistic"]

table(glm_heart_classes, heart_data[test, "morte"])
\end{minted}


\begin{itemize}
\item \textbf{logistic}: 0.85 
\begin{center}
\begin{tabular}{rrr}
\hline
glm\textsubscript{heart}\textsubscript{classes} & 0 & 1\\
0 & 38 & 4\\
1 & 5 & 13\\
\hline
\end{tabular}
\end{center}
\end{itemize}


\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{r}
summary(heart_data)
\end{minted}
\end{document}