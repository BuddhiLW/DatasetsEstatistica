#+LATEX_COMPILER: xelatex

#+STARTUP: latexpreview

#+LATEX_HEADER: \hypersetup{colorlinks, allcolors=., urlcolor=blue!70!white}

#+LATEX_HEADER: \usepackage{minted}
#+LATEX_HEADER: \usemintedstyle{lovelace}

* Análise de Regressão Linear Múltipla, Conjuntos de Dados
** [[https://www.kaggle.com/augustus0498/life-expectancy-who][Expectativa de Vida por País]] (normal)
+ *Modelar a variável expectativa de vida*
*** Sobre o =Conjunto=
+ Dados de todos países, derivados da OMS.
  # + Dividir em até 5 anos. (
  + Dados:
    - Country: país,
    - Year: ano correspondente aos dados,
    - Status: estado da industrialização,
    - Life expectancy: expectativa de vida,
    - Adult Mortality $15<\text{idade}<60$: mortalidade adulta por mil habitantes,
    - Infant deaths: mortalidade infantil por mil habitantes,
    - Alcohol: uso de álcool por litro puro (+15 anos),
    - Percentage expenditure: gasto em saúde em percentagem do PIB per capta,
    - Hepatitis B: percentagem de imunização entre bebês com um ano,
    - Measles: quantidade de casos reportados de Rubeola por mil habitantes,
    - BMI: média de index de massa corpórea da população,
    - under-five deaths: quantidade de mortes antes dos cinco anos por mil habitantes,
    - Polio: quantidade de imunização entre bebês com um ano (percentagem),
    - Total expenditure: percentagem do gasto total do governo com saúde,
    - Diphtheria: percentagem de imunização de tétano ($\leq 1 \text{ano}$),
    - HIV/AIDS: morte a cada mil nascimentos (contanto nascimento de 0-4 anos de idade),
    - GDP: PIB em dólares,
    - Population: População,
    - thinness  1-19 years: prevalescência de pessoas magras (1-19 anos de idade),
    - thinness 5-9 years: prevalescência de pessoas magras (5-9 anos de idade),
    - Income composition of resources: IDH (qualidade de vida) em termos de composição por salário pessoal (provida por salário próprio),
    - Schooling: média do número de anos sendo educado (escolaridade).

*** Como utilizar o conjunto (cópia de arquivo CSV, localmente)
O =conjunto= apenas está disponível por meio da [[https://drive.google.com/file/d/1nUnOwgAcWIqoyG0P5_wnlh1wPxxSUqv5/view?usp=sharing][cópia da núvem]], para o
computador local. Após baixar o arquivo =Life_Expectancy_Data.csv=,
para seu computador, a análise deve ser feita, em relação a um
determinado ano, a qual foi indicado ao grupo.

Por exemplo, para a análise da expectativa de vida, para o ano de
2015, seria feita invocamos os dados da seguinte maneira,


#+NAME: c68f6b03-814d-4891-9250-cb588701bf1a
#+begin_src ein-r :session localhost :results output :exports both :eval 
  life <- read.csv('./data/csv/Life_Expectancy_Data.csv')
  life_2015 <- subset(life, Year=="2015")
  life_2015[1:6,1:5] 
#+end_src

#+RESULTS: c68f6b03-814d-4891-9250-cb588701bf1a
:    Country             Year Status     Life.expectancy Adult.Mortality
: 1  Afghanistan         2015 Developing 65.0            263            
: 17 Albania             2015 Developing 77.8             74            
: 33 Algeria             2015 Developing 75.6             19            
: 49 Angola              2015 Developing 52.4            335            
: 65 Antigua and Barbuda 2015 Developing 76.4             13            
: 81 Argentina           2015 Developing 76.3            116            

Obs: apenas 5 colunas foram selecionadas, por motivos estéticos na formatação.

*** Regressão e Teste de Shapiro (normal) 

**** Retirar valores do nome dos países e o ano.
#+NAME: b6daddd6-83e0-4db8-97db-1d1024d60b60
#+begin_src ein-r :session localhost :results output :exports both :eval 
  life_2015_clean <- subset(life_2015, select=-c(Country, Year))
  ## life_2015_clean <- na.omit(life_2015_clean)
#+end_src

#+RESULTS: b6daddd6-83e0-4db8-97db-1d1024d60b60

**** Transformar a variável categórica =Status= em numérica
Em que teremos:
- Developed: 1
- Developing: 2
  
#+NAME: 05298705-f04e-47df-b7f0-ca8bd2d0ef4c
#+begin_src ein-r :session localhost :results output :exports both :eval 
  life_2015_clean$Status <- as.numeric(as.factor(life_2015_clean$Status))
  ## life_2015_clean <- na.omit(life_2015_clean) ## eliminando muitos dados.
  summary(life_2015_clean)
#+end_src

#+RESULTS: 05298705-f04e-47df-b7f0-ca8bd2d0ef4c
#+begin_example
     Status      Life.expectancy Adult.Mortality infant.deaths  
 Min.   :1.000   Min.   :51.00   Min.   :  1.0   Min.   :  0.0  
 1st Qu.:2.000   1st Qu.:65.75   1st Qu.: 74.0   1st Qu.:  0.0  
 Median :2.000   Median :73.90   Median :138.0   Median :  2.0  
 Mean   :1.825   Mean   :71.62   Mean   :152.9   Mean   : 23.8  
 3rd Qu.:2.000   3rd Qu.:76.95   3rd Qu.:213.0   3rd Qu.: 17.0  
 Max.   :2.000   Max.   :88.00   Max.   :484.0   Max.   :910.0  
                                                                
    Alcohol       percentage.expenditure  Hepatitis.B       Measles     
 Min.   : 0.010   Min.   :  0.000        Min.   : 6.00   Min.   :    0  
 1st Qu.: 2.493   1st Qu.:  0.000        1st Qu.:78.75   1st Qu.:    0  
 Median : 5.285   Median :  0.000        Median :93.00   Median :   17  
 Mean   : 5.288   Mean   :  2.384        Mean   :82.43   Mean   : 1503  
 3rd Qu.: 8.018   3rd Qu.:  0.000        3rd Qu.:97.00   3rd Qu.:  202  
 Max.   :10.660   Max.   :364.975        Max.   :99.00   Max.   :90387  
 NA's   :177                             NA's   :9                      
      BMI        under.five.deaths     Polio       Total.expenditure
 Min.   : 2.50   Min.   :   0.00   Min.   : 5.00   Min.   :6.00     
 1st Qu.:24.30   1st Qu.:   0.00   1st Qu.:83.00   1st Qu.:6.54     
 Median :48.60   Median :   3.00   Median :93.00   Median :7.08     
 Mean   :42.75   Mean   :  31.61   Mean   :83.21   Mean   :7.08     
 3rd Qu.:61.40   3rd Qu.:  21.00   3rd Qu.:97.00   3rd Qu.:7.62     
 Max.   :77.60   Max.   :1100.00   Max.   :99.00   Max.   :8.16     
 NA's   :2                                         NA's   :181      
   Diphtheria       HIV.AIDS           GDP             Population       
 Min.   : 6.00   Min.   :0.1000   Min.   :   33.68   Min.   :     2966  
 1st Qu.:83.50   1st Qu.:0.1000   1st Qu.:  766.01   1st Qu.:   268071  
 Median :93.00   Median :0.1000   Median : 2916.23   Median :  2076086  
 Mean   :84.63   Mean   :0.6607   Mean   : 7185.33   Mean   : 11097408  
 3rd Qu.:97.00   3rd Qu.:0.4000   3rd Qu.: 7290.11   3rd Qu.:  9940296  
 Max.   :99.00   Max.   :9.3000   Max.   :66346.52   Max.   :258162113  
                                  NA's   :29         NA's   :41         
 thinness..1.19.years thinness.5.9.years Income.composition.of.resources
 Min.   : 0.100       Min.   : 0.100     Min.   :0.3470                 
 1st Qu.: 1.500       1st Qu.: 1.500     1st Qu.:0.5650                 
 Median : 3.500       Median : 3.400     Median :0.7230                 
 Mean   : 4.535       Mean   : 4.576     Mean   :0.6917                 
 3rd Qu.: 6.500       3rd Qu.: 6.400     3rd Qu.:0.7980                 
 Max.   :26.700       Max.   :27.300     Max.   :0.9480                 
 NA's   :2            NA's   :2          NA's   :10                     
   Schooling    
 Min.   : 4.90  
 1st Qu.:10.80  
 Median :13.10  
 Mean   :12.93  
 3rd Qu.:15.00  
 Max.   :20.40  
 NA's   :10     
#+end_example

**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

*Tirar Alcohol, Total.expenditure*

#+NAME: ee79fb56-9cc3-47c7-9101-9634783821d0
#+begin_src ein-r :session localhost :results output
  life_2015_clean<- subset(life_2015_clean, select=-c(Alcohol, Total.expenditure))
  life_2015_clean <- na.omit(life_2015_clean) ## eliminando muitos dados.
#+end_src

#+RESULTS: ee79fb56-9cc3-47c7-9101-9634783821d0

#+NAME: 3a303e30-4e78-44e1-b283-28addd8f5384
#+begin_src ein-r :session localhost :results output :exports both :eval
  modreg_trein <- lm(Life.expectancy ~ Status + Adult.Mortality + infant.deaths  + percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + Polio + Diphtheria + HIV.AIDS + GDP + Population + thinness..1.19.years + thinness.5.9.years + Income.composition.of.resources + Schooling , life_2015_clean)

  summary(modreg_trein)
#+end_src

#+RESULTS: 3a303e30-4e78-44e1-b283-28addd8f5384
#+begin_example

Call:
lm(formula = Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + GDP + Population + thinness..1.19.years + 
    thinness.5.9.years + Income.composition.of.resources + Schooling, 
    data = life_2015_clean)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.3326 -1.4047  0.0247  1.5478  7.9440 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      5.083e+01  3.024e+00  16.807  < 2e-16 ***
Status                          -3.824e-01  8.332e-01  -0.459   0.6472    
Adult.Mortality                 -2.077e-02  3.619e-03  -5.738 8.29e-08 ***
infant.deaths                    6.626e-02  3.291e-02   2.013   0.0465 *  
percentage.expenditure           5.575e-03  7.362e-03   0.757   0.4505    
Hepatitis.B                      4.311e-02  2.264e-02   1.904   0.0595 .  
Measles                         -5.027e-05  5.741e-05  -0.876   0.3832    
BMI                             -9.085e-03  1.554e-02  -0.585   0.5600    
under.five.deaths               -4.811e-02  2.359e-02  -2.040   0.0437 *  
Polio                            1.179e-02  1.271e-02   0.928   0.3553    
Diphtheria                      -1.148e-02  2.636e-02  -0.435   0.6641    
HIV.AIDS                        -4.858e-01  2.243e-01  -2.166   0.0324 *  
GDP                              5.950e-06  3.011e-05   0.198   0.8437    
Population                      -7.918e-10  9.586e-09  -0.083   0.9343    
thinness..1.19.years            -1.192e-01  2.343e-01  -0.509   0.6119    
thinness.5.9.years              -2.030e-02  2.291e-01  -0.089   0.9296    
Income.composition.of.resources  3.331e+01  4.991e+00   6.674 9.93e-10 ***
Schooling                       -5.244e-02  2.407e-01  -0.218   0.8279    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.7 on 112 degrees of freedom
Multiple R-squared:  0.901,	Adjusted R-squared:  0.886 
F-statistic: 59.99 on 17 and 112 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+NAME: 2a9c6b83-520d-40c3-a56f-52df66b075d6
#+begin_src ein-r :session localhost :results output
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 368cdd27-5a4e-4051-8d74-487355d913e7
#+begin_src ein-r :session localhost :results output
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 368cdd27-5a4e-4051-8d74-487355d913e7
#+begin_example
Start:  AIC=274.86
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + GDP + Population + thinness..1.19.years + 
    thinness.5.9.years + Income.composition.of.resources + Schooling

                                  Df Sum of Sq     RSS    AIC
- Population                       1      0.05  816.45 272.87
- thinness.5.9.years               1      0.06  816.46 272.87
- GDP                              1      0.28  816.69 272.90
- Schooling                        1      0.35  816.75 272.91
- Diphtheria                       1      1.38  817.79 273.08
- Status                           1      1.54  817.94 273.10
- thinness..1.19.years             1      1.89  818.29 273.16
- BMI                              1      2.49  818.89 273.25
- percentage.expenditure           1      4.18  820.58 273.52
- Measles                          1      5.59  821.99 273.75
- Polio                            1      6.28  822.68 273.85
<none>                                          816.40 274.86
- Hepatitis.B                      1     26.43  842.83 277.00
- infant.deaths                    1     29.55  845.95 277.48
- under.five.deaths                1     30.32  846.73 277.60
- HIV.AIDS                         1     34.20  850.60 278.19
- Adult.Mortality                  1    239.99 1056.40 306.36
- Income.composition.of.resources  1    324.69 1141.10 316.39

Step:  AIC=272.87
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + GDP + thinness..1.19.years + 
    thinness.5.9.years + Income.composition.of.resources + Schooling

                                  Df Sum of Sq     RSS    AIC
- thinness.5.9.years               1      0.05  816.51 270.88
- GDP                              1      0.27  816.73 270.91
- Schooling                        1      0.36  816.81 270.92
- Diphtheria                       1      1.40  817.85 271.09
- Status                           1      1.56  818.01 271.12
- thinness..1.19.years             1      1.88  818.33 271.17
- BMI                              1      2.46  818.91 271.26
- percentage.expenditure           1      4.21  820.66 271.54
- Measles                          1      5.56  822.02 271.75
- Polio                            1      7.25  823.70 272.02
<none>                                          816.45 272.87
+ Population                       1      0.05  816.40 274.86
- Hepatitis.B                      1     26.38  842.83 275.00
- infant.deaths                    1     32.68  849.13 275.97
- HIV.AIDS                         1     34.17  850.62 276.20
- under.five.deaths                1     35.22  851.68 276.36
- Adult.Mortality                  1    239.98 1056.44 304.37
- Income.composition.of.resources  1    325.09 1141.55 314.44

Step:  AIC=270.88
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + GDP + thinness..1.19.years + 
    Income.composition.of.resources + Schooling

                                  Df Sum of Sq     RSS    AIC
- GDP                              1      0.28  816.79 268.92
- Schooling                        1      0.37  816.88 268.94
- Diphtheria                       1      1.35  817.86 269.09
- Status                           1      1.58  818.09 269.13
- BMI                              1      2.41  818.91 269.26
- percentage.expenditure           1      4.19  820.70 269.54
- Measles                          1      5.51  822.02 269.75
- Polio                            1      7.20  823.70 270.02
<none>                                          816.51 270.88
- thinness..1.19.years             1     19.56  836.07 271.95
+ thinness.5.9.years               1      0.05  816.45 272.87
+ Population                       1      0.05  816.46 272.87
- Hepatitis.B                      1     26.40  842.90 273.01
- infant.deaths                    1     32.94  849.45 274.02
- HIV.AIDS                         1     34.89  851.39 274.31
- under.five.deaths                1     35.45  851.96 274.40
- Adult.Mortality                  1    244.68 1061.19 302.95
- Income.composition.of.resources  1    325.05 1141.56 312.44

Step:  AIC=268.92
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + thinness..1.19.years + Income.composition.of.resources + 
    Schooling

                                  Df Sum of Sq     RSS    AIC
- Schooling                        1      0.29  817.08 266.97
- Diphtheria                       1      1.23  818.01 267.12
- Status                           1      1.89  818.68 267.22
- BMI                              1      2.31  819.10 267.29
- percentage.expenditure           1      4.11  820.90 267.57
- Measles                          1      5.58  822.37 267.81
- Polio                            1      7.20  823.99 268.06
<none>                                          816.79 268.92
- thinness..1.19.years             1     19.39  836.18 269.97
+ GDP                              1      0.28  816.51 270.88
+ thinness.5.9.years               1      0.06  816.73 270.91
+ Population                       1      0.04  816.75 270.91
- Hepatitis.B                      1     26.16  842.94 271.02
- infant.deaths                    1     32.75  849.54 272.03
- HIV.AIDS                         1     34.62  851.41 272.32
- under.five.deaths                1     35.23  852.02 272.41
- Adult.Mortality                  1    245.77 1062.56 301.12
- Income.composition.of.resources  1    328.04 1144.83 310.81

Step:  AIC=266.97
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + Diphtheria + HIV.AIDS + thinness..1.19.years + Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- Diphtheria                       1      1.15  818.23 265.15
- Status                           1      1.72  818.80 265.24
- BMI                              1      2.52  819.60 265.37
- percentage.expenditure           1      4.07  821.16 265.61
- Measles                          1      6.00  823.08 265.92
- Polio                            1      7.51  824.59 266.16
<none>                                          817.08 266.97
- thinness..1.19.years             1     19.49  836.57 268.03
+ Schooling                        1      0.29  816.79 268.92
+ GDP                              1      0.20  816.88 268.93
+ thinness.5.9.years               1      0.07  817.01 268.96
+ Population                       1      0.05  817.03 268.96
- Hepatitis.B                      1     25.89  842.97 269.02
- infant.deaths                    1     33.29  850.37 270.16
- HIV.AIDS                         1     34.75  851.83 270.38
- under.five.deaths                1     35.56  852.64 270.51
- Adult.Mortality                  1    259.25 1076.33 300.79
- Income.composition.of.resources  1    896.12 1713.20 361.22

Step:  AIC=265.15
Life.expectancy ~ Status + Adult.Mortality + infant.deaths + 
    percentage.expenditure + Hepatitis.B + Measles + BMI + under.five.deaths + 
    Polio + HIV.AIDS + thinness..1.19.years + Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- Status                           1      1.50  819.72 263.39
- BMI                              1      2.14  820.36 263.49
- percentage.expenditure           1      4.03  822.25 263.79
- Measles                          1      6.30  824.52 264.15
- Polio                            1      6.62  824.85 264.20
<none>                                          818.23 265.15
- thinness..1.19.years             1     20.74  838.97 266.40
+ Diphtheria                       1      1.15  817.08 266.97
+ Schooling                        1      0.21  818.01 267.11
+ GDP                              1      0.11  818.12 267.13
+ Population                       1      0.07  818.16 267.14
+ thinness.5.9.years               1      0.01  818.22 267.15
- infant.deaths                    1     33.92  852.14 268.43
- HIV.AIDS                         1     33.92  852.14 268.43
- under.five.deaths                1     36.00  854.23 268.75
- Hepatitis.B                      1     63.17  881.40 272.82
- Adult.Mortality                  1    260.18 1078.41 299.04
- Income.composition.of.resources  1    924.98 1743.20 361.47

Step:  AIC=263.39
Life.expectancy ~ Adult.Mortality + infant.deaths + percentage.expenditure + 
    Hepatitis.B + Measles + BMI + under.five.deaths + Polio + 
    HIV.AIDS + thinness..1.19.years + Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- BMI                              1      2.27  821.99 261.75
- percentage.expenditure           1      3.71  823.44 261.97
- Measles                          1      6.57  826.30 262.42
- Polio                            1      6.61  826.33 262.43
<none>                                          819.72 263.39
- thinness..1.19.years             1     21.56  841.28 264.76
+ Status                           1      1.50  818.23 265.15
+ Diphtheria                       1      0.92  818.80 265.24
+ GDP                              1      0.34  819.39 265.33
+ Schooling                        1      0.09  819.64 265.37
+ Population                       1      0.08  819.64 265.37
+ thinness.5.9.years               1      0.02  819.70 265.38
- HIV.AIDS                         1     32.89  852.61 266.50
- infant.deaths                    1     33.51  853.24 266.60
- under.five.deaths                1     35.42  855.15 266.89
- Hepatitis.B                      1     63.76  883.48 271.12
- Adult.Mortality                  1    263.49 1083.21 297.62
- Income.composition.of.resources  1   1096.41 1916.14 371.77

Step:  AIC=261.75
Life.expectancy ~ Adult.Mortality + infant.deaths + percentage.expenditure + 
    Hepatitis.B + Measles + under.five.deaths + Polio + HIV.AIDS + 
    thinness..1.19.years + Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- percentage.expenditure           1      3.47  825.46 260.29
- Measles                          1      5.98  827.98 260.69
- Polio                            1      7.49  829.49 260.93
<none>                                          821.99 261.75
- thinness..1.19.years             1     19.47  841.46 262.79
+ BMI                              1      2.27  819.72 263.39
+ Status                           1      1.63  820.36 263.49
+ Diphtheria                       1      0.57  821.43 263.66
+ GDP                              1      0.24  821.75 263.71
+ Schooling                        1      0.21  821.78 263.71
+ Population                       1      0.04  821.95 263.74
+ thinness.5.9.years               1      0.01  821.98 263.74
- infant.deaths                    1     32.50  854.49 264.79
- HIV.AIDS                         1     33.19  855.19 264.89
- under.five.deaths                1     34.52  856.51 265.09
- Hepatitis.B                      1     62.66  884.66 269.30
- Adult.Mortality                  1    262.89 1084.89 295.82
- Income.composition.of.resources  1   1269.58 2091.58 381.16

Step:  AIC=260.29
Life.expectancy ~ Adult.Mortality + infant.deaths + Hepatitis.B + 
    Measles + under.five.deaths + Polio + HIV.AIDS + thinness..1.19.years + 
    Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- Measles                          1      6.17  831.63 259.26
- Polio                            1      7.21  832.67 259.42
<none>                                          825.46 260.29
- thinness..1.19.years             1     19.73  845.20 261.36
+ percentage.expenditure           1      3.47  821.99 261.75
+ BMI                              1      2.03  823.44 261.97
+ Status                           1      1.31  824.16 262.09
+ Diphtheria                       1      0.57  824.89 262.20
+ Schooling                        1      0.19  825.28 262.26
+ GDP                              1      0.16  825.30 262.27
+ Population                       1      0.07  825.40 262.28
+ thinness.5.9.years               1      0.02  825.45 262.29
- infant.deaths                    1     32.61  858.08 263.33
- HIV.AIDS                         1     33.28  858.75 263.43
- under.five.deaths                1     34.58  860.05 263.63
- Hepatitis.B                      1     64.59  890.06 268.09
- Adult.Mortality                  1    266.19 1091.66 294.63
- Income.composition.of.resources  1   1267.75 2093.21 379.26

Step:  AIC=259.26
Life.expectancy ~ Adult.Mortality + infant.deaths + Hepatitis.B + 
    under.five.deaths + Polio + HIV.AIDS + thinness..1.19.years + 
    Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
- Polio                            1      7.05  838.68 258.36
<none>                                          831.63 259.26
- thinness..1.19.years             1     15.37  847.00 259.64
+ Measles                          1      6.17  825.46 260.29
+ percentage.expenditure           1      3.65  827.98 260.69
+ Status                           1      1.53  830.10 261.02
+ BMI                              1      1.46  830.17 261.03
+ Diphtheria                       1      0.81  830.82 261.13
+ Schooling                        1      0.48  831.16 261.19
+ GDP                              1      0.20  831.44 261.23
+ thinness.5.9.years               1      0.14  831.49 261.24
+ Population                       1      0.06  831.57 261.25
- infant.deaths                    1     28.46  860.09 261.64
- under.five.deaths                1     28.90  860.53 261.70
- HIV.AIDS                         1     34.23  865.86 262.50
- Hepatitis.B                      1     60.87  892.51 266.44
- Adult.Mortality                  1    261.80 1093.43 292.84
- Income.composition.of.resources  1   1302.17 2133.80 379.76

Step:  AIC=258.36
Life.expectancy ~ Adult.Mortality + infant.deaths + Hepatitis.B + 
    under.five.deaths + HIV.AIDS + thinness..1.19.years + Income.composition.of.resources

                                  Df Sum of Sq     RSS    AIC
<none>                                          838.68 258.36
- thinness..1.19.years             1     14.97  853.65 258.66
+ Polio                            1      7.05  831.63 259.26
+ Measles                          1      6.01  832.67 259.42
+ percentage.expenditure           1      3.36  835.33 259.84
+ BMI                              1      2.18  836.51 260.02
+ Status                           1      1.55  837.14 260.12
+ Population                       1      1.04  837.65 260.20
+ Schooling                        1      0.97  837.72 260.21
+ thinness.5.9.years               1      0.32  838.36 260.31
+ GDP                              1      0.21  838.48 260.33
+ Diphtheria                       1      0.09  838.60 260.35
- infant.deaths                    1     28.87  867.56 260.76
- under.five.deaths                1     29.48  868.16 260.85
- HIV.AIDS                         1     37.20  875.88 262.00
- Hepatitis.B                      1     93.36  932.04 270.08
- Adult.Mortality                  1    263.48 1102.17 291.87
- Income.composition.of.resources  1   1417.93 2256.62 385.03

Call:
lm(formula = Life.expectancy ~ Adult.Mortality + infant.deaths + 
    Hepatitis.B + under.five.deaths + HIV.AIDS + thinness..1.19.years + 
    Income.composition.of.resources, data = life_2015_clean)

Coefficients:
                    (Intercept)                  Adult.Mortality  
                       49.76546                         -0.02102  
                  infant.deaths                      Hepatitis.B  
                        0.04822                          0.03788  
              under.five.deaths                         HIV.AIDS  
                       -0.03750                         -0.48934  
           thinness..1.19.years  Income.composition.of.resources  
                       -0.11189                         32.90858  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: 004ae9e5-c69b-49ce-b3d0-a9208307ee11
#+begin_src ein-r :session localhost :results output
modreg_trein_AIC <- lm(formula = Life.expectancy ~ Adult.Mortality + infant.deaths + 
    Hepatitis.B + under.five.deaths + HIV.AIDS + thinness..1.19.years + 
    Income.composition.of.resources, data = life_2015_clean)
#+end_src

#+RESULTS: 004ae9e5-c69b-49ce-b3d0-a9208307ee11

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: b5dc4d58-4c30-436d-af43-96c92e0bbcec
#+begin_src ein-r :session localhost :results output :exports both :eval 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: b5dc4d58-4c30-436d-af43-96c92e0bbcec
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.98739, p-value = 0.2784
: 

p-value = 0.2784 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

*** Matrix de Correlação

#+NAME: c13eb73b-2442-4ce7-8b47-3f44beaa188b
#+begin_src ein-r :session localhost :results output
  install.packages("ggcorrplot")                      # Install ggcorrplot package
  library("ggcorrplot")
#+end_src

#+RESULTS: c13eb73b-2442-4ce7-8b47-3f44beaa188b
: 
:

#+NAME: bfe27c10-5522-4351-af6d-28fac169e966
#+begin_src ein-r :session localhost :results output
  install.packages("ggplot2")                      # Install ggcorrplot package
  library(ggplot2)
#+end_src

#+RESULTS: bfe27c10-5522-4351-af6d-28fac169e966
: 


#+NAME: 7632370e-6da5-4010-9e03-f8cfe8c32e67
#+begin_src ein-r :session localhost :results output
cor(life_2015_clean)
#+end_src

#+RESULTS: 7632370e-6da5-4010-9e03-f8cfe8c32e67
#+begin_example
                                Status      Life.expectancy Adult.Mortality
Status                           1.00000000 -0.48246070      0.31154076    
Life.expectancy                 -0.48246070  1.00000000     -0.73121492    
Adult.Mortality                  0.31154076 -0.73121492      1.00000000    
infant.deaths                    0.11714183 -0.20930389      0.15484015    
percentage.expenditure           0.04279600  0.06449370     -0.05615122    
Hepatitis.B                     -0.12994892  0.37210949     -0.13454642    
Measles                          0.07235313 -0.04930461      0.02797525    
BMI                             -0.32472144  0.54498683     -0.35128263    
under.five.deaths                0.12070889 -0.24101312      0.17826119    
Polio                           -0.22401726  0.49343774     -0.30042531    
Diphtheria                      -0.22049892  0.46622307     -0.22873124    
HIV.AIDS                         0.18725101 -0.62051082      0.63227610    
GDP                             -0.45809937  0.48701755     -0.31454045    
Population                      -0.03672508 -0.02759354      0.03284010    
thinness..1.19.years             0.32053162 -0.45915325      0.25495943    
thinness.5.9.years               0.32533990 -0.45489748      0.25908957    
Income.composition.of.resources -0.53846988  0.89805889     -0.58777646    
Schooling                       -0.53622535  0.80607369     -0.46607521    
                                infant.deaths percentage.expenditure
Status                           0.11714183    0.04279600           
Life.expectancy                 -0.20930389    0.06449370           
Adult.Mortality                  0.15484015   -0.05615122           
infant.deaths                    1.00000000   -0.01894545           
percentage.expenditure          -0.01894545    1.00000000           
Hepatitis.B                     -0.07555598    0.05314330           
Measles                          0.82438856   -0.01802291           
BMI                             -0.20835749    0.05443261           
under.five.deaths                0.99396318   -0.01943582           
Polio                           -0.12015146    0.01094801           
Diphtheria                      -0.10657509    0.04725580           
HIV.AIDS                         0.07019463   -0.04681626           
GDP                             -0.11513871   -0.02666754           
Population                       0.26953307   -0.02097281           
thinness..1.19.years             0.55738702   -0.02054056           
thinness.5.9.years               0.55531571   -0.02009777           
Income.composition.of.resources -0.19738302    0.02813301           
Schooling                       -0.21548803    0.02946397           
                                Hepatitis.B Measles     BMI         
Status                          -0.12994892  0.07235313 -0.324721442
Life.expectancy                  0.37210949 -0.04930461  0.544986826
Adult.Mortality                 -0.13454642  0.02797525 -0.351282631
infant.deaths                   -0.07555598  0.82438856 -0.208357490
percentage.expenditure           0.05314330 -0.01802291  0.054432607
Hepatitis.B                      1.00000000  0.03432178  0.147274691
Measles                          0.03432178  1.00000000 -0.125854440
BMI                              0.14727469 -0.12585444  1.000000000
under.five.deaths               -0.09333772  0.78733043 -0.218591214
Polio                            0.50390197 -0.01385722  0.198912541
Diphtheria                       0.89582870  0.01951813  0.167396825
HIV.AIDS                        -0.34267756 -0.04019651 -0.265041062
GDP                              0.08840019 -0.06869774  0.387052413
Population                      -0.04532423  0.12561453  0.005962618
thinness..1.19.years            -0.03818909  0.37605215 -0.487245364
thinness.5.9.years              -0.08666371  0.36787119 -0.505186725
Income.composition.of.resources  0.27962547 -0.05767492  0.622816757
Schooling                        0.30496825 -0.06216522  0.612644341
                                under.five.deaths Polio       Diphtheria 
Status                           0.12070889       -0.22401726 -0.22049892
Life.expectancy                 -0.24101312        0.49343774  0.46622307
Adult.Mortality                  0.17826119       -0.30042531 -0.22873124
infant.deaths                    0.99396318       -0.12015146 -0.10657509
percentage.expenditure          -0.01943582        0.01094801  0.04725580
Hepatitis.B                     -0.09333772        0.50390197  0.89582870
Measles                          0.78733043       -0.01385722  0.01951813
BMI                             -0.21859121        0.19891254  0.16739683
under.five.deaths                1.00000000       -0.13841118 -0.12675282
Polio                           -0.13841118        1.00000000  0.57702248
Diphtheria                      -0.12675282        0.57702248  1.00000000
HIV.AIDS                         0.09705318       -0.37541457 -0.40657151
GDP                             -0.12009397        0.21836566  0.20013996
Population                       0.30876947       -0.23326958 -0.05316364
thinness..1.19.years             0.54716223       -0.17552469 -0.08018357
thinness.5.9.years               0.54383368       -0.17688729 -0.13175297
Income.composition.of.resources -0.22082814        0.44292524  0.39735876
Schooling                       -0.23612760        0.38730964  0.38866052
                                HIV.AIDS    GDP         Population  
Status                           0.18725101 -0.45809937 -0.036725076
Life.expectancy                 -0.62051082  0.48701755 -0.027593537
Adult.Mortality                  0.63227610 -0.31454045  0.032840098
infant.deaths                    0.07019463 -0.11513871  0.269533067
percentage.expenditure          -0.04681626 -0.02666754 -0.020972810
Hepatitis.B                     -0.34267756  0.08840019 -0.045324227
Measles                         -0.04019651 -0.06869774  0.125614526
BMI                             -0.26504106  0.38705241  0.005962618
under.five.deaths                0.09705318 -0.12009397  0.308769471
Polio                           -0.37541457  0.21836566 -0.233269576
Diphtheria                      -0.40657151  0.20013996 -0.053163638
HIV.AIDS                         1.00000000 -0.18953678  0.016877940
GDP                             -0.18953678  1.00000000  0.074872062
Population                       0.01687794  0.07487206  1.000000000
thinness..1.19.years             0.16958266 -0.28846090 -0.007082009
thinness.5.9.years               0.14851239 -0.29319487 -0.015957318
Income.composition.of.resources -0.47502206  0.56571716  0.032100439
Schooling                       -0.39230860  0.56767926  0.045242639
                                thinness..1.19.years thinness.5.9.years
Status                           0.320531621          0.32533990       
Life.expectancy                 -0.459153247         -0.45489748       
Adult.Mortality                  0.254959435          0.25908957       
infant.deaths                    0.557387019          0.55531571       
percentage.expenditure          -0.020540557         -0.02009777       
Hepatitis.B                     -0.038189094         -0.08666371       
Measles                          0.376052153          0.36787119       
BMI                             -0.487245364         -0.50518672       
under.five.deaths                0.547162234          0.54383368       
Polio                           -0.175524690         -0.17688729       
Diphtheria                      -0.080183568         -0.13175297       
HIV.AIDS                         0.169582658          0.14851239       
GDP                             -0.288460898         -0.29319487       
Population                      -0.007082009         -0.01595732       
thinness..1.19.years             1.000000000          0.96787435       
thinness.5.9.years               0.967874353          1.00000000       
Income.composition.of.resources -0.509310275         -0.50140677       
Schooling                       -0.501376861         -0.49457103       
                                Income.composition.of.resources Schooling  
Status                          -0.53846988                     -0.53622535
Life.expectancy                  0.89805889                      0.80607369
Adult.Mortality                 -0.58777646                     -0.46607521
infant.deaths                   -0.19738302                     -0.21548803
percentage.expenditure           0.02813301                      0.02946397
Hepatitis.B                      0.27962547                      0.30496825
Measles                         -0.05767492                     -0.06216522
BMI                              0.62281676                      0.61264434
under.five.deaths               -0.22082814                     -0.23612760
Polio                            0.44292524                      0.38730964
Diphtheria                       0.39735876                      0.38866052
HIV.AIDS                        -0.47502206                     -0.39230860
GDP                              0.56571716                      0.56767926
Population                       0.03210044                      0.04524264
thinness..1.19.years            -0.50931027                     -0.50137686
thinness.5.9.years              -0.50140677                     -0.49457103
Income.composition.of.resources  1.00000000                      0.92075875
Schooling                        0.92075875                      1.00000000
#+end_example


#+NAME: 73d98fb5-7101-46f2-9d63-8da319fa9c06
#+begin_src ein-r :session localhost :results output
ggcorrplot(cor(life_2015_clean)) 
#+end_src

#+RESULTS: 73d98fb5-7101-46f2-9d63-8da319fa9c06
#+ATTR_HTML: :width 500px
 [[file:ein-images/ob-ein-bc5a9463cf1a9262fc216a957d492b0d.png]]

#+NAME: 805824e1-5595-4373-8b2a-e04b6b6a5e47
#+begin_src ein-r :session localhost :results output
ggcorrplot(cor(life_2015_clean, use=c("pairwise.complete.obs"), method=c("pearson"))) 
#+end_src

#+RESULTS: 805824e1-5595-4373-8b2a-e04b6b6a5e47
#+ATTR_HTML: :width 500px
 [[file:ein-images/ob-ein-28b9cbe40750df74a1bd8d32eb620901.png]]

#+NAME: 843236e1-55e0-40e5-ac81-000703e039e8
#+begin_src ein-r :session localhost :results output
cor(life_2015_clean, use=c("pairwise.complete.obs"), method=c("pearson"))
#+end_src

#+RESULTS: 843236e1-55e0-40e5-ac81-000703e039e8
#+begin_example

                                Status        Life.expectancy Adult.Mortality
Status                           1.0000000000 -0.51665706      0.36900245    
Life.expectancy                 -0.5166570632  1.00000000     -0.77911947    
Adult.Mortality                  0.3690024501 -0.77911947      1.00000000    
infant.deaths                    0.1247517696 -0.24128954      0.18820516    
Alcohol                         -0.5722669577  0.60377488     -0.60658826    
percentage.expenditure           0.0400727074  0.04396412     -0.04292988    
Hepatitis.B                     -0.1223875598  0.42084792     -0.23171478    
Measles                          0.0813235618 -0.07461652      0.05119611    
BMI                             -0.2929402873  0.51666307     -0.36992022    
under.five.deaths                0.1291009603 -0.27192105      0.21200356    
Polio                           -0.2257024628  0.51560179     -0.37239163    
Total.expenditure                          NA -1.00000000      1.00000000    
Diphtheria                      -0.2211147445  0.50029997     -0.32268845    
HIV.AIDS                         0.1924626909 -0.60834494      0.62101164    
GDP                             -0.3739720804  0.45449101     -0.33586964    
Population                       0.0005978427 -0.04846105      0.04616956    
thinness..1.19.years             0.3713047706 -0.47502018      0.29801648    
thinness.5.9.years               0.3752232273 -0.47502673      0.30269890    
Income.composition.of.resources -0.5580676377  0.90736386     -0.65725777    
Schooling                       -0.5579942289  0.81815944     -0.54617818    
                                infant.deaths Alcohol    percentage.expenditure
Status                           0.12475177   -0.5722670  0.040072707          
Life.expectancy                 -0.24128954    0.6037749  0.043964121          
Adult.Mortality                  0.18820516   -0.6065883 -0.042929879          
infant.deaths                    1.00000000   -0.6140724 -0.014261921          
Alcohol                         -0.61407243    1.0000000 -0.212868045          
percentage.expenditure          -0.01426192   -0.2128680  1.000000000          
Hepatitis.B                     -0.08690157    0.5612067  0.041100311          
Measles                          0.80085889   -0.5946120 -0.014628987          
BMI                             -0.22356229    0.9226783  0.037722518          
under.five.deaths                0.99419572   -0.6141817 -0.014618671          
Polio                           -0.12972895    0.6198551  0.002149597          
Total.expenditure                1.00000000   -1.0000000 -1.000000000          
Diphtheria                      -0.11798926    0.5745324  0.034701325          
HIV.AIDS                         0.09583712           NA -0.036393365          
GDP                             -0.12228636   -0.3289319 -0.030799833          
Population                       0.27181137   -0.9727654 -0.019062400          
thinness..1.19.years             0.53054418   -0.6976496 -0.015428445          
thinness.5.9.years               0.53054804   -0.7056867 -0.013887070          
Income.composition.of.resources -0.20752236    0.6692496  0.014061997          
Schooling                       -0.20814856    0.8928384  0.018592698          
                                Hepatitis.B Measles     BMI         
Status                          -0.12238756  0.08132356 -0.292940287
Life.expectancy                  0.42084792 -0.07461652  0.516663068
Adult.Mortality                 -0.23171478  0.05119611 -0.369920223
infant.deaths                   -0.08690157  0.80085889 -0.223562288
Alcohol                          0.56120670 -0.59461195  0.922678345
percentage.expenditure           0.04110031 -0.01462899  0.037722518
Hepatitis.B                      1.00000000  0.01564200  0.179551156
Measles                          0.01564200  1.00000000 -0.128184356
BMI                              0.17955116 -0.12818436  1.000000000
under.five.deaths               -0.10471583  0.76490826 -0.234981856
Polio                            0.59455854 -0.02834186  0.212450071
Total.expenditure               -1.00000000  1.00000000 -1.000000000
Diphtheria                       0.91522030 -0.00162315  0.197685617
HIV.AIDS                        -0.38379178 -0.02657996 -0.292452813
GDP                              0.14211629 -0.07723353  0.345978425
Population                      -0.04755820  0.12771710  0.001515378
thinness..1.19.years            -0.05795100  0.34327367 -0.472507580
thinness.5.9.years              -0.09996453  0.33829411 -0.489715937
Income.composition.of.resources  0.32716917 -0.07467367  0.589783602
Schooling                        0.33405089 -0.06779575  0.566204265
                                under.five.deaths Polio       
Status                           0.12910096       -0.225702463
Life.expectancy                 -0.27192105        0.515601795
Adult.Mortality                  0.21200356       -0.372391627
infant.deaths                    0.99419572       -0.129728947
Alcohol                         -0.61418174        0.619855110
percentage.expenditure          -0.01461867        0.002149597
Hepatitis.B                     -0.10471583        0.594558536
Measles                          0.76490826       -0.028341859
BMI                             -0.23498186        0.212450071
under.five.deaths                1.00000000       -0.147457487
Polio                           -0.14745749        1.000000000
Total.expenditure                1.00000000       -1.000000000
Diphtheria                      -0.13786287        0.661635315
HIV.AIDS                         0.12260442       -0.403232519
GDP                             -0.12767000        0.241974423
Population                       0.31068652       -0.236340708
thinness..1.19.years             0.52214172       -0.194517608
thinness.5.9.years               0.52100562       -0.196669109
Income.composition.of.resources -0.22957135        0.464524568
Schooling                       -0.22753042        0.408363489
                                Total.expenditure Diphtheria  HIV.AIDS   
Status                          NA                -0.22111474  0.19246269
Life.expectancy                 -1                 0.50029997 -0.60834494
Adult.Mortality                  1                -0.32268845  0.62101164
infant.deaths                    1                -0.11798926  0.09583712
Alcohol                         -1                 0.57453243          NA
percentage.expenditure          -1                 0.03470133 -0.03639336
Hepatitis.B                     -1                 0.91522030 -0.38379178
Measles                          1                -0.00162315 -0.02657996
BMI                             -1                 0.19768562 -0.29245281
under.five.deaths                1                -0.13786287  0.12260442
Polio                           -1                 0.66163532 -0.40323252
Total.expenditure                1                -1.00000000          NA
Diphtheria                      -1                 1.00000000 -0.44141288
HIV.AIDS                        NA                -0.44141288  1.00000000
GDP                             -1                 0.22770513 -0.19769304
Population                       1                -0.06401096  0.02430268
thinness..1.19.years             1                -0.11399856  0.18428968
thinness.5.9.years               1                -0.15703750  0.16847058
Income.composition.of.resources -1                 0.43193612 -0.47878832
Schooling                       -1                 0.41083260 -0.39416055
                                GDP         Population    thinness..1.19.years
Status                          -0.37397208  0.0005978427  0.371304771        
Life.expectancy                  0.45449101 -0.0484610537 -0.475020177        
Adult.Mortality                 -0.33586964  0.0461695590  0.298016478        
infant.deaths                   -0.12228636  0.2718113749  0.530544182        
Alcohol                         -0.32893188 -0.9727654364 -0.697649635        
percentage.expenditure          -0.03079983 -0.0190623996 -0.015428445        
Hepatitis.B                      0.14211629 -0.0475581955 -0.057950998        
Measles                         -0.07723353  0.1277171002  0.343273666        
BMI                              0.34597842  0.0015153779 -0.472507580        
under.five.deaths               -0.12767000  0.3106865170  0.522141718        
Polio                            0.24197442 -0.2363407075 -0.194517608        
Total.expenditure               -1.00000000  1.0000000000  1.000000000        
Diphtheria                       0.22770513 -0.0640109592 -0.113998562        
HIV.AIDS                        -0.19769304  0.0243026761  0.184289683        
GDP                              1.00000000  0.0641671811 -0.242374058        
Population                       0.06416718  1.0000000000  0.007619768        
thinness..1.19.years            -0.24237406  0.0076197683  1.000000000        
thinness.5.9.years              -0.25092632 -0.0006055056  0.973195025        
Income.composition.of.resources  0.52163836  0.0066844216 -0.507867950        
Schooling                        0.44727548  0.0167176195 -0.507250471        
                                thinness.5.9.years
Status                           0.3752232273     
Life.expectancy                 -0.4750267329     
Adult.Mortality                  0.3026988996     
infant.deaths                    0.5305480372     
Alcohol                         -0.7056866540     
percentage.expenditure          -0.0138870698     
Hepatitis.B                     -0.0999645302     
Measles                          0.3382941135     
BMI                             -0.4897159366     
under.five.deaths                0.5210056153     
Polio                           -0.1966691088     
Total.expenditure                1.0000000000     
Diphtheria                      -0.1570375038     
HIV.AIDS                         0.1684705793     
GDP                             -0.2509263249     
Population                      -0.0006055056     
thinness..1.19.years             0.9731950251     
thinness.5.9.years               1.0000000000     
Income.composition.of.resources -0.5059939363     
Schooling                       -0.5038791522     
                                Income.composition.of.resources Schooling  
Status                          -0.558067638                    -0.55799423
Life.expectancy                  0.907363860                     0.81815944
Adult.Mortality                 -0.657257766                    -0.54617818
infant.deaths                   -0.207522360                    -0.20814856
Alcohol                          0.669249553                     0.89283845
percentage.expenditure           0.014061997                     0.01859270
Hepatitis.B                      0.327169172                     0.33405089
Measles                         -0.074673665                    -0.06779575
BMI                              0.589783602                     0.56620426
under.five.deaths               -0.229571347                    -0.22753042
Polio                            0.464524568                     0.40836349
Total.expenditure               -1.000000000                    -1.00000000
Diphtheria                       0.431936118                     0.41083260
HIV.AIDS                        -0.478788325                    -0.39416055
GDP                              0.521638357                     0.44727548
Population                       0.006684422                     0.01671762
thinness..1.19.years            -0.507867950                    -0.50725047
thinness.5.9.years              -0.505993936                    -0.50387915
Income.composition.of.resources  1.000000000                     0.91751420
Schooling                        0.917514197                     1.00000000
#+end_example


#+ATTR_HTML: :width 500px
[[file:ein-images/ob-ein-e70193a42aa42d5787222b5c8264ee14.png]]

#+NAME: d3887877-24a3-43cc-acd0-bbfb82409125
#+begin_src ein-r :session localhost :results output
ggcorr(life_2015_clean, method=c("na.or.complete", "pearson")) 
#+end_src

#+RESULTS: d3887877-24a3-43cc-acd0-bbfb82409125
: Error in ggcorr(life_2015_clean, method = c("na.or.complete", "pearson")): could not find function "ggcorr"
: Traceback:

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-plm-cigar][Consumo de Cigarro]] (não normal)
+ *Modelar quantidade de venda (sales)*.
*** Sobre o =Conjunto=
+ Usado em:
  * Baltagi, Badi H. (2001) Econometric Analysis of Panel Data, 2nd ed., John Wiley and Sons.
  * Baltagi, Badi H. (2013) Econometric Analysis of Panel Data, 5th ed., John Wiley and Sons.
  * Baltagi, B.H. and D. Levin (1992) “Cigarette taxation: raising revenues and reducing consumption”, Structural Changes and Economic Dynamics, 3(2), pp. 321–335.
  * Baltagi, B.H., J.M. Griffin and W. Xiong (2000) “To pool or not to pool: homogeneous versus heterogeneous estimators applied to cigarette demand”, Review of Economics and Statistics, 82(1), pp. 117–126.
+ Dados: anos 1963-1992
  - State: estados norte americanos, $\{1,2,3, \ldots, 51\}$.
  - Year: Anos 63-92.
  - Price: preço do maço.
  - Pop: população de fumantes.
  - Pop16: população acima de 16.
  - CPI: índice do preço (ideal) dado pelo consumidor.
  - NDI: Salário líquido per capta.
  - Sales: venda de cigarro por maço.
  - Pimin: preço mínimo de cigarro em estados vizinhos
*** Como utilizar pelo R

O =conjunto de dados= se encontra sob o pacote =Ecdat= (Econometrics
Datasets [Conjuntos de Econometria]). Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  install.packages("Ecdat",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote.
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  load(Ecdat)
#+end_src

Finalmente, podemos acessar o =conjunto=.
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  cigarro <- data("Cigar")
  cigarro
#+end_src

*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o =conjunto= [[https://drive.google.com/file/d/1iOQFp0TshV8km2X13fRkXGm8kd-ZVfSL/view?usp=sharing][cigarro.csv ]]da seguinte maneira.

#+NAME: 408400ab-c7ec-4778-bce9-3f513a43edab
#+begin_src ein-r :session localhost :results output :exports both :eval
  data <- read.csv('./data/csv/cigarro.csv')
  cigarro<- subset(data, year==90)
  head(cigarro,5)
#+end_src

#+RESULTS: 408400ab-c7ec-4778-bce9-3f513a43edab
:     state year price pop     pop16   cpi   ndi   sales pimin
: 28  1     90   139.1  4129.2  3148.6 130.7 12806 108.6 132.3
: 58  3     90   130.2  3598.2  2703.7 130.7 13826  88.9 133.6
: 88  4     90   141.2  2411.1  1834.9 130.7 12370 113.1 129.1
: 118 5     90   163.8 29602.1 22490.6 130.7 17384  77.8 130.2
: 148 7     90   171.2  3242.9  2567.1 130.7 21447  91.5 150.9

*** Regressão e Teste de Shapiro (normal)
**** Retirar valores nominais do título do estado
#+NAME: 3095def0-5fc5-44e3-b624-01823379c8d8
#+begin_src ein-r :session localhost :results output :exports both :eval 
  cigarro_clean <- subset(cigarro, select=-c(year, cpi))
#+end_src

#+RESULTS: 3095def0-5fc5-44e3-b624-01823379c8d8

**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: aad70e82-9030-4b4a-a12d-add945bc4a7f
#+begin_src ein-r :session localhost :results output :exports both :eval
  modreg_trein <- lm(sales ~ . , cigarro_clean)
  summary(modreg_trein)
#+end_src

#+RESULTS: aad70e82-9030-4b4a-a12d-add945bc4a7f
#+begin_example

Call:
lm(formula = sales ~ ., data = cigarro_clean)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.966 -11.873   0.664   7.174  59.369 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) 203.502135  49.643084   4.099 0.000203 ***
state        -0.156382   0.214396  -0.729 0.470110    
price        -0.732567   0.299148  -2.449 0.018930 *  
pop          -0.022894   0.019797  -1.156 0.254522    
pop16         0.029419   0.025926   1.135 0.263425    
ndi           0.001274   0.001646   0.774 0.443729    
pimin        -0.066073   0.409737  -0.161 0.872724    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 20.62 on 39 degrees of freedom
Multiple R-squared:  0.2254,	Adjusted R-squared:  0.1062 
F-statistic: 1.891 on 6 and 39 DF,  p-value: 0.1069

#+end_example

**** StepAIC
#+NAME: d26fb6ff-0943-4854-8201-29fbb331bba1
#+begin_src ein-r :session localhost :results output :exports both :eval
  library(MASS)
#+end_src

#+RESULTS: d26fb6ff-0943-4854-8201-29fbb331bba1

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: bc6da73d-e4d2-42c7-80ae-3266b6d7003d
#+begin_src ein-r :session localhost :results output :exports both :eval
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: bc6da73d-e4d2-42c7-80ae-3266b6d7003d
#+begin_example
Start:  AIC=284.83
sales ~ state + price + pop + pop16 + ndi + pimin

        Df Sum of Sq   RSS    AIC
- pimin  1     11.06 16596 282.86
- state  1    226.25 16812 283.45
- ndi    1    254.62 16840 283.53
- pop16  1    547.55 17133 284.32
- pop    1    568.76 17154 284.38
<none>               16585 284.83
- price  1   2550.22 19135 289.41

Step:  AIC=282.86
sales ~ state + price + pop + pop16 + ndi

        Df Sum of Sq   RSS    AIC
- state  1     233.4 16830 281.50
- ndi    1     243.8 16840 281.53
- pop16  1     583.1 17179 282.45
- pop    1     602.1 17198 282.50
<none>               16596 282.86
+ pimin  1      11.1 16585 284.83
- price  1    3241.1 19837 289.07

Step:  AIC=281.5
sales ~ price + pop + pop16 + ndi

        Df Sum of Sq   RSS    AIC
- ndi    1     323.5 17153 280.38
- pop16  1     563.4 17393 281.02
- pop    1     580.4 17410 281.06
<none>               16830 281.50
+ state  1     233.4 16596 282.86
+ pimin  1      18.2 16812 283.45
- price  1    3312.6 20142 287.77

Step:  AIC=280.38
sales ~ price + pop + pop16

        Df Sum of Sq   RSS    AIC
<none>               17153 280.38
- pop16  1   1198.70 18352 281.49
+ ndi    1    323.54 16830 281.50
- pop    1   1209.90 18363 281.51
+ state  1    313.18 16840 281.53
+ pimin  1      1.27 17152 282.38
- price  1   3005.27 20158 285.81

Call:
lm(formula = sales ~ price + pop + pop16, data = cigarro_clean)

Coefficients:
(Intercept)        price          pop        pop16  
  199.94492     -0.67052     -0.03004      0.03899  

#+end_example


Assim, utilizaremos a seguinte fórmula:
#+NAME: d83aae01-2062-4e8e-bf2c-0ee81899e56d
#+begin_src ein-r :session localhost :results output :exports both :eval 
modreg_trein_AIC <- lm(formula = sales ~ price + pop + pop16, data = cigarro_clean)
#+end_src

#+RESULTS: d83aae01-2062-4e8e-bf2c-0ee81899e56d


**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: c19ce000-02e5-4106-8ce8-bf7a0b753254
#+begin_src ein-r :session localhost :results output :exports both :eval 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: c19ce000-02e5-4106-8ce8-bf7a0b753254
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.92433, p-value = 0.005309
: 

p-value = 0.005309 <=> p-value maior que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

** [[https://www.openintro.org/data/index.php?data=gifted][Inteligência de prodígios]] (normal)
+ *Modele o IQ da criança com as outras variáveis*
*** Sobre o =Conjunto=
+ Referências:
  - Graybill, F.A. & Iyer, H.K., (1994) Regression Analysis: Concepts and Applications, Duxbury, p. 511-6.
+ Dados:
  1. IQ da Criança.
  2. IQ Pai.
  3. IQ Mãe.
  4. Período em meses, até primeiras palavras.
  5. Período em meses, até quanto contou até dez.
  6. Tempo passado, pelos pais, lendo livros, semanalmente.
  7. Tempo passado assistindo programas educativos, semanalmente.
  8. Tempo assistindo desenhos (=cartoons=), semanalmente.
     
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o =conjunto= [[https://drive.google.com/file/d/1stukrpc_Rqu-nlYZu_-BFHNZec676_BR/view?usp=sharing][gifted.csv]] da seguinte maneira.

#+NAME: 977bc4c5-07e0-4af5-972e-2d843efbaadc
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- read.csv('./data/csv/gifted.csv')
  head(data,5)
#+end_src

#+RESULTS: 977bc4c5-07e0-4af5-972e-2d843efbaadc
:   score fatheriq motheriq speak count read edutv cartoons
: 1 159   115      117      18    26    1.9  3.00  2.00    
: 2 164   117      113      20    37    2.5  1.75  3.25    
: 3 154   115      118      20    32    2.2  2.75  2.50    
: 4 157   113      131      12    24    1.7  2.75  2.25    
: 5 156   110      109      17    34    2.2  2.25  2.50    

*** Regressão e Teste de Shapiro (normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 9a5c63c1-f280-4b41-8cae-aa118fd0b17a
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(score ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 9a5c63c1-f280-4b41-8cae-aa118fd0b17a
#+begin_example

Call:
lm(formula = score ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8064 -1.5898  0.0479  1.7474  5.2905 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 75.50849   24.02618   3.143  0.00393 ** 
fatheriq     0.25249    0.13756   1.835  0.07707 .  
motheriq     0.40007    0.07291   5.488 7.33e-06 ***
speak        0.18764    0.14767   1.271  0.21429    
count        0.20649    0.26631   0.775  0.44462    
read         7.54405    5.58640   1.350  0.18769    
edutv       -4.20244    2.24503  -1.872  0.07170 .  
cartoons    -3.33899    2.01808  -1.655  0.10919    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.591 on 28 degrees of freedom
Multiple R-squared:  0.7496,	Adjusted R-squared:  0.687 
F-statistic: 11.97 on 7 and 28 DF,  p-value: 5.803e-07

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 625c0172-e3c2-4454-985e-5d136ac00f82
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 625c0172-e3c2-4454-985e-5d136ac00f82
#+begin_example
Start:  AIC=75.49
score ~ fatheriq + motheriq + speak + count + read + edutv + 
    cartoons

           Df Sum of Sq    RSS    AIC
- count     1     4.034 191.94 74.251
<none>                  187.90 75.486
- speak     1    10.836 198.74 75.505
- read      1    12.238 200.14 75.758
- cartoons  1    18.371 206.27 76.844
- fatheriq  1    22.609 210.51 77.577
- edutv     1    23.514 211.42 77.731
- motheriq  1   202.081 389.98 99.773

Step:  AIC=74.25
score ~ fatheriq + motheriq + speak + read + edutv + cartoons

           Df Sum of Sq    RSS    AIC
- speak     1     7.829 199.77 73.690
<none>                  191.94 74.251
+ count     1     4.034 187.90 75.486
- fatheriq  1    21.119 213.06 76.009
- cartoons  1    22.467 214.40 76.236
- edutv     1    29.657 221.59 77.424
- read      1   182.630 374.57 96.321
- motheriq  1   214.969 406.91 99.302

Step:  AIC=73.69
score ~ fatheriq + motheriq + read + edutv + cartoons

           Df Sum of Sq    RSS    AIC
<none>                  199.77 73.690
+ speak     1     7.829 191.94 74.251
- fatheriq  1    20.167 219.93 75.153
+ count     1     1.027 198.74 75.505
- cartoons  1    25.102 224.87 75.952
- edutv     1    34.053 233.82 77.357
- read      1   199.869 399.63 96.653
- motheriq  1   219.573 419.34 98.386

Call:
lm(formula = score ~ fatheriq + motheriq + read + edutv + cartoons, 
    data = data)

Coefficients:
(Intercept)     fatheriq     motheriq         read        edutv     cartoons  
    79.0468       0.2374       0.4121      11.9013      -4.8881      -3.8202  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: 73cfbb9c-5a1d-426f-9c03-2301fcc11b3a
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = score ~ fatheriq + motheriq + read + edutv + cartoons, 
    data = data)
#+end_src

#+RESULTS: 73cfbb9c-5a1d-426f-9c03-2301fcc11b3a

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: f87b018b-1add-4a77-a8a1-3ee8b15c3d41
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: f87b018b-1add-4a77-a8a1-3ee8b15c3d41
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.97689, p-value = 0.6398

p-value = 0.6398 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-mosaicdata-sat][SAT - Professores]] (não normal)
+ *Modelar variável SAT (nota geral)*
*** Sobre o =Conjunto=
+ Dados:
  - State: estado norte americano
  - Expend: termo médio de aula assistida diária.
  - Ratio: razão de alunos por professor.
  - Salary: salário do professor médio, anual.
  - Frac: percentagem de alunos elegíveis a participar do SAT.
  - Verbal: nota pra proficiência verbal no SAT.
  - Math: nota para proficiência em exatadas no SAT.
  - SAT: nota geral do SAT final.

*** Como utilizar pelo R

O =conjunto de dados= se encontra sob o pacote =mosaicData=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  install.packages("mosaicData",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(mosaicData)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- SAT
  head(data)
#+end_src

*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1E6aOdH1nf0qF4Lky131iX1LNBjaIYAev/view?usp=sharing][professores-SAT]] da seguinte maneira.

#+NAME: c2abfe6a-b88d-4796-99a6-2081b2b97275
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/professores-SAT.csv')
  head(data,5)
#+end_src

#+RESULTS: c2abfe6a-b88d-4796-99a6-2081b2b97275
:   state      expend ratio salary frac verbal math sat 
: 1 Alabama    4.405  17.2  31.144  8   491    538  1029
: 2 Alaska     8.963  17.6  47.951 47   445    489   934
: 3 Arizona    4.778  19.3  32.175 27   448    496   944
: 4 Arkansas   4.459  17.1  28.934  6   482    523  1005
: 5 California 4.992  24.0  41.078 45   417    485   902

*** Regressão e Teste de Shapiro (normal)
**** Retirar valores anuais
#+NAME: dc32c8bf-5c64-4ffe-93db-2b0af15bad81
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- subset(data, select=-c(state))
#+end_src

#+RESULTS: dc32c8bf-5c64-4ffe-93db-2b0af15bad81

**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 05b2fffb-c080-4c9f-bbc3-d168006f25bf
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(sat ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 05b2fffb-c080-4c9f-bbc3-d168006f25bf
#+begin_example


Call:
lm(formula = sat ~ ., data = data)

Residuals:
       Min         1Q     Median         3Q        Max 
-7.624e-14 -1.386e-14 -3.695e-15  6.353e-15  9.046e-14 

Coefficients:
              Estimate Std. Error    t value Pr(>|t|)    
(Intercept) -2.305e-13  1.416e-13 -1.628e+00  0.11082    
expend      -6.673e-15  8.724e-15 -7.650e-01  0.44847    
ratio       -6.881e-16  2.719e-15 -2.530e-01  0.80140    
salary      -9.299e-16  1.978e-15 -4.700e-01  0.64063    
frac         1.608e-15  4.064e-16  3.957e+00  0.00028 ***
verbal       1.000e+00  5.210e-16  1.919e+15  < 2e-16 ***
math         1.000e+00  4.233e-16  2.362e+15  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.693e-14 on 43 degrees of freedom
Multiple R-squared:      1,	Adjusted R-squared:      1 
F-statistic: 6.305e+31 on 6 and 43 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: dd8d4369-254e-4352-805b-40bd523b1878
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: dd8d4369-254e-4352-805b-40bd523b1878
#+begin_example
Start:  AIC=-3118.1
sat ~ expend + ratio + salary + frac + verbal + math


         Df Sum of Sq    RSS     AIC
- ratio   1       0.0    0.0 -3188.2
- expend  1       0.0    0.0 -3178.6
- salary  1       0.0    0.0 -3152.6
- frac    1       0.0    0.0 -3130.1
<none>                   0.0 -3118.1
- verbal  1    2671.0 2671.0   210.9
- math    1    4046.3 4046.3   231.7

Step:  AIC=-3188.21
sat ~ expend + salary + frac + verbal + math



         Df Sum of Sq    RSS     AIC
<none>                   0.0 -3188.2
+ ratio   1       0.0    0.0 -3186.3
- frac    1       0.0    0.0 -3178.7
- expend  1       0.0    0.0 -3169.3
- salary  1       0.0    0.0 -3165.1
- verbal  1    2773.1 2773.1   210.8
- math    1    4090.2 4090.2   230.2

Call:
lm(formula = sat ~ expend + salary + frac + verbal + math, data = data)

Coefficients:
(Intercept)       expend       salary         frac       verbal         math  
 -2.836e-13    8.486e-15   -1.077e-15    3.896e-16    1.000e+00    1.000e+00  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: 1a2f2783-6870-4684-bb15-3f2af5c4c111
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = sat ~ expend + salary + frac + verbal + math, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 0127b6bc-ec92-4892-a4cb-43405840ea49
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 0127b6bc-ec92-4892-a4cb-43405840ea49
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.9022, p-value = 0.0005685
: 

p-value = 0.005685 <=> p-value maior que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-robustbase-toxicity][Toxicidade]] (não normal)
+ *Modelar nível de toxicidade aquática de ácidos caboxílicos, baseado nos outros descritores moleculares.*
*** Sobre o =Conjunto=
+ Dados:
  - toxicity
  toxicidade  aquática, definida como o $log(\textrm{IGC50}^{-1})$; tipicamente, a "reposta".
  - logKow
    log Kow, coeficiente de parcionamento
  - pKa
    pKa: constante dissociativa
  - ELUMO
    Energia do menor orbital molecular ocupado  
  - Ecarb
    Estado eletrotopolófico do grupo carboxílico
  - Emet
    Estado eletrotopolófico do grupo metil
  - RM
    Reflectibilidade Molar
  - IR
    Index de Refração
  - Ts
    Tensão superficial
  - P
    Polaridade
*** Como utilizar pelo R
O =conjunto de dados= se encontra sob o pacote =robustbase=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no
  install.packages("robustbase",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(robustbase)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- toxicity
  head(data)
#+end_src
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1dZE0wj0Z-FeXCvz-4ft0CPJ6Enn1fnew/view?usp=sharing][toxicidade]] da seguinte maneira.

#+NAME: d076909b-db93-4210-b1df-9f57897694f8
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/toxicity.csv')
  head(data,5)
#+end_src

*** Regressão e Teste de Shapiro (não normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 9dad8771-357d-4644-9217-4020f91c3211
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(toxicity ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 9dad8771-357d-4644-9217-4020f91c3211
#+begin_example

Call:
lm(formula = toxicity ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.36704 -0.09072 -0.01605  0.05775  0.50947 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)   
(Intercept) -6.973446   6.538420  -1.067  0.29529   
logKow       0.317054   0.136360   2.325  0.02754 * 
pKa          0.059883   0.184185   0.325  0.74751   
ELUMO       -0.201126   0.057242  -3.514  0.00152 **
Ecarb       -0.027091   0.173513  -0.156  0.87705   
Emet         0.012661   0.036188   0.350  0.72906   
RM          -0.014451   0.017489  -0.826  0.41562   
IR           5.896792   5.156774   1.144  0.26251   
Ts          -0.014075   0.011667  -1.206  0.23777   
P            0.008387   0.013845   0.606  0.54957   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.184 on 28 degrees of freedom
Multiple R-squared:  0.8463,	Adjusted R-squared:  0.7969 
F-statistic: 17.14 on 9 and 28 DF,  p-value: 3.52e-09

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 78ecb56e-1077-4a92-a4af-5a742b311600
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 78ecb56e-1077-4a92-a4af-5a742b311600
#+begin_example
Start:  AIC=-120.27
toxicity ~ logKow + pKa + ELUMO + Ecarb + Emet + RM + IR + Ts + 
    P

         Df Sum of Sq     RSS     AIC
- Ecarb   1   0.00083 0.94855 -122.23
- pKa     1   0.00358 0.95131 -122.12
- Emet    1   0.00414 0.95187 -122.10
- P       1   0.01242 0.96015 -121.77
- RM      1   0.02311 0.97084 -121.35
- IR      1   0.04426 0.99199 -120.53
- Ts      1   0.04926 0.99699 -120.34
<none>                0.94773 -120.27
- logKow  1   0.18299 1.13072 -115.56
- ELUMO   1   0.41786 1.36559 -108.39

Step:  AIC=-122.24
toxicity ~ logKow + pKa + ELUMO + Emet + RM + IR + Ts + P

         Df Sum of Sq     RSS     AIC
- pKa     1   0.00299 0.95155 -124.12
- Emet    1   0.01030 0.95886 -123.83
- P       1   0.01259 0.96115 -123.73
- RM      1   0.04377 0.99232 -122.52
- IR      1   0.04578 0.99433 -122.44
<none>                0.94855 -122.23
- Ts      1   0.06045 1.00900 -121.89
+ Ecarb   1   0.00083 0.94773 -120.27
- logKow  1   0.18840 1.13695 -117.35
- ELUMO   1   0.44904 1.39759 -109.51

Step:  AIC=-124.12
toxicity ~ logKow + ELUMO + Emet + RM + IR + Ts + P

         Df Sum of Sq     RSS     AIC
- Emet    1   0.01012 0.96167 -125.71
- P       1   0.03449 0.98604 -124.76
- IR      1   0.04720 0.99874 -124.28
<none>                0.95155 -124.12
- Ts      1   0.05972 1.01127 -123.80
- RM      1   0.07118 1.02273 -123.37
+ pKa     1   0.00299 0.94855 -122.23
+ Ecarb   1   0.00024 0.95131 -122.12
- logKow  1   0.31676 1.26831 -115.20
- ELUMO   1   0.48298 1.43453 -110.52

Step:  AIC=-125.71
toxicity ~ logKow + ELUMO + RM + IR + Ts + P

         Df Sum of Sq     RSS     AIC
- P       1   0.02993 0.99160 -126.55
- IR      1   0.03942 1.00109 -126.19
<none>                0.96167 -125.71
- Ts      1   0.05346 1.01512 -125.66
- RM      1   0.06258 1.02424 -125.32
+ Emet    1   0.01012 0.95155 -124.12
+ Ecarb   1   0.00513 0.95653 -123.92
+ pKa     1   0.00281 0.95886 -123.83
- logKow  1   0.42750 1.38917 -113.74
- ELUMO   1   0.61370 1.57537 -108.96

Step:  AIC=-126.55
toxicity ~ logKow + ELUMO + RM + IR + Ts

         Df Sum of Sq     RSS     AIC
- IR      1   0.01185 1.00345 -128.10
- Ts      1   0.02459 1.01619 -127.62
<none>                0.99160 -126.55
+ P       1   0.02993 0.96167 -125.71
+ pKa     1   0.02228 0.96932 -125.41
- RM      1   0.08551 1.07711 -125.41
+ Emet    1   0.00556 0.98604 -124.76
+ Ecarb   1   0.00296 0.98864 -124.66
- ELUMO   1   0.60776 1.59936 -110.38
- logKow  1   0.90448 1.89608 -103.92

Step:  AIC=-128.1
toxicity ~ logKow + ELUMO + RM + Ts

         Df Sum of Sq    RSS     AIC
- Ts      1   0.01314 1.0166 -129.60
<none>                1.0034 -128.10
- RM      1   0.07447 1.0779 -127.38
+ IR      1   0.01185 0.9916 -126.55
+ Emet    1   0.00255 1.0009 -126.19
+ P       1   0.00236 1.0011 -126.19
+ Ecarb   1   0.00107 1.0024 -126.14
+ pKa     1   0.00003 1.0034 -126.10
- ELUMO   1   0.67820 1.6817 -110.48
- logKow  1   0.89263 1.8961 -105.92

Step:  AIC=-129.6
toxicity ~ logKow + ELUMO + RM

         Df Sum of Sq    RSS      AIC
<none>                1.0166 -129.603
+ Ts      1   0.01314 1.0035 -128.097
+ Ecarb   1   0.00344 1.0132 -127.732
+ Emet    1   0.00306 1.0135 -127.717
+ pKa     1   0.00059 1.0160 -127.625
+ P       1   0.00046 1.0161 -127.620
+ IR      1   0.00040 1.0162 -127.618
- RM      1   0.30329 1.3199 -121.682
- ELUMO   1   0.75682 1.7734 -110.458
- logKow  1   2.97335 3.9899  -79.645

Call:
lm(formula = toxicity ~ logKow + ELUMO + RM, data = data)

Coefficients:
(Intercept)       logKow        ELUMO           RM  
    0.42898      0.39055     -0.18234     -0.01294  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein_AIC <- lm(formula = toxicity ~ logKow + ELUMO + RM, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 9b5c3927-a684-4f6c-bd1d-e8b6e795edee
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 9b5c3927-a684-4f6c-bd1d-e8b6e795edee
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.93867, p-value = 0.03793
: 

p-value = 0.03793 <=> p-value menor que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-stat2data-fertility][Fertilidade Feminina]] (não normal)
+ *Modelar MeanAFC* o qual diretamente empacta a habilidade de ter filhos.
*** Sobre o =Conjunto=
+ Dados:
  - Idade
  - LowAFC: Conta da menor quantidade de folículos antrais.
  - MeanAFC: Média de folículos antrais.
  - FSH: Máxima quantidade de níveis de hormônios estimulantes aos folículos.
  - E2: Nível de fertilidade.
  - MaxE2: Máximo nível de fertilidade.
  - MaxDailyGn: Nível máximo de gonadotrofina.
  - TotalGn: Nível total de gonadotrofina.
  - Oocytes: Quantidade de ovócitos/oócitos.
  - Embryos: Quantidade de embriões.
*** Como utilizar pelo R
O =conjunto de dados= se encontra sob o pacote =Stat2Data=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no
  install.packages("Stat2Data",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(Stat2Data)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- data("Fertility")
  head(data)
#+end_src
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1iG15B5sUrntNJCjpIXT7Li1IHOlpvSKc/view?usp=sharing][Fertilidade]] da seguinte maneira.

#+NAME: 2fdd5ef8-a4b3-40b7-8bf6-01a52c30c1ea
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/Fertility.csv')
  head(data,5)
#+end_src

#+RESULTS: 2fdd5ef8-a4b3-40b7-8bf6-01a52c30c1ea
:   Age LowAFC MeanAFC FSH E2 MaxE2 MaxDailyGn TotalGn Oocytes Embryos
: 1 40  40     51.5    5.3 45 1427  300        2700    25      13     
: 2 37  41     41.0    7.1 53  802  225        1800     7       6     
: 3 40  38     41.0    4.9 40 4533  450        4850    27      15     
: 4 40  36     37.5    3.9 26 1804  300        2700     9       4     
: 5 30  36     36.0    4.0 49 2526  150        1500    19      12     

*** Regressão e Teste de Shapiro (não normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: e8b3f285-8453-403c-ad20-daf89043a281
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(MeanAFC ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: e8b3f285-8453-403c-ad20-daf89043a281
#+begin_example

Call:
lm(formula = MeanAFC ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2817 -1.2920 -0.7525  0.5865 10.8763 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.708e-01  1.212e+00   0.224 0.823268    
Age         -3.723e-02  3.162e-02  -1.177 0.239918    
LowAFC       1.014e+00  2.077e-02  48.791  < 2e-16 ***
FSH          8.444e-02  7.315e-02   1.154 0.249177    
E2           5.181e-04  8.150e-03   0.064 0.949356    
MaxE2       -1.088e-04  1.842e-04  -0.591 0.555048    
MaxDailyGn   2.809e-03  2.637e-03   1.065 0.287506    
TotalGn     -6.837e-05  2.147e-04  -0.318 0.750353    
Oocytes      1.311e-01  3.388e-02   3.868 0.000133 ***
Embryos     -6.923e-02  4.605e-02  -1.503 0.133740    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.21 on 323 degrees of freedom
Multiple R-squared:  0.9139,	Adjusted R-squared:  0.9115 
F-statistic: 380.9 on 9 and 323 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 244c7824-094e-46aa-8ece-5d84588879c7
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 244c7824-094e-46aa-8ece-5d84588879c7
#+begin_example
Start:  AIC=537.92
MeanAFC ~ Age + LowAFC + FSH + E2 + MaxE2 + MaxDailyGn + TotalGn + 
    Oocytes + Embryos

             Df Sum of Sq     RSS     AIC
- E2          1       0.0  1577.3  535.92
- TotalGn     1       0.5  1577.8  536.02
- MaxE2       1       1.7  1579.0  536.28
- MaxDailyGn  1       5.5  1582.8  537.09
- FSH         1       6.5  1583.8  537.29
- Age         1       6.8  1584.0  537.34
<none>                     1577.3  537.92
- Embryos     1      11.0  1588.3  538.24
- Oocytes     1      73.0  1650.3  550.99
- LowAFC      1   11624.9 13202.1 1243.44

Step:  AIC=535.92
MeanAFC ~ Age + LowAFC + FSH + MaxE2 + MaxDailyGn + TotalGn + 
    Oocytes + Embryos

             Df Sum of Sq     RSS     AIC
- TotalGn     1       0.5  1577.8  534.03
- MaxE2       1       1.7  1579.0  534.28
- MaxDailyGn  1       5.5  1582.8  535.09
- FSH         1       6.5  1583.8  535.29
- Age         1       6.8  1584.1  535.35
<none>                     1577.3  535.92
- Embryos     1      11.0  1588.3  536.24
+ E2          1       0.0  1577.3  537.92
- Oocytes     1      73.4  1650.6  549.06
- LowAFC      1   11816.3 13393.6 1246.23

Step:  AIC=534.03
MeanAFC ~ Age + LowAFC + FSH + MaxE2 + MaxDailyGn + Oocytes + 
    Embryos

             Df Sum of Sq     RSS     AIC
- MaxE2       1       1.7  1579.5  532.38
- FSH         1       6.1  1583.9  533.31
- Age         1       6.8  1584.6  533.46
<none>                     1577.8  534.03
- MaxDailyGn  1      10.1  1587.9  534.16
- Embryos     1      11.0  1588.8  534.35
+ TotalGn     1       0.5  1577.3  535.92
+ E2          1       0.0  1577.8  536.02
- Oocytes     1      73.3  1651.1  547.14
- LowAFC      1   11836.0 13413.8 1244.73

Step:  AIC=532.38
MeanAFC ~ Age + LowAFC + FSH + MaxDailyGn + Oocytes + Embryos

             Df Sum of Sq     RSS     AIC
- FSH         1       6.3  1585.8  531.71
- Age         1       7.3  1586.8  531.92
<none>                     1579.5  532.38
- MaxDailyGn  1      11.9  1591.3  532.88
- Embryos     1      12.0  1591.5  532.90
+ MaxE2       1       1.7  1577.8  534.03
+ TotalGn     1       0.5  1579.0  534.28
+ E2          1       0.0  1579.5  534.38
- Oocytes     1      72.5  1651.9  545.32
- LowAFC      1   11839.7 13419.2 1242.87

Step:  AIC=531.71
MeanAFC ~ Age + LowAFC + MaxDailyGn + Oocytes + Embryos

             Df Sum of Sq     RSS     AIC
- Age         1       6.8  1592.5  531.13
<none>                     1585.8  531.71
- Embryos     1      11.9  1597.7  532.20
+ FSH         1       6.3  1579.5  532.38
+ MaxE2       1       1.9  1583.9  533.31
- MaxDailyGn  1      18.4  1604.2  533.55
+ TotalGn     1       0.1  1585.7  533.69
+ E2          1       0.0  1585.7  533.70
- Oocytes     1      68.8  1654.5  543.84
- LowAFC      1   11935.7 13521.4 1243.39

Step:  AIC=531.13
MeanAFC ~ LowAFC + MaxDailyGn + Oocytes + Embryos

             Df Sum of Sq     RSS     AIC
<none>                     1592.5  531.13
- Embryos     1      10.8  1603.3  531.37
- MaxDailyGn  1      11.8  1604.3  531.58
+ Age         1       6.8  1585.8  531.71
+ FSH         1       5.8  1586.8  531.92
+ MaxE2       1       2.4  1590.1  532.62
+ TotalGn     1       0.1  1592.5  533.11
+ E2          1       0.0  1592.5  533.12
- Oocytes     1      65.5  1658.0  542.54
- LowAFC      1   11936.3 13528.8 1241.58

Call:
lm(formula = MeanAFC ~ LowAFC + MaxDailyGn + Oocytes + Embryos, 
    data = data)

Coefficients:
(Intercept)       LowAFC   MaxDailyGn      Oocytes      Embryos  
   -0.40456      1.01104      0.00182      0.11833     -0.06786  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = MeanAFC ~ LowAFC + MaxDailyGn + Oocytes + Embryos, 
    data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 2c85d705-d6e1-4b24-b338-8552caa6d23c
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 2c85d705-d6e1-4b24-b338-8552caa6d23c
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.76651, p-value < 2.2e-16
: 
p-value < 2.2e-16 <=> p-value bem menor que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-datasets-attitude][Atitudes em relação à empresa]] (normal)
+ *Modelar e modelar o rating*
*** Sobre o =Conjunto=
+ Dados: (em percentagem)
  - Complaints: percentagem de resoluções de reclamações.
  - Privileges: percentagem de intolerância de privilégios.
  - Learning: percentagem de oportunidade de aprendizado.
  - Raises: percetagem de aumento correspondente à perfôrmance.
  - Critical: percentagem de atitudes e críticas exacerbadas.
  - Advancel: percentadem de evolução percebida da empresa e posto.
  - Rating: avaliação geral positiva da empresa

*** Como utilizar pelo R
O =conjunto de dados= se encontra sob o pacote =datasets=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  install.packages("datasets",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  library(datasets)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- data("attitude")
  head(data)
#+end_src
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1rKj4NPD61bWKD6HBC4fux2Eit6CNEKwr/view?usp=sharing][Atitude]] da seguinte maneira.

#+NAME: 0c9fa0ff-40fc-40a6-97dc-0408e43d9a91
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/attitude.csv')
  head(data,5)
#+end_src

#+RESULTS: 0c9fa0ff-40fc-40a6-97dc-0408e43d9a91
:   rating complaints privileges learning raises critical advance
: 1 43     51         30         39       61     92       45     
: 2 63     64         51         54       63     73       47     
: 3 71     70         68         69       76     86       48     
: 4 61     63         45         47       54     84       35     
: 5 81     78         56         66       71     83       47     


*** Regressão e Teste de Shapiro (normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 0a524106-c797-4cfb-be68-9a0928e65183
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(rating ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 0a524106-c797-4cfb-be68-9a0928e65183
#+begin_example

Call:
lm(formula = rating ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.9418  -4.3555   0.3158   5.5425  11.5990 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 10.78708   11.58926   0.931 0.361634    
complaints   0.61319    0.16098   3.809 0.000903 ***
privileges  -0.07305    0.13572  -0.538 0.595594    
learning     0.32033    0.16852   1.901 0.069925 .  
raises       0.08173    0.22148   0.369 0.715480    
critical     0.03838    0.14700   0.261 0.796334    
advance     -0.21706    0.17821  -1.218 0.235577    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.068 on 23 degrees of freedom
Multiple R-squared:  0.7326,	Adjusted R-squared:  0.6628 
F-statistic:  10.5 on 6 and 23 DF,  p-value: 1.24e-05

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 05b2f91c-86fc-4c01-89a4-f1bdf24061b0
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 05b2f91c-86fc-4c01-89a4-f1bdf24061b0
#+begin_example
Start:  AIC=123.36
rating ~ complaints + privileges + learning + raises + critical + 
    advance

             Df Sum of Sq    RSS    AIC
- critical    1      3.41 1152.4 121.45
- raises      1      6.80 1155.8 121.54
- privileges  1     14.47 1163.5 121.74
- advance     1     74.11 1223.1 123.24
<none>                    1149.0 123.36
- learning    1    180.50 1329.5 125.74
- complaints  1    724.80 1873.8 136.04

Step:  AIC=121.45
rating ~ complaints + privileges + learning + raises + advance

             Df Sum of Sq    RSS    AIC
- raises      1     10.61 1163.0 119.73
- privileges  1     14.16 1166.6 119.82
- advance     1     71.27 1223.7 121.25
<none>                    1152.4 121.45
+ critical    1      3.41 1149.0 123.36
- learning    1    177.74 1330.1 123.75
- complaints  1    724.70 1877.1 134.09

Step:  AIC=119.73
rating ~ complaints + privileges + learning + advance

             Df Sum of Sq    RSS    AIC
- privileges  1     16.10 1179.1 118.14
- advance     1     61.60 1224.6 119.28
<none>                    1163.0 119.73
+ raises      1     10.61 1152.4 121.45
+ critical    1      7.21 1155.8 121.54
- learning    1    197.03 1360.0 122.42
- complaints  1   1165.94 2328.9 138.56

Step:  AIC=118.14
rating ~ complaints + learning + advance

             Df Sum of Sq    RSS    AIC
- advance     1     75.54 1254.7 118.00
<none>                    1179.1 118.14
+ privileges  1     16.10 1163.0 119.73
+ raises      1     12.54 1166.6 119.82
+ critical    1      7.18 1171.9 119.96
- learning    1    186.12 1365.2 120.54
- complaints  1   1259.91 2439.0 137.94

Step:  AIC=118
rating ~ complaints + learning

             Df Sum of Sq    RSS    AIC
<none>                    1254.7 118.00
+ advance     1     75.54 1179.1 118.14
- learning    1    114.73 1369.4 118.63
+ privileges  1     30.03 1224.6 119.28
+ raises      1      1.19 1253.5 119.97
+ critical    1      0.00 1254.7 120.00
- complaints  1   1370.91 2625.6 138.16

Call:
lm(formula = rating ~ complaints + learning, data = data)

Coefficients:
(Intercept)   complaints     learning  
     9.8709       0.6435       0.2112  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: d16de9ae-ffe8-4fca-8f0b-bf27dce7df65
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = rating ~ complaints + learning, data = data)
#+end_src

#+RESULTS: d16de9ae-ffe8-4fca-8f0b-bf27dce7df65

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: eebb6bf5-088f-423d-9ecc-9e8079403d8b
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: eebb6bf5-088f-423d-9ecc-9e8079403d8b
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.94486, p-value = 0.123
: 

p-value = 0.123 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-datasets-lifecyclesavings][Hipótese de ciclos-de-economia salarial]] (normal)
+ *Modelar =sr=, a partir das outra variáveis*
+ Hipótese formulada por Franco Modigliani 1960-1970, de que essas (outras)
  variáveis eram explicativas do fenômeno 'sr'.
*** Sobre o =Conjunto=
+ Dados:
  - Sr: valor agregado à economia particular (razão entre valor total de economias pessoais e salário líquido)
  - Pop15: população sob quinze anos de idade.
  - Pop75: população acima de setenta e cinco anos de idade.
  - dpi: valor de salário líquido per-capita médio.
  - ddpi: taxa de crescimento de dpi.

*** Como utilizar pelo R
O =conjunto de dados= se encontra sob o pacote =datasets=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no
  install.packages("datasets",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(datasets)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- data("LifeCycleSavings")
  head(data)
#+end_src
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1j2K7J1rb3V2Qr_t0rcBhA6tyuqh88AjY/view?usp=sharing][savings.csv]] da seguinte maneira.

#+NAME: 55f95ab4-e4b5-45aa-9760-d3158f2a9800
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/savings.csv')
  head(data,5)
#+end_src

#+RESULTS: 55f95ab4-e4b5-45aa-9760-d3158f2a9800
:           sr    pop15 pop75 dpi     ddpi
: Australia 11.43 29.35 2.87  2329.68 2.87
: Austria   12.07 23.32 4.41  1507.99 3.93
: Belgium   13.17 23.80 4.43  2108.47 3.82
: Bolivia    5.75 41.89 1.67   189.13 0.22
: Brazil    12.88 42.19 0.83   728.47 4.56

*** Regressão e Teste de Shapiro (normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 9b9354e1-fccc-4503-a1d9-3070a06569cb
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(sr ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 9b9354e1-fccc-4503-a1d9-3070a06569cb
#+begin_example

Call:
lm(formula = sr ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.2422 -2.6857 -0.2488  2.4280  9.7509 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) 28.5660865  7.3545161   3.884 0.000334 ***
pop15       -0.4611931  0.1446422  -3.189 0.002603 ** 
pop75       -1.6914977  1.0835989  -1.561 0.125530    
dpi         -0.0003369  0.0009311  -0.362 0.719173    
ddpi         0.4096949  0.1961971   2.088 0.042471 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.803 on 45 degrees of freedom
Multiple R-squared:  0.3385,	Adjusted R-squared:  0.2797 
F-statistic: 5.756 on 4 and 45 DF,  p-value: 0.0007904

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: f4b39672-38c9-4800-ad09-6125d56989b5
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: f4b39672-38c9-4800-ad09-6125d56989b5
#+begin_example
Start:  AIC=138.3
sr ~ pop15 + pop75 + dpi + ddpi

        Df Sum of Sq    RSS    AIC
- dpi    1     1.893 652.61 136.45
<none>               650.71 138.30
- pop75  1    35.236 685.95 138.94
- ddpi   1    63.054 713.77 140.93
- pop15  1   147.012 797.72 146.49

Step:  AIC=136.45
sr ~ pop15 + pop75 + ddpi

        Df Sum of Sq    RSS    AIC
<none>               652.61 136.45
- pop75  1    47.946 700.55 137.99
+ dpi    1     1.893 650.71 138.30
- ddpi   1    73.562 726.17 139.79
- pop15  1   145.789 798.40 144.53

Call:
lm(formula = sr ~ pop15 + pop75 + ddpi, data = data)

Coefficients:
(Intercept)        pop15        pop75         ddpi  
    28.1247      -0.4518      -1.8354       0.4278  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = sr ~ pop15 + pop75 + ddpi, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 2550f23c-762f-4845-9957-75c9edc783a8
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 2550f23c-762f-4845-9957-75c9edc783a8
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.98764, p-value = 0.8765
: 

p-value = 0.8765 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

** [[https://r-data.pmagunia.com/dataset/r-dataset-package-ecdat-computers][Preço de Computadores 1993-1995]] (não normal)
+ *Modelar preço (=price=) a partir das variáveis*.
*** Dados sobre o =Conjunto=
+ Dados:
  - Speed: velocidade de rotação em MHz do processador (clock speed)
  - HD: tamanho da memória do disco rígido em MB
  - RAM: tamanho da RAM em MB
  - Screen: tamanho da tela em polegadas
  - CD: tem ou não entrada para CDs.
  - Multi: kit multimídia incluso ou não (caixa de som etc).
  - Premium: manufatura feita por compania conhecida (IBM etc).
  - Ads: quantidade de anúncio do computador por mês.
  - Trend: quanto tempo está no mercado.
*** Como utilizar pelo R
O =conjunto de dados= se encontra sob o pacote =Ecdat=. Desta forma, precisamos
instalá-lo.

#+NAME: f663ac49-0205-4c4e-8eb3-46b1fb24d2cc
#+begin_src ein-r :session localhost :results output :exports both :eval no
  install.packages("Ecdat",mirror="https://vps.fmvz.usp.br/CRAN/")
#+end_src

Após instalação, precisamos invocar o pacote,
#+NAME: f0a47caf-ec1f-4ffd-bedf-4d287123b9b2
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(Ecdat)
#+end_src

Finalmente, podemos acessar o =conjunto=,
#+NAME: 243315b4-3773-4322-a633-1d03ed1c4808
#+begin_src ein-r :session localhost :results output :exports both :eval no
  data <- data("Computers")
  head(data)
#+end_src

*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1C1-9aM-dYzx7UQrWq_gg4DRw6wtj-l7Z/view?usp=sharing][computers.csv]] da seguinte maneira.

#+NAME: 99023fe8-ab5e-4f3f-8a14-2f1ea15aa094
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/computers.csv')
  head(data,5)
#+end_src

#+RESULTS: 99023fe8-ab5e-4f3f-8a14-2f1ea15aa094
:   price speed hd  ram screen cd multi premium ads trend
: 1 1499  25     80  4  14     no no    yes     94  1    
: 2 1795  33     85  2  14     no no    yes     94  1    
: 3 1595  25    170  4  15     no no    yes     94  1    
: 4 1849  25    170  8  14     no no    no      94  1    
: 5 3295  33    340 16  14     no no    yes     94  1    

*** Regressão e Teste de Shapiro (não normal)

**** Transformar variaveis categoricas
#+NAME: 1a5e9119-5cd6-40b6-aa31-9e0a9cb51c95
#+begin_src ein-r :session localhost :results output :exports both :eval no
  categoricalToNumeric <- function(data,...) {
    cols <- c(...)
    data[cols] <- lapply(data[cols], function(x) as.numeric(as.factor(x)))
    summary(data)
  }
#+end_src

#+RESULTS: 1a5e9119-5cd6-40b6-aa31-9e0a9cb51c95

#+NAME: a0a6d5aa-24b0-478d-b7fe-ab8c04900749
#+begin_src ein-r :session localhost :results output
categoricalToNumeric(data,'screen', 'cd', 'multi', 'premium')
#+end_src

#+RESULTS: a0a6d5aa-24b0-478d-b7fe-ab8c04900749
#+begin_example
     price          speed              hd              ram        
 Min.   : 949   Min.   : 25.00   Min.   :  80.0   Min.   : 2.000  
 1st Qu.:1794   1st Qu.: 33.00   1st Qu.: 214.0   1st Qu.: 4.000  
 Median :2144   Median : 50.00   Median : 340.0   Median : 8.000  
 Mean   :2220   Mean   : 52.01   Mean   : 416.6   Mean   : 8.287  
 3rd Qu.:2595   3rd Qu.: 66.00   3rd Qu.: 528.0   3rd Qu.: 8.000  
 Max.   :5399   Max.   :100.00   Max.   :2100.0   Max.   :32.000  
     screen            cd            multi          premium     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:2.000  
 Median :1.000   Median :1.000   Median :1.000   Median :2.000  
 Mean   :1.512   Mean   :1.465   Mean   :1.139   Mean   :1.902  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:1.000   3rd Qu.:2.000  
 Max.   :3.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  
      ads            trend      
 Min.   : 39.0   Min.   : 1.00  
 1st Qu.:162.5   1st Qu.:10.00  
 Median :246.0   Median :16.00  
 Mean   :221.3   Mean   :15.93  
 3rd Qu.:275.0   3rd Qu.:21.50  
 Max.   :339.0   Max.   :35.00  
#+end_example

**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: b468e866-ded0-4d67-acbb-68aee4696e03
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(price ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: b468e866-ded0-4d67-acbb-68aee4696e03
#+begin_example

Call:
lm(formula = price ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1093.77  -174.24   -11.49   146.49  2001.05 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  307.98798   60.35341   5.103 3.44e-07 ***
speed          9.32028    0.18506  50.364  < 2e-16 ***
hd             0.78178    0.02761  28.311  < 2e-16 ***
ram           48.25596    1.06608  45.265  < 2e-16 ***
screen       123.08904    3.99950  30.776  < 2e-16 ***
cdyes         60.91671    9.51559   6.402 1.65e-10 ***
multiyes     104.32382   11.41268   9.141  < 2e-16 ***
premiumyes  -509.22473   12.34225 -41.259  < 2e-16 ***
ads            0.65729    0.05132  12.809  < 2e-16 ***
trend        -51.84958    0.62871 -82.470  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 275.3 on 6249 degrees of freedom
Multiple R-squared:  0.7756,	Adjusted R-squared:  0.7752 
F-statistic:  2399 on 9 and 6249 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 3791a9a0-6ef6-4abc-bc96-7c18ae28894f
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 3791a9a0-6ef6-4abc-bc96-7c18ae28894f
#+begin_example
Start:  AIC=70336.65
price ~ speed + hd + ram + screen + cd + multi + premium + ads + 
    trend

          Df Sum of Sq       RSS   AIC
<none>                 473783875 70337
- cd       1   3107211 476891087 70376
- multi    1   6335218 480119093 70418
- ads      1  12439298 486223174 70497
- hd       1  60768013 534551889 71090
- screen   1  71812147 545596023 71218
- premium  1 129062420 602846296 71843
- ram      1 155342777 629126653 72110
- speed    1 192316497 666100373 72467
- trend    1 515661043 989444918 74944

Call:
lm(formula = price ~ speed + hd + ram + screen + cd + multi + 
    premium + ads + trend, data = data)

Coefficients:
(Intercept)        speed           hd          ram       screen        cdyes  
   307.9880       9.3203       0.7818      48.2560     123.0890      60.9167  
   multiyes   premiumyes          ads        trend  
   104.3238    -509.2247       0.6573     -51.8496  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = price ~ speed + hd + ram + screen + cd + multi + 
    premium + ads + trend, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: ce2682c0-c80d-4ec2-86d2-3c913ee85d94
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals[1:5000])
#+end_src

#+RESULTS: ce2682c0-c80d-4ec2-86d2-3c913ee85d94
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals[1:5000]
: W = 0.95749, p-value < 2.2e-16
: 

p-value < 2.2e-16 <=> p-value muito menor que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

** [[https://www.sheffield.ac.uk/mash/statistics/datasets][Peso ao Nascimento]]  (normal)
+ *Modelar peso ao nascimento (libras) (=Birthweight=) a partir das variáveis*.
*** Dados sobre o =Conjunto=
 + Dados:
   - lowbwt: baixo peso ao nascer. 
   - ID: Identificador
   - mage35: mãe mais velha do que 35 anos.
   - fnocig: número de cigarros fumado pelo pai diariamente.
   - fheight: peso do pai (kg)
   - fedyrs: quantidade de anos de educação do pai
   - fage: idade do pai
   - mppwt: peso da mãe pré gravidez.
   - mheight: tamanho da mãe (cm).
   - mnocig: número de cigarros fumados diariamente pela mãe.
   - Motherage: idade da mãe.
   - Gestation Smoker: fumante durante gestação 
   - headcirumfer: circunferência da cabeça
   - length: tamanho (cm)
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1xv2lCPsj04FjGPQ_BgPS9mrTIjBcyHQk/view?usp=sharing][Birth Weight]] da seguinte maneira.

#+NAME: faf49cb0-5462-42a7-8825-0cf42b057ea8
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/Birthweight_reduced_kg_R.csv')
  head(data,5)
#+end_src

#+RESULTS: faf49cb0-5462-42a7-8825-0cf42b057ea8
#+begin_example
  X...ID Length Birthweight Headcirc Gestation smoker mage mnocig mheight mppwt
1 1360   56     4.55        34       44        0      20   0      162     57   
2 1016   53     4.32        36       40        0      19   0      171     62   
3  462   58     4.10        39       41        0      35   0      172     58   
4 1187   53     4.07        38       44        0      20   0      174     68   
5  553   54     3.94        37       42        0      24   0      175     66   
  fage fedyrs fnocig fheight lowbwt mage35
1 23   10     35     179     0      0     
2 19   12      0     183     0      0     
3 31   16     25     185     0      1     
4 26   14     25     189     0      0     
5 30   12      0     184     0      0     
#+end_example

*** Regressão e Teste de Shapiro (normal)

**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 8fb75c7d-4a1f-4f5d-974a-8e62f4073bac
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(Birthweight ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 8fb75c7d-4a1f-4f5d-974a-8e62f4073bac
#+begin_example

Call:
lm(formula = Birthweight ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.47678 -0.20907 -0.02438  0.20960  0.60017 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)   
(Intercept) -3.830e+00  2.169e+00  -1.766  0.08916 . 
X...ID      -6.808e-05  1.394e-04  -0.488  0.62931   
Length       5.171e-02  3.888e-02   1.330  0.19503   
Headcirc     8.688e-02  2.997e-02   2.899  0.00751 **
Gestation    9.189e-02  3.219e-02   2.855  0.00834 **
smoker      -2.320e-01  1.738e-01  -1.335  0.19353   
mage         1.746e-02  2.904e-02   0.601  0.55293   
mnocig       2.143e-03  7.078e-03   0.303  0.76442   
mheight      1.366e-03  1.473e-02   0.093  0.92680   
mppwt        9.371e-03  1.156e-02   0.811  0.42498   
fage        -1.079e-02  1.977e-02  -0.546  0.58985   
fedyrs      -3.636e-03  3.185e-02  -0.114  0.90998   
fnocig       2.041e-03  4.311e-03   0.473  0.63991   
fheight     -1.543e-02  9.951e-03  -1.550  0.13317   
lowbwt      -1.612e-02  2.558e-01  -0.063  0.95023   
mage35      -5.557e-01  3.669e-01  -1.515  0.14194   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3349 on 26 degrees of freedom
Multiple R-squared:  0.805,	Adjusted R-squared:  0.6925 
F-statistic: 7.156 on 15 and 26 DF,  p-value: 7.497e-06

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 536d4c15-9e78-4dc3-a062-346efed9454c
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 536d4c15-9e78-4dc3-a062-346efed9454c
#+begin_example
Start:  AIC=-80.04
Birthweight ~ X...ID + Length + Headcirc + Gestation + smoker + 
    mage + mnocig + mheight + mppwt + fage + fedyrs + fnocig + 
    fheight + lowbwt + mage35

            Df Sum of Sq    RSS     AIC
- lowbwt     1   0.00045 2.9160 -82.033
- mheight    1   0.00096 2.9166 -82.025
- fedyrs     1   0.00146 2.9171 -82.018
- mnocig     1   0.01028 2.9259 -81.891
- fnocig     1   0.02513 2.9407 -81.679
- X...ID     1   0.02676 2.9423 -81.655
- fage       1   0.03341 2.9490 -81.561
- mage       1   0.04053 2.9561 -81.459
- mppwt      1   0.07368 2.9893 -80.991
<none>                   2.9156 -80.039
- Length     1   0.19840 3.1140 -79.274
- smoker     1   0.19978 3.1154 -79.256
- mage35     1   0.25725 3.1728 -78.488
- fheight    1   0.26951 3.1851 -78.326
- Gestation  1   0.91410 3.8297 -70.585
- Headcirc   1   0.94251 3.8581 -70.275

Step:  AIC=-82.03
Birthweight ~ X...ID + Length + Headcirc + Gestation + smoker + 
    mage + mnocig + mheight + mppwt + fage + fedyrs + fnocig + 
    fheight + mage35

            Df Sum of Sq    RSS     AIC
- mheight    1   0.00075 2.9168 -84.022
- fedyrs     1   0.00143 2.9175 -84.012
- mnocig     1   0.01182 2.9279 -83.863
- fnocig     1   0.02542 2.9415 -83.668
- X...ID     1   0.02842 2.9445 -83.625
- fage       1   0.03396 2.9500 -83.546
- mage       1   0.04337 2.9594 -83.413
- mppwt      1   0.08027 2.9963 -82.892
<none>                   2.9160 -82.033
- smoker     1   0.21097 3.1270 -81.099
- Length     1   0.25810 3.1741 -80.471
- fheight    1   0.28692 3.2030 -80.091
+ lowbwt     1   0.00045 2.9156 -80.039
- mage35     1   0.31943 3.2355 -79.667
- Headcirc   1   0.95078 3.8668 -72.180
- Gestation  1   0.95523 3.8713 -72.132

Step:  AIC=-84.02
Birthweight ~ X...ID + Length + Headcirc + Gestation + smoker + 
    mage + mnocig + mppwt + fage + fedyrs + fnocig + fheight + 
    mage35

            Df Sum of Sq    RSS     AIC
- fedyrs     1   0.00180 2.9186 -85.996
- mnocig     1   0.01321 2.9300 -85.832
- fnocig     1   0.02471 2.9415 -85.668
- X...ID     1   0.03082 2.9476 -85.580
- fage       1   0.04532 2.9621 -85.374
- mage       1   0.04921 2.9660 -85.319
<none>                   2.9168 -84.022
- mppwt      1   0.15874 3.0755 -83.796
- smoker     1   0.21100 3.1278 -83.088
- fheight    1   0.29026 3.2070 -82.037
+ mheight    1   0.00075 2.9160 -82.033
+ lowbwt     1   0.00023 2.9166 -82.025
- Length     1   0.31002 3.2268 -81.779
- mage35     1   0.32964 3.2464 -81.525
- Gestation  1   1.00467 3.9215 -73.591
- Headcirc   1   1.01254 3.9293 -73.507

Step:  AIC=-86
Birthweight ~ X...ID + Length + Headcirc + Gestation + smoker + 
    mage + mnocig + mppwt + fage + fnocig + fheight + mage35

            Df Sum of Sq    RSS     AIC
- mnocig     1   0.01179 2.9304 -87.827
- X...ID     1   0.03449 2.9531 -87.502
- fnocig     1   0.03474 2.9533 -87.499
- fage       1   0.04466 2.9632 -87.358
- mage       1   0.04776 2.9663 -87.314
<none>                   2.9186 -85.996
- mppwt      1   0.15814 3.0767 -85.780
- smoker     1   0.20920 3.1278 -85.088
+ fedyrs     1   0.00180 2.9168 -84.022
+ mheight    1   0.00112 2.9175 -84.012
+ lowbwt     1   0.00017 2.9184 -83.998
- Length     1   0.31615 3.2347 -83.676
- fheight    1   0.31819 3.2368 -83.650
- mage35     1   0.32792 3.2465 -83.524
- Gestation  1   1.00289 3.9215 -75.590
- Headcirc   1   1.01344 3.9320 -75.478

Step:  AIC=-87.83
Birthweight ~ X...ID + Length + Headcirc + Gestation + smoker + 
    mage + mppwt + fage + fnocig + fheight + mage35

            Df Sum of Sq    RSS     AIC
- X...ID     1   0.03286 2.9632 -89.358
- fnocig     1   0.03512 2.9655 -89.326
- fage       1   0.04919 2.9796 -89.127
- mage       1   0.05435 2.9847 -89.055
<none>                   2.9304 -87.827
- mppwt      1   0.17775 3.1081 -87.353
- smoker     1   0.27581 3.2062 -86.049
+ mnocig     1   0.01179 2.9186 -85.996
+ mheight    1   0.00232 2.9281 -85.860
+ lowbwt     1   0.00119 2.9292 -85.844
+ fedyrs     1   0.00038 2.9300 -85.832
- Length     1   0.30965 3.2400 -85.608
- mage35     1   0.32139 3.2518 -85.456
- fheight    1   0.33264 3.2630 -85.311
- Headcirc   1   1.00248 3.9329 -77.469
- Gestation  1   1.08456 4.0149 -76.601

Step:  AIC=-89.36
Birthweight ~ Length + Headcirc + Gestation + smoker + mage + 
    mppwt + fage + fnocig + fheight + mage35

            Df Sum of Sq    RSS     AIC
- fage       1   0.03185 2.9951 -90.909
- mage       1   0.03474 2.9980 -90.869
- fnocig     1   0.04184 3.0051 -90.769
<none>                   2.9632 -89.358
- mppwt      1   0.19808 3.1613 -88.641
- smoker     1   0.25291 3.2161 -87.918
+ X...ID     1   0.03286 2.9304 -87.827
- Length     1   0.27680 3.2400 -87.608
+ mnocig     1   0.01015 2.9531 -87.502
+ mheight    1   0.00653 2.9567 -87.451
- mage35     1   0.29055 3.2538 -87.430
+ lowbwt     1   0.00271 2.9605 -87.397
+ fedyrs     1   0.00266 2.9606 -87.396
- fheight    1   0.32404 3.2873 -87.000
- Headcirc   1   1.10049 4.0637 -78.094
- Gestation  1   1.11010 4.0733 -77.995

Step:  AIC=-90.91
Birthweight ~ Length + Headcirc + Gestation + smoker + mage + 
    mppwt + fnocig + fheight + mage35

            Df Sum of Sq    RSS     AIC
- mage       1   0.00479 2.9999 -92.842
- fnocig     1   0.03316 3.0283 -92.447
<none>                   2.9951 -90.909
- mppwt      1   0.20782 3.2029 -90.092
+ fage       1   0.03185 2.9632 -89.358
- mage35     1   0.27044 3.2655 -89.278
+ mheight    1   0.01967 2.9754 -89.186
- Length     1   0.28104 3.2761 -89.142
+ X...ID     1   0.01552 2.9796 -89.127
+ mnocig     1   0.01411 2.9810 -89.108
- smoker     1   0.28593 3.2810 -89.080
- fheight    1   0.29391 3.2890 -88.978
+ lowbwt     1   0.00210 2.9930 -88.939
+ fedyrs     1   0.00099 2.9941 -88.923
- Gestation  1   1.08113 4.0762 -79.965
- Headcirc   1   1.08377 4.0789 -79.938

Step:  AIC=-92.84
Birthweight ~ Length + Headcirc + Gestation + smoker + mppwt + 
    fnocig + fheight + mage35

            Df Sum of Sq    RSS     AIC
- fnocig     1   0.04110 3.0410 -94.271
<none>                   2.9999 -92.842
- mppwt      1   0.24205 3.2419 -91.583
- Length     1   0.27708 3.2770 -91.132
- smoker     1   0.28184 3.2817 -91.071
+ mnocig     1   0.01556 2.9843 -91.060
+ mheight    1   0.01466 2.9852 -91.048
+ X...ID     1   0.01286 2.9870 -91.022
+ mage       1   0.00479 2.9951 -90.909
+ lowbwt     1   0.00413 2.9958 -90.900
+ fage       1   0.00191 2.9980 -90.869
+ fedyrs     1   0.00001 2.9999 -90.842
- fheight    1   0.32021 3.3201 -90.582
- mage35     1   0.42322 3.4231 -89.299
- Gestation  1   1.10582 4.1057 -81.662
- Headcirc   1   1.15094 4.1508 -81.203

Step:  AIC=-94.27
Birthweight ~ Length + Headcirc + Gestation + smoker + mppwt + 
    fheight + mage35

            Df Sum of Sq    RSS     AIC
<none>                   3.0410 -94.271
- smoker     1   0.24149 3.2825 -93.061
- mppwt      1   0.24976 3.2907 -92.955
+ fnocig     1   0.04110 2.9999 -92.842
- fheight    1   0.28072 3.3217 -92.562
+ X...ID     1   0.01742 3.0236 -92.512
+ mnocig     1   0.01619 3.0248 -92.495
+ mage       1   0.01273 3.0283 -92.447
+ mheight    1   0.00774 3.0332 -92.378
+ fedyrs     1   0.00281 3.0382 -92.309
+ lowbwt     1   0.00031 3.0407 -92.275
+ fage       1   0.00011 3.0409 -92.272
- Length     1   0.32176 3.3627 -92.046
- mage35     1   0.47313 3.5141 -90.197
- Gestation  1   1.06836 4.1093 -83.625
- Headcirc   1   1.15478 4.1958 -82.751

Call:
lm(formula = Birthweight ~ Length + Headcirc + Gestation + smoker + 
    mppwt + fheight + mage35, data = data)

Coefficients:
(Intercept)       Length     Headcirc    Gestation       smoker        mppwt  
   -3.91717      0.05011      0.08611      0.08703     -0.16006      0.01198  
    fheight       mage35  
   -0.01274     -0.38636  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = Birthweight ~ Length + Headcirc + Gestation + smoker + 
    mppwt + fheight + mage35, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 15296fc8-510a-4eb3-af4c-7d2d881a0807
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 15296fc8-510a-4eb3-af4c-7d2d881a0807
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.95885, p-value = 0.1343
: 

p-value = 0.1343 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

** [[https://www.sheffield.ac.uk/mash/statistics/datasets][Crime]] (normal)  
+ *Modelar taxa de crime (=CrimeRate=) a partir das variáveis*.
*** Dados sobre o =Conjunto=
+ Dados:
  - CrimeRate: Taxa de criminalidade (ofensas por milhão de habitantes). 
  - Youth: Jovens entre 18-24 anos a cada mil habitantes. 
  - Southern: Estado do sul? 
  - Education: Tempo de educação (anos de estudo até 25) 
  - ExpenditureYear0: Dinheiro para segurança pública per capta.
  - LabourForce: Quantidade de jovens trabalhadores por 1000 habitantes.
  - Males: Homens (por cada 1000 mulheres).
  - MoreMales: Mais homens que mulheres?.
  - StateSize: Tamanho do estado em milhares.
  - YouthUnemployment: Desemprego de jovens por mil.
  - BelowWage: Número de famílias abaixo de meio salário por mil.
  - Wage: Salário médio semanal.
  - MatureUnemployment: Desemprego de sêniors (35-39) por mil.

*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto [[https://drive.google.com/file/d/1hZpHoEXbhZGvmtmrbcWpXYfBV-2ZD7uF/view?usp=sharing][Crimes]] da seguinte maneira.

#+NAME: 5aab5e19-1737-4f19-9ab5-45178e50e0f2
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data <- read.csv('./data/csv/Crime_R.csv')
  head(data,5)
#+end_src

#+RESULTS: 5aab5e19-1737-4f19-9ab5-45178e50e0f2
#+begin_example
  X...CrimeRate Youth Southern Education ExpenditureYear0 LabourForce Males
1 45.5          135   0        12.4       69              540          965 
2 52.3          140   0        10.9       55              535         1045 
3 56.6          157   1        11.2       47              512          962 
4 60.3          139   1        11.9       46              480          968 
5 64.2          126   0        12.2      106              599          989 
  MoreMales StateSize YouthUnemployment ... ExpenditureYear10 LabourForce10
1 0          6         80               ... 71                564          
2 1          6        135               ... 54                540          
3 0         22         97               ... 44                529          
4 0         19        135               ... 41                497          
5 0         40         78               ... 97                602          
  Males10 MoreMales10 StateSize10 YouthUnemploy10 MatureUnemploy10
1  974    0            6           82             20              
2 1039    1            7          138             39              
3  959    0           24           98             33              
4  983    0           20          131             50              
5  989    0           42           79             24              
  HighYouthUnemploy10 Wage10 BelowWage10
1 1                   632    142        
2 1                   521    210        
3 0                   359    256        
4 0                   510    235        
5 1                   660    162        
#+end_example

*** Regressão e Teste de Shapiro (normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 55e8d4ad-ef9d-4618-9a62-0fe559ca36b1
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein <- lm(X...CrimeRate ~ . , data)
  summary(modreg_trein)
#+end_src

#+RESULTS: 55e8d4ad-ef9d-4618-9a62-0fe559ca36b1
#+begin_example

Call:
lm(formula = X...CrimeRate ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7169 -0.8068  0.1067  0.7969  2.7024 

Coefficients:
                     Estimate Std. Error t value Pr(>|t|)    
(Intercept)         31.179959  24.586183   1.268   0.2193    
Youth               -0.047450   0.062098  -0.764   0.4537    
Southern            -1.750704   1.475258  -1.187   0.2492    
Education            1.450580   3.253357   0.446   0.6605    
ExpenditureYear0     0.337407   0.119796   2.817   0.0107 *  
LabourForce         -0.020361   0.041917  -0.486   0.6324    
Males               -0.064828   0.036138  -1.794   0.0880 .  
MoreMales            0.823135   3.192155   0.258   0.7991    
StateSize           -0.197694   0.334701  -0.591   0.5614    
YouthUnemployment   -0.114566   0.194817  -0.588   0.5631    
MatureUnemployment  -0.399896   0.239421  -1.670   0.1104    
HighYouthUnemploy    0.597149   1.562191   0.382   0.7063    
Wage                -0.006439   0.026973  -0.239   0.8137    
BelowWage            0.036793   0.046376   0.793   0.4369    
CrimeRate10          0.734102   0.013667  53.715   <2e-16 ***
Youth10              0.010987   0.060690   0.181   0.8582    
Education10         -1.470504   3.075265  -0.478   0.6377    
ExpenditureYear10   -0.300559   0.129053  -2.329   0.0305 *  
LabourForce10        0.034297   0.047031   0.729   0.4743    
Males10              0.057152   0.028958   1.974   0.0624 .  
MoreMales10         -3.121975   2.717061  -1.149   0.2641    
StateSize10          0.158700   0.324051   0.490   0.6296    
YouthUnemploy10      0.117936   0.189152   0.624   0.5400    
MatureUnemploy10     0.448407   0.214681   2.089   0.0497 *  
HighYouthUnemploy10  0.342417   1.230333   0.278   0.7836    
Wage10              -0.003951   0.025435  -0.155   0.8781    
BelowWage10         -0.023423   0.044681  -0.524   0.6059    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.923 on 20 degrees of freedom
Multiple R-squared:  0.9981,	Adjusted R-squared:  0.9956 
F-statistic: 398.5 on 26 and 20 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: 228b2515-c9d9-4fd5-86e5-457e6110ead9
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein, direction="both", keep=NULL)
#+end_src

#+RESULTS: 228b2515-c9d9-4fd5-86e5-457e6110ead9
#+begin_example
Start:  AIC=75.33
X...CrimeRate ~ Youth + Southern + Education + ExpenditureYear0 + 
    LabourForce + Males + MoreMales + StateSize + YouthUnemployment + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + Youth10 + Education10 + ExpenditureYear10 + 
    LabourForce10 + Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + 
    MatureUnemploy10 + HighYouthUnemploy10 + Wage10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- Wage10               1       0.1    74.1  73.384
- Youth10              1       0.1    74.1  73.404
- Wage                 1       0.2    74.2  73.461
- MoreMales            1       0.2    74.2  73.483
- HighYouthUnemploy10  1       0.3    74.3  73.509
- HighYouthUnemploy    1       0.5    74.5  73.669
- Education            1       0.7    74.7  73.792
- Education10          1       0.8    74.8  73.861
- LabourForce          1       0.9    74.9  73.878
- StateSize10          1       0.9    74.9  73.887
- BelowWage10          1       1.0    75.0  73.968
- YouthUnemployment    1       1.3    75.3  74.133
- StateSize            1       1.3    75.3  74.140
- YouthUnemploy10      1       1.4    75.4  74.232
- LabourForce10        1       2.0    76.0  74.560
- Youth                1       2.2    76.1  74.679
- BelowWage            1       2.3    76.3  74.783
<none>                                74.0  75.327
- MoreMales10          1       4.9    78.9  76.331
- Southern             1       5.2    79.2  76.525
- MatureUnemployment   1      10.3    84.3  79.464
- Males                1      11.9    85.9  80.339
- Males10              1      14.4    88.4  81.690
- MatureUnemploy10     1      16.1    90.1  82.601
- ExpenditureYear10    1      20.1    94.1  84.605
- ExpenditureYear0     1      29.3   103.3  89.028
- CrimeRate10          1   10674.0 10748.0 307.320

Step:  AIC=73.38
X...CrimeRate ~ Youth + Southern + Education + ExpenditureYear0 + 
    LabourForce + Males + MoreMales + StateSize + YouthUnemployment + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + Youth10 + Education10 + ExpenditureYear10 + 
    LabourForce10 + Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + 
    MatureUnemploy10 + HighYouthUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- Youth10              1       0.2    74.2  71.492
- HighYouthUnemploy10  1       0.2    74.3  71.509
- MoreMales            1       0.3    74.3  71.544
- Education            1       0.6    74.7  71.792
- Education10          1       0.8    74.8  71.862
- HighYouthUnemploy    1       0.8    74.9  71.884
- LabourForce          1       0.8    74.9  71.899
- StateSize10          1       1.2    75.3  72.124
- YouthUnemployment    1       1.2    75.3  72.137
- BelowWage10          1       1.3    75.4  72.230
- YouthUnemploy10      1       1.4    75.5  72.247
- StateSize            1       1.7    75.7  72.421
- LabourForce10        1       1.9    76.0  72.598
- Youth                1       2.6    76.7  73.006
- BelowWage            1       3.0    77.1  73.277
<none>                                74.1  73.384
- Wage                 1       3.2    77.3  73.396
- MoreMales10          1       5.0    79.1  74.470
- Southern             1       5.1    79.2  74.526
+ Wage10               1       0.1    74.0  75.327
- MatureUnemployment   1      10.6    84.7  77.675
- Males                1      11.8    85.9  78.348
- Males10              1      14.4    88.5  79.718
- MatureUnemploy10     1      16.2    90.3  80.696
- ExpenditureYear10    1      22.1    96.1  83.641
- ExpenditureYear0     1      32.1   106.2  88.302
- CrimeRate10          1   10720.0 10794.1 305.521

Step:  AIC=71.49
X...CrimeRate ~ Youth + Southern + Education + ExpenditureYear0 + 
    LabourForce + Males + MoreMales + StateSize + YouthUnemployment + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + Education10 + ExpenditureYear10 + LabourForce10 + 
    Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + MatureUnemploy10 + 
    HighYouthUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- MoreMales            1       0.2    74.5  69.639
- HighYouthUnemploy10  1       0.2    74.5  69.647
- HighYouthUnemploy    1       0.7    74.9  69.907
- Education            1       0.7    74.9  69.910
- Education10          1       0.8    75.0  69.996
- LabourForce          1       0.8    75.1  70.026
- StateSize10          1       1.0    75.3  70.133
- YouthUnemployment    1       1.4    75.6  70.370
- StateSize            1       1.5    75.7  70.423
- YouthUnemploy10      1       1.7    75.9  70.534
- BelowWage10          1       2.0    76.3  70.770
- LabourForce10        1       2.1    76.3  70.785
- Youth                1       2.7    76.9  71.159
<none>                                74.2  71.492
- Wage                 1       3.5    77.8  71.682
- BelowWage            1       3.8    78.1  71.839
- MoreMales10          1       5.0    79.2  72.542
- Southern             1       5.0    79.3  72.562
+ Youth10              1       0.2    74.1  73.384
+ Wage10               1       0.1    74.1  73.404
- MatureUnemployment   1      11.0    85.3  75.995
- Males                1      12.8    87.1  76.987
- Males10              1      16.1    90.4  78.740
- MatureUnemploy10     1      16.6    90.9  78.995
- ExpenditureYear10    1      22.2    96.5  81.806
- ExpenditureYear0     1      32.3   106.6  86.486
- CrimeRate10          1   10889.2 10963.4 304.252

Step:  AIC=69.64
X...CrimeRate ~ Youth + Southern + Education + ExpenditureYear0 + 
    LabourForce + Males + StateSize + YouthUnemployment + MatureUnemployment + 
    HighYouthUnemploy + Wage + BelowWage + CrimeRate10 + Education10 + 
    ExpenditureYear10 + LabourForce10 + Males10 + MoreMales10 + 
    StateSize10 + YouthUnemploy10 + MatureUnemploy10 + HighYouthUnemploy10 + 
    BelowWage10

                      Df Sum of Sq     RSS     AIC
- HighYouthUnemploy10  1       0.3    74.8  67.809
- LabourForce          1       0.8    75.3  68.143
- HighYouthUnemploy    1       0.9    75.3  68.180
- Education            1       0.9    75.4  68.219
- Education10          1       1.1    75.6  68.324
- YouthUnemployment    1       1.2    75.7  68.405
- StateSize10          1       1.4    75.8  68.486
- YouthUnemploy10      1       1.4    75.9  68.544
- StateSize            1       1.9    76.4  68.818
- BelowWage10          1       1.9    76.4  68.821
- LabourForce10        1       2.0    76.5  68.868
- Youth                1       2.5    77.0  69.175
<none>                                74.5  69.639
- Wage                 1       3.5    78.0  69.823
- BelowWage            1       3.6    78.1  69.872
- Southern             1       6.1    80.6  71.344
+ MoreMales            1       0.2    74.2  71.492
+ Youth10              1       0.2    74.3  71.544
+ Wage10               1       0.1    74.3  71.549
- MoreMales10          1       9.9    84.4  73.493
- MatureUnemployment   1      11.0    85.5  74.103
- Males10              1      16.5    91.0  77.049
- Males                1      16.6    91.1  77.085
- MatureUnemploy10     1      17.3    91.8  77.440
- ExpenditureYear10    1      22.1    96.6  79.853
- ExpenditureYear0     1      32.5   107.0  84.674
- CrimeRate10          1   10995.2 11069.7 302.705

Step:  AIC=67.81
X...CrimeRate ~ Youth + Southern + Education + ExpenditureYear0 + 
    LabourForce + Males + StateSize + YouthUnemployment + MatureUnemployment + 
    HighYouthUnemploy + Wage + BelowWage + CrimeRate10 + Education10 + 
    ExpenditureYear10 + LabourForce10 + Males10 + MoreMales10 + 
    StateSize10 + YouthUnemploy10 + MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- Education            1       0.9    75.7  66.398
- LabourForce          1       1.1    75.8  66.482
- Education10          1       1.2    75.9  66.528
- YouthUnemployment    1       1.3    76.0  66.600
- StateSize10          1       1.5    76.3  66.756
- YouthUnemploy10      1       1.6    76.3  66.801
- HighYouthUnemploy    1       1.8    76.6  66.933
- StateSize            1       2.1    76.8  67.093
- LabourForce10        1       2.3    77.1  67.252
- BelowWage10          1       2.6    77.4  67.415
- Youth                1       2.9    77.7  67.625
<none>                                74.8  67.809
- Wage                 1       3.7    78.4  68.078
- BelowWage            1       4.5    79.2  68.554
- Southern             1       6.0    80.8  69.453
+ HighYouthUnemploy10  1       0.3    74.5  69.639
+ MoreMales            1       0.3    74.5  69.647
+ Youth10              1       0.2    74.6  69.684
+ Wage10               1       0.0    74.7  69.804
- MoreMales10          1      10.4    85.2  71.945
- MatureUnemployment   1      11.3    86.1  72.444
- Males                1      16.3    91.1  75.095
- Males10              1      16.7    91.5  75.286
- MatureUnemploy10     1      17.0    91.8  75.460
- ExpenditureYear10    1      21.9    96.6  77.873
- ExpenditureYear0     1      32.4   107.1  82.713
- CrimeRate10          1   11054.0 11128.7 300.955

Step:  AIC=66.4
X...CrimeRate ~ Youth + Southern + ExpenditureYear0 + LabourForce + 
    Males + StateSize + YouthUnemployment + MatureUnemployment + 
    HighYouthUnemploy + Wage + BelowWage + CrimeRate10 + Education10 + 
    ExpenditureYear10 + LabourForce10 + Males10 + MoreMales10 + 
    StateSize10 + YouthUnemploy10 + MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- Education10          1       0.5    76.2  64.683
- YouthUnemployment    1       0.9    76.6  64.969
- LabourForce          1       1.2    76.9  65.121
- YouthUnemploy10      1       1.3    77.0  65.205
- StateSize10          1       1.5    77.2  65.313
- HighYouthUnemploy    1       1.5    77.2  65.339
- StateSize            1       2.0    77.7  65.639
- LabourForce10        1       2.5    78.2  65.910
- Youth                1       2.8    78.5  66.102
- BelowWage10          1       3.0    78.7  66.236
<none>                                75.7  66.398
- Wage                 1       4.3    79.9  66.968
- BelowWage            1       4.9    80.6  67.330
+ Education            1       0.9    74.8  67.809
+ MoreMales            1       0.5    75.2  68.067
+ HighYouthUnemploy10  1       0.3    75.4  68.219
- Southern             1       6.5    82.2  68.248
+ Youth10              1       0.2    75.5  68.267
+ Wage10               1       0.1    75.6  68.365
- MoreMales10          1      11.4    87.1  71.010
- MatureUnemployment   1      13.5    89.2  72.124
- Males                1      15.4    91.1  73.115
- Males10              1      15.9    91.6  73.376
- MatureUnemploy10     1      18.7    94.4  74.779
- ExpenditureYear10    1      21.2    96.9  76.008
- ExpenditureYear0     1      32.0   107.7  80.979
- CrimeRate10          1   11081.5 11157.2 299.076

Step:  AIC=64.68
X...CrimeRate ~ Youth + Southern + ExpenditureYear0 + LabourForce + 
    Males + StateSize + YouthUnemployment + MatureUnemployment + 
    HighYouthUnemploy + Wage + BelowWage + CrimeRate10 + ExpenditureYear10 + 
    LabourForce10 + Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + 
    MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- LabourForce          1       0.9    77.1  63.234
- YouthUnemployment    1       0.9    77.1  63.258
- YouthUnemploy10      1       1.2    77.3  63.395
- HighYouthUnemploy    1       1.5    77.7  63.597
- StateSize10          1       1.7    77.9  63.728
- LabourForce10        1       2.0    78.2  63.929
- StateSize            1       2.3    78.5  64.080
- Youth                1       2.4    78.5  64.122
- BelowWage10          1       2.6    78.7  64.249
<none>                                76.2  64.683
- Wage                 1       4.1    80.2  65.124
- BelowWage            1       4.4    80.6  65.351
+ MoreMales            1       0.6    75.6  66.328
+ Education10          1       0.5    75.7  66.398
+ HighYouthUnemploy10  1       0.4    75.7  66.416
+ Youth10              1       0.3    75.8  66.471
+ Education            1       0.3    75.9  66.528
+ Wage10               1       0.1    76.1  66.630
- Southern             1       7.9    84.1  67.343
- MoreMales10          1      12.2    88.4  69.665
- MatureUnemployment   1      13.1    89.3  70.160
- Males10              1      15.5    91.6  71.379
- Males                1      15.7    91.9  71.512
- MatureUnemploy10     1      18.4    94.5  72.850
- ExpenditureYear10    1      25.0   101.2  76.027
- ExpenditureYear0     1      36.8   113.0  81.213
- CrimeRate10          1   12440.1 12516.3 302.478

Step:  AIC=63.23
X...CrimeRate ~ Youth + Southern + ExpenditureYear0 + Males + 
    StateSize + YouthUnemployment + MatureUnemployment + HighYouthUnemploy + 
    Wage + BelowWage + CrimeRate10 + ExpenditureYear10 + LabourForce10 + 
    Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + MatureUnemploy10 + 
    BelowWage10

                      Df Sum of Sq     RSS     AIC
- YouthUnemployment    1       0.9    78.0  61.784
- YouthUnemploy10      1       1.0    78.1  61.870
- HighYouthUnemploy    1       1.7    78.8  62.276
- Youth                1       1.8    78.9  62.347
- StateSize10          1       1.9    78.9  62.375
- StateSize            1       2.5    79.6  62.737
- LabourForce10        1       2.6    79.7  62.799
- BelowWage10          1       3.0    80.1  63.031
<none>                                77.1  63.234
- BelowWage            1       4.5    81.6  63.910
- Wage                 1       5.6    82.7  64.541
+ LabourForce          1       0.9    76.2  64.683
+ HighYouthUnemploy10  1       0.7    76.4  64.822
+ MoreMales            1       0.5    76.5  64.924
+ Youth10              1       0.4    76.7  65.010
+ Wage10               1       0.2    76.8  65.096
+ Education10          1       0.2    76.9  65.121
+ Education            1       0.1    77.0  65.194
- Southern             1       8.9    86.0  66.385
- MatureUnemployment   1      12.5    89.5  68.274
- MoreMales10          1      12.9    89.9  68.487
- Males                1      14.9    91.9  69.528
- Males10              1      14.9    91.9  69.540
- MatureUnemploy10     1      18.1    95.1  71.147
- ExpenditureYear10    1      24.1   101.2  74.029
- ExpenditureYear0     1      35.9   113.0  79.219
- CrimeRate10          1   12524.2 12601.3 300.796

Step:  AIC=61.78
X...CrimeRate ~ Youth + Southern + ExpenditureYear0 + Males + 
    StateSize + MatureUnemployment + HighYouthUnemploy + Wage + 
    BelowWage + CrimeRate10 + ExpenditureYear10 + LabourForce10 + 
    Males10 + MoreMales10 + StateSize10 + YouthUnemploy10 + MatureUnemploy10 + 
    BelowWage10

                      Df Sum of Sq     RSS     AIC
- YouthUnemploy10      1       0.2    78.1  59.879
- Youth                1       1.1    79.1  60.469
- HighYouthUnemploy    1       1.8    79.7  60.834
- StateSize10          1       1.8    79.8  60.872
- StateSize            1       2.4    80.3  61.195
- BelowWage10          1       2.6    80.6  61.354
- LabourForce10        1       3.1    81.0  61.592
<none>                                78.0  61.784
- BelowWage            1       3.9    81.9  62.082
- Wage                 1       5.4    83.4  62.939
+ YouthUnemployment    1       0.9    77.1  63.234
+ LabourForce          1       0.9    77.1  63.258
+ HighYouthUnemploy10  1       0.7    77.2  63.346
+ Youth10              1       0.6    77.4  63.423
+ Wage10               1       0.3    77.6  63.593
+ MoreMales            1       0.2    77.8  63.661
+ Education10          1       0.2    77.8  63.666
+ Education            1       0.1    77.9  63.732
- Southern             1       8.5    86.4  64.626
- Males                1      14.7    92.7  67.927
- MoreMales10          1      14.8    92.7  67.933
- Males10              1      15.4    93.3  68.235
- MatureUnemployment   1      18.2    96.2  69.650
- MatureUnemploy10     1      22.5   100.5  71.716
- ExpenditureYear10    1      23.3   101.3  72.093
- ExpenditureYear0     1      35.5   113.5  77.425
- CrimeRate10          1   12530.1 12608.1 298.821

Step:  AIC=59.88
X...CrimeRate ~ Youth + Southern + ExpenditureYear0 + Males + 
    StateSize + MatureUnemployment + HighYouthUnemploy + Wage + 
    BelowWage + CrimeRate10 + ExpenditureYear10 + LabourForce10 + 
    Males10 + MoreMales10 + StateSize10 + MatureUnemploy10 + 
    BelowWage10

                      Df Sum of Sq     RSS     AIC
- Youth                1       1.0    79.1  58.490
- StateSize10          1       2.1    80.2  59.117
- BelowWage10          1       2.5    80.6  59.376
- StateSize            1       2.7    80.8  59.448
- LabourForce10        1       3.0    81.1  59.628
<none>                                78.1  59.879
- HighYouthUnemploy    1       3.7    81.8  60.055
- BelowWage            1       3.7    81.9  60.082
- Wage                 1       5.5    83.7  61.102
+ HighYouthUnemploy10  1       0.8    77.3  61.395
+ LabourForce          1       0.7    77.4  61.435
+ Youth10              1       0.7    77.4  61.469
+ Wage10               1       0.3    77.9  61.728
+ YouthUnemploy10      1       0.2    78.0  61.784
+ MoreMales            1       0.1    78.0  61.807
+ Education10          1       0.1    78.0  61.835
+ Education            1       0.0    78.1  61.870
+ YouthUnemployment    1       0.0    78.1  61.870
- Southern             1       9.3    87.4  63.183
- MoreMales10          1      14.7    92.8  65.965
- Males10              1      15.2    93.3  66.235
- Males                1      15.6    93.7  66.449
- MatureUnemployment   1      18.7    96.8  67.969
- ExpenditureYear10    1      23.2   101.3  70.095
- MatureUnemploy10     1      23.7   101.8  70.340
- ExpenditureYear0     1      35.6   113.7  75.536
- CrimeRate10          1   12570.5 12648.6 296.972

Step:  AIC=58.49
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + ExpenditureYear10 + LabourForce10 + Males10 + 
    MoreMales10 + StateSize10 + MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- StateSize10          1       2.6    81.7  58.004
- BelowWage10          1       2.7    81.9  58.083
- LabourForce10        1       3.1    82.2  58.301
- StateSize            1       3.2    82.4  58.368
<none>                                79.1  58.490
- Wage                 1       4.5    83.7  59.109
- BelowWage            1       4.6    83.8  59.171
- HighYouthUnemploy    1       5.1    84.3  59.435
+ Youth                1       1.0    78.1  59.879
+ HighYouthUnemploy10  1       1.0    78.2  59.920
+ LabourForce          1       0.4    78.8  60.258
+ Wage10               1       0.1    79.1  60.441
+ MoreMales            1       0.1    79.1  60.446
+ YouthUnemploy10      1       0.0    79.1  60.469
+ Education10          1       0.0    79.1  60.487
+ Education            1       0.0    79.1  60.487
+ YouthUnemployment    1       0.0    79.1  60.488
+ Youth10              1       0.0    79.1  60.489
- Southern             1      11.6    90.7  62.900
- MoreMales10          1      14.0    93.2  64.164
- Males10              1      14.2    93.4  64.259
- Males                1      15.2    94.3  64.746
- MatureUnemployment   1      20.1    99.3  67.150
- ExpenditureYear10    1      22.7   101.9  68.359
- MatureUnemploy10     1      27.6   106.7  70.537
- ExpenditureYear0     1      35.5   114.7  73.923
- CrimeRate10          1   13906.3 13985.5 299.694

Step:  AIC=58
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + ExpenditureYear10 + LabourForce10 + Males10 + 
    MoreMales10 + MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- LabourForce10        1       2.5    84.2  57.393
- BelowWage10          1       3.5    85.2  57.979
<none>                                81.7  58.004
- HighYouthUnemploy    1       3.9    85.6  58.193
+ StateSize10          1       2.6    79.1  58.490
- BelowWage            1       4.9    86.6  58.725
+ HighYouthUnemploy10  1       1.6    80.1  59.085
+ Youth                1       1.5    80.2  59.117
+ LabourForce          1       0.4    81.3  59.770
+ MoreMales            1       0.3    81.4  59.813
+ Youth10              1       0.2    81.5  59.873
+ YouthUnemploy10      1       0.2    81.6  59.903
+ YouthUnemployment    1       0.1    81.6  59.947
- Wage                 1       7.2    89.0  59.996
+ Education            1       0.0    81.7  60.001
+ Education10          1       0.0    81.7  60.001
+ Wage10               1       0.0    81.7  60.002
- Males10              1      12.7    94.4  62.779
- Males                1      12.9    94.6  62.875
- Southern             1      13.2    94.9  63.017
- MoreMales10          1      13.5    95.2  63.181
- MatureUnemployment   1      17.6    99.3  65.155
- StateSize            1      20.9   102.6  66.702
- ExpenditureYear10    1      21.7   103.4  67.056
- MatureUnemploy10     1      25.6   107.3  68.815
- ExpenditureYear0     1      35.3   117.0  72.867
- CrimeRate10          1   14223.5 14305.2 298.757

Step:  AIC=57.39
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + ExpenditureYear10 + Males10 + MoreMales10 + 
    MatureUnemploy10 + BelowWage10

                      Df Sum of Sq     RSS     AIC
- BelowWage10          1       3.4    87.6  57.252
- HighYouthUnemploy    1       3.6    87.8  57.379
<none>                                84.2  57.393
+ LabourForce10        1       2.5    81.7  58.004
- BelowWage            1       5.4    89.5  58.293
+ StateSize10          1       1.9    82.2  58.301
+ LabourForce          1       1.6    82.6  58.474
+ Youth                1       1.6    82.6  58.485
+ HighYouthUnemploy10  1       0.8    83.4  58.934
- Wage                 1       7.2    91.4  59.250
+ MoreMales            1       0.2    84.0  59.275
+ Wage10               1       0.2    84.0  59.305
+ Youth10              1       0.1    84.1  59.322
+ Education            1       0.1    84.1  59.328
+ YouthUnemployment    1       0.1    84.1  59.332
+ Education10          1       0.1    84.1  59.364
+ YouthUnemploy10      1       0.0    84.1  59.370
- Males                1      10.5    94.7  60.935
- Males10              1      12.3    96.5  61.796
- MoreMales10          1      14.8    99.0  62.990
- StateSize            1      19.4   103.6  65.134
- Southern             1      23.6   107.7  66.987
- ExpenditureYear10    1      25.5   109.7  67.835
- MatureUnemployment   1      28.6   112.7  69.119
- MatureUnemploy10     1      33.4   117.6  71.092
- ExpenditureYear0     1      40.0   124.2  73.656
- CrimeRate10          1   14667.9 14752.1 298.203

Step:  AIC=57.25
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + HighYouthUnemploy + Wage + BelowWage + 
    CrimeRate10 + ExpenditureYear10 + Males10 + MoreMales10 + 
    MatureUnemploy10

                      Df Sum of Sq     RSS     AIC
- BelowWage            1       2.0    89.5  56.293
- HighYouthUnemploy    1       2.9    90.4  56.759
<none>                                87.6  57.252
+ BelowWage10          1       3.4    84.2  57.393
+ StateSize10          1       2.6    85.0  57.828
+ LabourForce10        1       2.3    85.2  57.979
+ Youth                1       2.0    85.6  58.179
+ HighYouthUnemploy10  1       1.9    85.7  58.230
+ LabourForce          1       1.4    86.2  58.520
+ Education            1       1.2    86.4  58.596
+ Education10          1       1.0    86.6  58.731
- Wage                 1       7.0    94.6  58.865
+ Wage10               1       0.7    86.9  58.868
+ YouthUnemployment    1       0.2    87.4  59.150
+ YouthUnemploy10      1       0.1    87.4  59.173
+ MoreMales            1       0.1    87.4  59.181
+ Youth10              1       0.0    87.6  59.251
- Males                1      12.0    99.6  61.300
- Males10              1      14.3   101.9  62.372
- MoreMales10          1      16.8   104.4  63.489
- StateSize            1      23.4   110.9  66.362
- MatureUnemployment   1      28.1   115.6  68.315
- ExpenditureYear10    1      28.6   116.2  68.550
- Southern             1      29.1   116.7  68.735
- MatureUnemploy10     1      33.5   121.1  70.491
- ExpenditureYear0     1      43.5   131.0  74.188
- CrimeRate10          1   15110.9 15198.5 297.604

Step:  AIC=56.29
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + HighYouthUnemploy + Wage + CrimeRate10 + 
    ExpenditureYear10 + Males10 + MoreMales10 + MatureUnemploy10

                      Df Sum of Sq     RSS     AIC
- HighYouthUnemploy    1       3.0    92.5  55.825
<none>                                89.5  56.293
+ LabourForce10        1       2.9    86.6  56.749
+ Youth                1       2.8    86.8  56.816
+ StateSize10          1       2.0    87.5  57.223
+ BelowWage            1       2.0    87.6  57.252
+ LabourForce          1       1.9    87.6  57.276
+ HighYouthUnemploy10  1       1.8    87.7  57.335
+ Wage10               1       1.1    88.5  57.729
+ YouthUnemploy10      1       0.6    89.0  57.993
+ YouthUnemployment    1       0.5    89.0  58.018
+ Education            1       0.5    89.0  58.034
+ Education10          1       0.3    89.2  58.111
+ MoreMales            1       0.2    89.4  58.205
+ Youth10              1       0.0    89.5  58.271
+ BelowWage10          1       0.0    89.5  58.293
- Males                1      14.1   103.6  61.156
- MoreMales10          1      16.1   105.6  62.067
- Males10              1      18.2   107.8  62.997
- StateSize            1      21.5   111.1  64.420
- Wage                 1      25.3   114.9  65.998
- Southern             1      28.9   118.4  67.440
- MatureUnemployment   1      29.8   119.4  67.811
- ExpenditureYear10    1      33.3   122.8  69.155
- MatureUnemploy10     1      35.7   125.2  70.059
- ExpenditureYear0     1      47.5   137.1  74.308
- CrimeRate10          1   17139.1 17228.7 301.497

Step:  AIC=55.82
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + Wage + CrimeRate10 + ExpenditureYear10 + 
    Males10 + MoreMales10 + MatureUnemploy10

                      Df Sum of Sq     RSS     AIC
+ HighYouthUnemploy10  1       4.4    88.1  55.542
+ Youth                1       4.0    88.5  55.729
<none>                                92.5  55.825
+ HighYouthUnemploy    1       3.0    89.5  56.293
+ LabourForce10        1       2.7    89.8  56.450
+ BelowWage            1       2.1    90.4  56.759
+ LabourForce          1       1.9    90.6  56.864
+ Wage10               1       1.7    90.8  56.970
+ Education            1       1.2    91.3  57.216
+ StateSize10          1       1.0    91.5  57.296
+ Education10          1       1.0    91.5  57.315
+ Youth10              1       0.5    92.0  57.588
+ MoreMales            1       0.2    92.3  57.712
+ YouthUnemployment    1       0.1    92.4  57.782
+ YouthUnemploy10      1       0.1    92.4  57.793
+ BelowWage10          1       0.0    92.5  57.812
- Males                1      12.7   105.2  59.880
- MoreMales10          1      14.8   107.3  60.815
- Males10              1      18.5   111.0  62.409
- StateSize            1      21.6   114.1  63.698
- Wage                 1      23.8   116.3  64.577
- MatureUnemployment   1      28.6   121.1  66.487
- MatureUnemploy10     1      33.0   125.5  68.156
- ExpenditureYear10    1      35.0   127.5  68.895
- Southern             1      37.0   129.5  69.621
- ExpenditureYear0     1      48.1   140.6  73.494
- CrimeRate10          1   17471.6 17564.1 300.403

Step:  AIC=55.54
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + Wage + CrimeRate10 + ExpenditureYear10 + 
    Males10 + MoreMales10 + MatureUnemploy10 + HighYouthUnemploy10

                      Df Sum of Sq     RSS     AIC
+ LabourForce10        1       4.3    83.8  55.199
<none>                                88.1  55.542
+ LabourForce          1       3.4    84.7  55.700
- HighYouthUnemploy10  1       4.4    92.5  55.825
+ Wage10               1       2.7    85.4  56.080
+ Youth                1       2.5    85.6  56.176
+ BelowWage            1       2.1    86.0  56.413
+ StateSize10          1       0.8    87.3  57.117
+ Education            1       0.5    87.6  57.249
+ YouthUnemploy10      1       0.5    87.7  57.292
+ YouthUnemployment    1       0.5    87.7  57.294
+ Education10          1       0.4    87.7  57.314
+ HighYouthUnemploy    1       0.4    87.7  57.335
+ Youth10              1       0.2    87.9  57.439
+ MoreMales            1       0.1    88.0  57.468
+ BelowWage10          1       0.1    88.0  57.477
- Males                1      15.2   103.3  61.034
- MoreMales10          1      15.4   103.6  61.128
- Males10              1      18.9   107.0  62.659
- Wage                 1      22.1   110.3  64.077
- StateSize            1      24.6   112.7  65.110
- Southern             1      28.9   117.0  66.876
- MatureUnemployment   1      31.8   119.9  68.011
- MatureUnemploy10     1      37.2   125.3  70.097
- ExpenditureYear10    1      37.2   125.3  70.101
- ExpenditureYear0     1      50.9   139.0  74.974
- CrimeRate10          1   16922.4 17010.5 300.898

Step:  AIC=55.2
X...CrimeRate ~ Southern + ExpenditureYear0 + Males + StateSize + 
    MatureUnemployment + Wage + CrimeRate10 + ExpenditureYear10 + 
    Males10 + MoreMales10 + MatureUnemploy10 + HighYouthUnemploy10 + 
    LabourForce10

                      Df Sum of Sq     RSS     AIC
<none>                                83.8  55.199
- LabourForce10        1       4.3    88.1  55.542
+ Youth                1       2.0    81.8  56.045
+ Wage10               1       1.6    82.2  56.268
+ BelowWage            1       1.4    82.4  56.410
+ StateSize10          1       1.3    82.5  56.436
- HighYouthUnemploy10  1       6.0    89.8  56.450
+ Youth10              1       0.3    83.6  57.052
+ MoreMales            1       0.3    83.6  57.058
+ Education            1       0.2    83.6  57.074
+ HighYouthUnemploy    1       0.2    83.6  57.091
+ Education10          1       0.1    83.7  57.127
+ LabourForce          1       0.1    83.7  57.132
+ BelowWage10          1       0.0    83.8  57.186
+ YouthUnemploy10      1       0.0    83.8  57.198
+ YouthUnemployment    1       0.0    83.8  57.199
- Southern             1      13.6    97.5  60.272
- MoreMales10          1      14.0    97.8  60.441
- MatureUnemployment   1      18.6   102.4  62.596
- Males10              1      19.1   102.9  62.825
- Wage                 1      19.1   102.9  62.834
- Males                1      19.2   103.1  62.909
- StateSize            1      28.1   111.9  66.786
- MatureUnemploy10     1      28.5   112.3  66.942
- ExpenditureYear10    1      30.9   114.7  67.934
- ExpenditureYear0     1      44.3   128.1  73.124
- CrimeRate10          1   16189.4 16273.2 300.815

Call:
lm(formula = X...CrimeRate ~ Southern + ExpenditureYear0 + Males + 
    StateSize + MatureUnemployment + Wage + CrimeRate10 + ExpenditureYear10 + 
    Males10 + MoreMales10 + MatureUnemploy10 + HighYouthUnemploy10 + 
    LabourForce10, data = data)

Coefficients:
        (Intercept)             Southern     ExpenditureYear0  
           26.29289             -2.08933              0.33513  
              Males            StateSize   MatureUnemployment  
           -0.05595             -0.03069             -0.40740  
               Wage          CrimeRate10    ExpenditureYear10  
           -0.01491              0.73158             -0.29560  
            Males10          MoreMales10     MatureUnemploy10  
            0.05234             -2.49654              0.47887  
HighYouthUnemploy10        LabourForce10  
            0.98291              0.01432  

#+end_example

Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC <- lm(formula = X...CrimeRate ~ Southern + ExpenditureYear0 + Males + 
    StateSize + MatureUnemployment + Wage + CrimeRate10 + ExpenditureYear10 + 
    Males10 + MoreMales10 + MatureUnemploy10 + HighYouthUnemploy10 + 
    LabourForce10, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 856ca4b0-8637-415b-8b66-076a122afb09
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC$residuals)
#+end_src

#+RESULTS: 856ca4b0-8637-415b-8b66-076a122afb09
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC$residuals
: W = 0.97853, p-value = 0.533

p-value = 0.533 <=> p-value maior que 0.05 => não rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo é distribuido normalmente.

** [[https://archive.ics.uci.edu/ml/datasets/Student+Performance#][Performance de Estudantes (não normal)]]  
+ *Modelar nota final (=G3=) a partir das variáveis*.
*** Dados sobre o =Conjunto=
+ Dados:
  - school - Escola em que estuda (binary: 'GP' - Gabriel Pereira ou 'MS' - Mousinho da Silveira)
  - sex - Sexo (binary: 'F' - mulher ou 'M' - homem)
  - age - Idade (numeric: from 15 to 22)
  - address - Estadia/tipo da região (binary: 'U' - urbana or 'R' - rural)
  - famsize - Tamanho familhar (binary: 'LE3' - menos que  3 or 'GT3' - mais que 3)
  - Pstatus - Estado de co-habitação dos pais (binary: 'T' - junto or 'A' - aparte)
  - Medu - Educação da mãe (numeric: 0 - nenhuma, 1 - primária (4th ano), 2 - 5th ao 9th ano, 3 - secundária, ou 4 - superior)
  - Fedu - Educação do pai (numeric: 0 - nenhuma, 1 - primária (4th ano), 2 - 5th ao 9th ano, 3 - secundária, ou 4 - superior)
  - Mjob - Tabalho da mãe (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
  - Fjob - Trabalho do pai (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
  - reason - Razão de escolha da escola (nominal: close to 'home', school 'reputation', 'course' preference or 'other')
  - guardian - Guardião legal (nominal: 'mother', 'father' or 'other')
  - traveltime - Tempo de viagem, escola à casa (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - 30 min. to 1 hour, or 4 - >1 hour)
  - studytime - Tempo de estudo semanal (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours)
  - failures - Número de reprovações (numeric: n if 1<=n<3, else 4)
  - schoolsup - Suporte educacional extra (binary: yes or no)
  - famsup - Suporte educacional familiar (binary: yes or no)
  - paid - Classes extras pagas (Math or Portuguese) (binary: yes or no)
  - activities - Atividades extra-curriculares (binary: yes or no)
  - nursery - Atendeu a clases de enfermaria (binary: yes or no)
  - higher - Quer seguir educação superior (binary: yes or no)
  - internet - Acesso a internet (binary: yes or no)
  - romantic - Em relação romántica (binary: yes or no)
  - famrel - Qualidade de relação familiar (numeric: from 1 - very bad to 5 - excellent)
  - freetime - Tempo livre fora da escola (numeric: from 1 - very low to 5 - very high)
  - goout - Tempo gasto saindo com amigos (numeric: from 1 - very low to 5 - very high)
  - Dalc - Consumo diário de álcool (numeric: from 1 - very low to 5 - very high)
  - Walc - Consumo em finais de semana de alcool (numeric: from 1 - very low to 5 - very high)
  - health - Estado de saúde atual (numeric: from 1 - very bad to 5 - very good)
  - absences - Número de faltas (numeric: from 0 to 93)
  - G1 - Notas primeiro período (numeric: from 0 to 20) [relacionadas com português ou matemática]
  - G2 - Nota segundo período (numeric: from 0 to 20) [relacionadas com português ou matemática]
# these grades are related with the course subject, Math or Portuguese:
- G3 - Nota final (numeric: from 0 to 20, output target) [relacionadas com português ou matemática]
*** Invocação de conjuto, por arquivo local

Dado que você copiou os conjunto(s) de dado(s) para um diretório
local, pode-se chamar o conjunto de métricas e notas de [[https://drive.google.com/file/d/1vrIpfxXLxqo4ngPDOBjyrJFhB-Ei5N4C/view?usp=sharing][Português]] e [[https://drive.google.com/file/d/1FO2LEQhKbCX8cq6yBxqKzjrbnR18OxSD/view?usp=sharing][Matemática]] da seguinte maneira,

#+NAME: e22f0e27-8583-4468-8137-7f33cf3cf41b
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  data_mat=read.table("./data/csv/student-mat.csv",sep=";",header=TRUE)
  data_por=read.table("./data/csv/student-por.csv",sep=";",header=TRUE)

  data=merge(data_mat,data_por,by=c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet"))
  print(nrow(data)) # 382 dados

  head(data,5)
#+end_src

#+RESULTS: e22f0e27-8583-4468-8137-7f33cf3cf41b
#+begin_example
[1] 382
  school sex age address famsize Pstatus Medu Fedu Mjob     Fjob     ...
1 GP     F   15  R       GT3     T       1    1    at_home  other    ...
2 GP     F   15  R       GT3     T       1    1    other    other    ...
3 GP     F   15  R       GT3     T       2    2    at_home  other    ...
4 GP     F   15  R       GT3     T       2    4    services health   ...
5 GP     F   15  R       GT3     T       3    3    services services ...
  famrel.y freetime.y goout.y Dalc.y Walc.y health.y absences.y G1.y G2.y G3.y
1 3        1          2       1      1      1        4          13   13   13  
2 3        3          4       2      4      5        2          13   11   11  
3 4        3          1       1      1      2        8          14   13   12  
4 4        3          2       1      1      5        2          10   11   10  
5 4        2          1       2      3      3        2          13   13   13  
#+end_example


#+NAME: f040bcbb-a212-4d32-896a-e17d70bff168
#+begin_src ein-r :session localhost :results output
  summary(data)
#+end_src

#+RESULTS: f040bcbb-a212-4d32-896a-e17d70bff168
#+begin_example
    school              sex                 age          address         
 Length:382         Length:382         Min.   :15.00   Length:382        
 Class :character   Class :character   1st Qu.:16.00   Class :character  
 Mode  :character   Mode  :character   Median :17.00   Mode  :character  
                                       Mean   :16.59                     
                                       3rd Qu.:17.00                     
                                       Max.   :22.00                     
   famsize            Pstatus               Medu            Fedu      
 Length:382         Length:382         Min.   :0.000   Min.   :0.000  
 Class :character   Class :character   1st Qu.:2.000   1st Qu.:2.000  
 Mode  :character   Mode  :character   Median :3.000   Median :3.000  
                                       Mean   :2.806   Mean   :2.565  
                                       3rd Qu.:4.000   3rd Qu.:4.000  
                                       Max.   :4.000   Max.   :4.000  
     Mjob               Fjob              reason            nursery         
 Length:382         Length:382         Length:382         Length:382        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
   internet          guardian.x         traveltime.x    studytime.x   
 Length:382         Length:382         Min.   :1.000   Min.   :1.000  
 Class :character   Class :character   1st Qu.:1.000   1st Qu.:1.000  
 Mode  :character   Mode  :character   Median :1.000   Median :2.000  
                                       Mean   :1.442   Mean   :2.034  
                                       3rd Qu.:2.000   3rd Qu.:2.000  
                                       Max.   :4.000   Max.   :4.000  
   failures.x     schoolsup.x          famsup.x            paid.x         
 Min.   :0.0000   Length:382         Length:382         Length:382        
 1st Qu.:0.0000   Class :character   Class :character   Class :character  
 Median :0.0000   Mode  :character   Mode  :character   Mode  :character  
 Mean   :0.2906                                                           
 3rd Qu.:0.0000                                                           
 Max.   :3.0000                                                           
 activities.x         higher.x          romantic.x           famrel.x   
 Length:382         Length:382         Length:382         Min.   :1.00  
 Class :character   Class :character   Class :character   1st Qu.:4.00  
 Mode  :character   Mode  :character   Mode  :character   Median :4.00  
                                                          Mean   :3.94  
                                                          3rd Qu.:5.00  
                                                          Max.   :5.00  
   freetime.x       goout.x          Dalc.x          Walc.x        health.x    
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.00   1st Qu.:3.000  
 Median :3.000   Median :3.000   Median :1.000   Median :2.00   Median :4.000  
 Mean   :3.223   Mean   :3.113   Mean   :1.474   Mean   :2.28   Mean   :3.579  
 3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:3.00   3rd Qu.:5.000  
 Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.00   Max.   :5.000  
   absences.x          G1.x            G2.x            G3.x      
 Min.   : 0.000   Min.   : 3.00   Min.   : 0.00   Min.   : 0.00  
 1st Qu.: 0.000   1st Qu.: 8.00   1st Qu.: 8.25   1st Qu.: 8.00  
 Median : 3.000   Median :10.50   Median :11.00   Median :11.00  
 Mean   : 5.319   Mean   :10.86   Mean   :10.71   Mean   :10.39  
 3rd Qu.: 8.000   3rd Qu.:13.00   3rd Qu.:13.00   3rd Qu.:14.00  
 Max.   :75.000   Max.   :19.00   Max.   :19.00   Max.   :20.00  
  guardian.y         traveltime.y    studytime.y      failures.y    
 Length:382         Min.   :1.000   Min.   :1.000   Min.   :0.0000  
 Class :character   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:0.0000  
 Mode  :character   Median :1.000   Median :2.000   Median :0.0000  
                    Mean   :1.445   Mean   :2.039   Mean   :0.1414  
                    3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:0.0000  
                    Max.   :4.000   Max.   :4.000   Max.   :3.0000  
 schoolsup.y          famsup.y            paid.y          activities.y      
 Length:382         Length:382         Length:382         Length:382        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
   higher.y          romantic.y           famrel.y       freetime.y  
 Length:382         Length:382         Min.   :1.000   Min.   :1.00  
 Class :character   Class :character   1st Qu.:4.000   1st Qu.:3.00  
 Mode  :character   Mode  :character   Median :4.000   Median :3.00  
                                       Mean   :3.942   Mean   :3.23  
                                       3rd Qu.:5.000   3rd Qu.:4.00  
                                       Max.   :5.000   Max.   :5.00  
    goout.y          Dalc.y          Walc.y         health.y    
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:3.000  
 Median :3.000   Median :1.000   Median :2.000   Median :4.000  
 Mean   :3.118   Mean   :1.476   Mean   :2.291   Mean   :3.576  
 3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:5.000  
 Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000  
   absences.y          G1.y            G2.y            G3.y      
 Min.   : 0.000   Min.   : 0.00   Min.   : 5.00   Min.   : 0.00  
 1st Qu.: 0.000   1st Qu.:10.00   1st Qu.:11.00   1st Qu.:11.00  
 Median : 2.000   Median :12.00   Median :12.00   Median :13.00  
 Mean   : 3.673   Mean   :12.11   Mean   :12.24   Mean   :12.52  
 3rd Qu.: 6.000   3rd Qu.:14.00   3rd Qu.:14.00   3rd Qu.:14.00  
 Max.   :32.000   Max.   :19.00   Max.   :19.00   Max.   :19.00  
#+end_example

# *** Regressão e Teste de Shapiro (fortemente não normal)
**** Transformar as variáveis categóricas em numéricas
As variáveis categóricas são: school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, nursery, internet, guardian.x, schoolsup.x, famsup.x, paid.x, activities.x, higher.x, romantic.x, guardian.y, schoolsup.y, famsup.y, paid.y, activities.y, higher.y, romantic.y.

***** Funções Variádicas (com número indefinido de variáveis) 
#+NAME: 05298705-f04e-47df-b7f0-ca8bd2d0ef4c
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  categoricalToNumeric <- function(data,...) {
    cols <- c(...)
    data[cols] <- lapply(data[cols], function(x) as.numeric(as.factor(x)))
    summary(data)
  }

  categoricalToNumeric(data, 'school', 'sex', 'address', 'famsize', 'Pstatus', 'Mjob', 'Fjob', 'reason', 'nursery', 'internet', 'guardian.x', 'schoolsup.x', 'famsup.x', 'paid.x', 'activities.x', 'higher.x', 'romantic.x', 'guardian.y', 'schoolsup.y', 'famsup.y', 'paid.y', 'activities.y', 'higher.y', 'romantic.y')
#+end_src

#+NAME: 3517003e-1fe5-4377-a05b-1af55900ef6b
#+begin_src ein-r :session localhost :results output
  categoricalToNumeric2 <- function(data,...) {
    for(i in colnames(data)) {
      data[i] <- as.numeric(as.factor(data$i))
    }
    summary(data)
  }
  categoricalToNumeric2(data)
#+end_src

#+RESULTS: 3517003e-1fe5-4377-a05b-1af55900ef6b
#+begin_example
     price          speed            hd            ram           screen    
 Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA   
 1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA   
 Median : NA    Median : NA    Median : NA    Median : NA    Median : NA   
 Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN   
 3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA   
 Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA   
 NA's   :6259   NA's   :6259   NA's   :6259   NA's   :6259   NA's   :6259  
       cd           multi         premium          ads           trend     
 Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA   
 1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA   
 Median : NA    Median : NA    Median : NA    Median : NA    Median : NA   
 Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN   
 3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA   
 Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA   
 NA's   :6259   NA's   :6259   NA's   :6259   NA's   :6259   NA's   :6259  
#+end_example

*** Regressão e Teste de Shapiro (fortemente não normal)
**** Regressão linear
Agora que todas variáveis se tornaram numéricas, vamos aplicar a regressão linear múltipla,

#+NAME: 512656b3-4674-4fb2-80ee-6c5c38fcf623
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein_x <- lm(G3.x ~ . , data)
  summary(modreg_trein_x)
#+end_src

#+RESULTS: 512656b3-4674-4fb2-80ee-6c5c38fcf623
#+begin_example

Call:
lm(formula = G3.x ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.7088 -0.6008  0.1906  1.0677  3.1748 

Coefficients: (7 not defined because of singularities)
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -0.83478    2.25861  -0.370 0.711921    
schoolMS          0.48091    0.40343   1.192 0.234110    
sexM              0.32344    0.25226   1.282 0.200693    
age              -0.26945    0.11044  -2.440 0.015232 *  
addressU         -0.19584    0.28893  -0.678 0.498382    
famsizeLE3        0.08357    0.23755   0.352 0.725206    
PstatusT         -0.04904    0.35653  -0.138 0.890686    
Medu              0.08034    0.15831   0.507 0.612151    
Fedu             -0.11332    0.13594  -0.834 0.405082    
Mjobhealth       -0.30835    0.54812  -0.563 0.574126    
Mjobother         0.11018    0.35537   0.310 0.756724    
Mjobservices      0.10697    0.39524   0.271 0.786844    
Mjobteacher      -0.14028    0.50297  -0.279 0.780493    
Fjobhealth        0.44124    0.73020   0.604 0.546082    
Fjobother         0.05393    0.54103   0.100 0.920661    
Fjobservices     -0.26772    0.55743  -0.480 0.631351    
Fjobteacher      -0.07038    0.64113  -0.110 0.912657    
reasonhome       -0.14785    0.26623  -0.555 0.579033    
reasonother       0.41499    0.39889   1.040 0.298954    
reasonreputation  0.25264    0.27975   0.903 0.367153    
nurseryyes       -0.25381    0.26792  -0.947 0.344182    
internetyes      -0.08858    0.31520  -0.281 0.778870    
guardian.xmother -1.17129    5.32847  -0.220 0.826151    
guardian.xother   0.04294    0.55972   0.077 0.938891    
traveltime.x      3.13925    1.42772   2.199 0.028596 *  
studytime.x       1.97125    6.20106   0.318 0.750772    
failures.x       -0.10818    0.18707  -0.578 0.563469    
schoolsup.xyes    3.94561    5.87479   0.672 0.502303    
famsup.xyes      -4.11131   11.91675  -0.345 0.730315    
paid.xyes         0.02050    0.23303   0.088 0.929964    
activities.xyes  -2.75242    8.18298  -0.336 0.736817    
higher.xyes       1.53770    3.80201   0.404 0.686152    
romantic.xyes    -1.13930    1.42358  -0.800 0.424115    
famrel.x          0.34881    0.11798   2.957 0.003338 ** 
freetime.x        0.06348    0.11486   0.553 0.580876    
goout.x           0.08887    0.10888   0.816 0.414977    
Dalc.x           -0.10430    0.16179  -0.645 0.519612    
Walc.x            0.14053    0.12054   1.166 0.244532    
health.x          0.09589    0.07776   1.233 0.218398    
absences.x        0.06507    0.01669   3.898 0.000118 ***
G1.x              0.15545    0.06830   2.276 0.023498 *  
G2.x              0.91852    0.05712  16.082  < 2e-16 ***
guardian.ymother  1.41720    5.32636   0.266 0.790352    
guardian.yother        NA         NA      NA       NA    
traveltime.y     -3.12203    1.42160  -2.196 0.028785 *  
studytime.y      -2.13612    6.20299  -0.344 0.730790    
failures.y        0.30120    0.26716   1.127 0.260395    
schoolsup.yyes   -3.41026    5.87392  -0.581 0.561928    
famsup.yyes       4.27988   11.91495   0.359 0.719676    
paid.yyes         0.02466    0.43597   0.057 0.954920    
activities.yyes   2.28851    8.16892   0.280 0.779541    
higher.yyes      -1.33989    3.79014  -0.354 0.723927    
romantic.yyes     0.91507    1.42357   0.643 0.520807    
famrel.y               NA         NA      NA       NA    
freetime.y             NA         NA      NA       NA    
goout.y                NA         NA      NA       NA    
Dalc.y                 NA         NA      NA       NA    
Walc.y                 NA         NA      NA       NA    
health.y               NA         NA      NA       NA    
absences.y       -0.05683    0.02599  -2.187 0.029471 *  
G1.y             -0.01954    0.09293  -0.210 0.833574    
G2.y              0.10256    0.12161   0.843 0.399665    
G3.y              0.07778    0.08308   0.936 0.349847    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.906 on 326 degrees of freedom
Multiple R-squared:  0.8585,	Adjusted R-squared:  0.8346 
F-statistic: 35.95 on 55 and 326 DF,  p-value: < 2.2e-16

#+end_example

#+NAME: 04237eff-9713-4d6a-965a-3d20187b9755
#+begin_src ein-r :session localhost :results output :exports both :eval no
  modreg_trein_y <- lm(G3.y ~ . , data)
  summary(modreg_trein_y)
#+end_src

#+RESULTS: 04237eff-9713-4d6a-965a-3d20187b9755
#+begin_example

Call:
lm(formula = G3.y ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.9301 -0.5485 -0.0070  0.5857  4.5273 

Coefficients: (7 not defined because of singularities)
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -0.708822   1.503557  -0.471   0.6376    
schoolMS         -0.786337   0.265637  -2.960   0.0033 ** 
sexM             -0.284316   0.167636  -1.696   0.0908 .  
age               0.103531   0.073978   1.399   0.1626    
addressU          0.141178   0.192343   0.734   0.4635    
famsizeLE3       -0.213035   0.157747  -1.350   0.1778    
PstatusT         -0.384705   0.236423  -1.627   0.1047    
Medu             -0.116952   0.105242  -1.111   0.2673    
Fedu             -0.022665   0.090592  -0.250   0.8026    
Mjobhealth        0.361176   0.364562   0.991   0.3226    
Mjobother        -0.241313   0.236256  -1.021   0.3078    
Mjobservices      0.218045   0.262899   0.829   0.4075    
Mjobteacher       0.452101   0.333977   1.354   0.1768    
Fjobhealth       -0.683097   0.484957  -1.409   0.1599    
Fjobother        -0.498716   0.359157  -1.389   0.1659    
Fjobservices     -0.559028   0.369966  -1.511   0.1318    
Fjobteacher      -0.804700   0.424530  -1.896   0.0589 .  
reasonhome        0.093701   0.177262   0.529   0.5974    
reasonother      -0.615429   0.263827  -2.333   0.0203 *  
reasonreputation -0.072306   0.186447  -0.388   0.6984    
nurseryyes       -0.001288   0.178625  -0.007   0.9943    
internetyes       0.261467   0.209384   1.249   0.2127    
guardian.xmother  2.803501   3.544499   0.791   0.4296    
guardian.xother   0.508093   0.371591   1.367   0.1725    
traveltime.x      0.481880   0.957212   0.503   0.6150    
studytime.x      -1.634897   4.128243  -0.396   0.6923    
failures.x       -0.199805   0.124118  -1.610   0.1084    
schoolsup.xyes   -2.448388   3.911720  -0.626   0.5318    
famsup.xyes       4.196858   7.932075   0.529   0.5971    
paid.xyes        -0.170457   0.154863  -1.101   0.2718    
activities.xyes   1.246566   5.448638   0.229   0.8192    
higher.xyes       1.731763   2.530151   0.684   0.4942    
romantic.xyes    -0.562372   0.948220  -0.593   0.5535    
famrel.x          0.078403   0.079477   0.986   0.3246    
freetime.x       -0.030149   0.076487  -0.394   0.6937    
goout.x          -0.053470   0.072507  -0.737   0.4614    
Dalc.x           -0.048269   0.107756  -0.448   0.6545    
Walc.x            0.034453   0.080401   0.429   0.6686    
health.x         -0.061668   0.051781  -1.191   0.2345    
absences.x       -0.022687   0.011300  -2.008   0.0455 *  
G1.x              0.055496   0.045730   1.214   0.2258    
G2.x             -0.037681   0.050881  -0.741   0.4595    
G3.x              0.034477   0.036825   0.936   0.3498    
guardian.ymother -2.688266   3.543488  -0.759   0.4486    
guardian.yother         NA         NA      NA       NA    
traveltime.y     -0.300566   0.953312  -0.315   0.7527    
studytime.y       1.655202   4.129611   0.401   0.6888    
failures.y       -0.413080   0.176746  -2.337   0.0200 *  
schoolsup.yyes    2.363260   3.910619   0.604   0.5461    
famsup.yyes      -4.058048   7.931220  -0.512   0.6092    
paid.yyes        -0.066205   0.290245  -0.228   0.8197    
activities.yyes  -1.085456   5.439090  -0.200   0.8419    
higher.yyes      -1.362799   2.522784  -0.540   0.5894    
romantic.yyes     0.696680   0.947613   0.735   0.4627    
famrel.y                NA         NA      NA       NA    
freetime.y              NA         NA      NA       NA    
goout.y                 NA         NA      NA       NA    
Dalc.y                  NA         NA      NA       NA    
Walc.y                  NA         NA      NA       NA    
health.y                NA         NA      NA       NA    
absences.y        0.036818   0.017310   2.127   0.0342 *  
G1.y              0.135017   0.061425   2.198   0.0286 *  
G2.y              0.808075   0.067577  11.958   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.269 on 326 degrees of freedom
Multiple R-squared:  0.8411,	Adjusted R-squared:  0.8143 
F-statistic: 31.38 on 55 and 326 DF,  p-value: < 2.2e-16

#+end_example

**** StepAIC
#+begin_src ein-r :session localhost :results output :exports both :eval no
  library(MASS)
#+end_src

#+RESULTS: 2a9c6b83-520d-40c3-a56f-52df66b075d6

#+NAME: a071ebc2-5e7d-486e-b7ca-1e5d5e958baf
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein_x, direction="both", keep=NULL)
#+end_src

#+RESULTS: a071ebc2-5e7d-486e-b7ca-1e5d5e958baf
#+begin_example
Start:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + freetime.y + goout.y + Dalc.y + Walc.y + 
    health.y + absences.y + G1.y + G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + freetime.y + goout.y + Dalc.y + Walc.y + 
    absences.y + G1.y + G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + freetime.y + goout.y + Dalc.y + absences.y + 
    G1.y + G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + freetime.y + goout.y + absences.y + 
    G1.y + G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + freetime.y + absences.y + G1.y + 
    G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + famrel.y + absences.y + G1.y + G2.y + G3.y


Step:  AIC=544.38
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- Mjob          4      4.84 1189.6 537.94
- Fjob          4      9.52 1194.3 539.44
- reason        3     10.84 1195.6 541.86
- paid.y        1      0.01 1184.8 542.39
- paid.x        1      0.03 1184.8 542.39
- Pstatus       1      0.07 1184.8 542.41
- G1.y          1      0.16 1185.0 542.44
- guardian.x    1      0.18 1185.0 542.44
- guardian.y    1      0.26 1185.0 542.47
- activities.y  1      0.29 1185.1 542.48
- internet      1      0.29 1185.1 542.48
- studytime.x   1      0.37 1185.2 542.50
- activities.x  1      0.41 1185.2 542.52
- studytime.y   1      0.43 1185.2 542.52
- famsup.x      1      0.43 1185.2 542.52
- famsize       1      0.45 1185.2 542.53
- higher.y      1      0.45 1185.2 542.53
- famsup.y      1      0.47 1185.2 542.54
- higher.x      1      0.59 1185.4 542.58
- Medu          1      0.94 1185.7 542.69
- freetime.x    1      1.11 1185.9 542.74
- failures.x    1      1.22 1186.0 542.78
- schoolsup.y   1      1.23 1186.0 542.78
- romantic.y    1      1.50 1186.3 542.87
- Dalc.x        1      1.51 1186.3 542.87
- schoolsup.x   1      1.64 1186.4 542.91
- address       1      1.67 1186.5 542.92
- romantic.x    1      2.33 1187.1 543.13
- goout.x       1      2.42 1187.2 543.16
- Fedu          1      2.53 1187.3 543.20
- G2.y          1      2.58 1187.4 543.22
- G3.y          1      3.19 1188.0 543.41
- nursery       1      3.26 1188.0 543.43
- failures.y    1      4.62 1189.4 543.87
- Walc.x        1      4.94 1189.7 543.97
- school        1      5.16 1190.0 544.05
- health.x      1      5.53 1190.3 544.16
- sex           1      5.97 1190.8 544.31
<none>                      1184.8 544.38
- absences.y    1     17.38 1202.2 547.95
- traveltime.y  1     17.53 1202.3 547.99
- traveltime.x  1     17.57 1202.4 548.01
- G1.x          1     18.83 1203.6 548.41
- age           1     21.63 1206.4 549.30
- famrel.x      1     31.77 1216.5 552.49
- absences.x    1     55.23 1240.0 559.79
- G2.x          1    939.89 2124.7 765.49

Step:  AIC=537.94
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- Fjob          4      9.79 1199.4 533.07
- reason        3     11.22 1200.8 535.53
- paid.x        1      0.00 1189.6 535.94
- paid.y        1      0.02 1189.7 535.95
- G1.y          1      0.10 1189.7 535.97
- Medu          1      0.15 1189.8 535.99
- guardian.x    1      0.20 1189.8 536.01
- famsize       1      0.25 1189.9 536.02
- Pstatus       1      0.26 1189.9 536.03
- guardian.y    1      0.28 1189.9 536.03
- activities.y  1      0.29 1189.9 536.04
- studytime.x   1      0.35 1190.0 536.06
- internet      1      0.37 1190.0 536.06
- studytime.y   1      0.41 1190.0 536.07
- activities.x  1      0.43 1190.0 536.08
- higher.y      1      0.43 1190.1 536.08
- famsup.x      1      0.45 1190.1 536.09
- famsup.y      1      0.48 1190.1 536.10
- higher.x      1      0.57 1190.2 536.13
- Dalc.x        1      0.93 1190.6 536.24
- freetime.x    1      0.99 1190.6 536.26
- failures.x    1      1.02 1190.7 536.27
- schoolsup.y   1      1.14 1190.8 536.31
- address       1      1.43 1191.1 536.40
- schoolsup.x   1      1.58 1191.2 536.45
- romantic.y    1      1.60 1191.2 536.45
- Fedu          1      2.19 1191.8 536.64
- romantic.x    1      2.40 1192.0 536.71
- goout.x       1      2.49 1192.1 536.74
- G2.y          1      2.55 1192.2 536.76
- G3.y          1      2.58 1192.2 536.77
- nursery       1      3.75 1193.4 537.15
- Walc.x        1      3.97 1193.6 537.22
- failures.y    1      4.09 1193.7 537.25
- school        1      5.30 1194.9 537.64
- health.x      1      5.46 1195.1 537.69
- sex           1      6.04 1195.7 537.88
<none>                      1189.6 537.94
- absences.y    1     16.24 1205.9 541.12
- traveltime.y  1     17.63 1207.3 541.56
- traveltime.x  1     17.76 1207.4 541.60
- G1.x          1     18.74 1208.4 541.91
- age           1     20.69 1210.3 542.53
+ Mjob          4      4.84 1184.8 544.38
- famrel.x      1     35.53 1225.2 547.18
- absences.x    1     56.61 1246.2 553.70
- G2.x          1    963.32 2152.9 762.54

Step:  AIC=533.07
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + reason + nursery + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + freetime.x + 
    goout.x + Dalc.x + Walc.x + health.x + absences.x + G1.x + 
    G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- reason        3     12.13 1211.5 530.92
- paid.y        1      0.02 1199.4 531.08
- paid.x        1      0.08 1199.5 531.10
- G1.y          1      0.09 1199.5 531.10
- Medu          1      0.21 1199.6 531.14
- higher.y      1      0.25 1199.7 531.15
- higher.x      1      0.40 1199.8 531.20
- guardian.x    1      0.40 1199.8 531.20
- famsize       1      0.47 1199.9 531.22
- guardian.y    1      0.53 1200.0 531.24
- Pstatus       1      0.53 1200.0 531.24
- activities.y  1      0.62 1200.0 531.27
- studytime.x   1      0.68 1200.1 531.29
- studytime.y   1      0.76 1200.2 531.31
- famsup.x      1      0.77 1200.2 531.32
- activities.x  1      0.81 1200.2 531.33
- famsup.y      1      0.82 1200.2 531.33
- internet      1      0.94 1200.4 531.37
- address       1      1.51 1200.9 531.55
- freetime.x    1      1.63 1201.0 531.59
- Dalc.x        1      1.65 1201.1 531.60
- romantic.y    1      1.73 1201.2 531.62
- schoolsup.y   1      1.82 1201.2 531.65
- failures.x    1      1.83 1201.2 531.65
- schoolsup.x   1      2.38 1201.8 531.83
- G3.y          1      2.47 1201.9 531.86
- romantic.x    1      2.57 1202.0 531.89
- G2.y          1      2.69 1202.1 531.93
- Fedu          1      2.92 1202.3 532.00
- goout.x       1      3.05 1202.5 532.04
- Walc.x        1      3.72 1203.1 532.26
- school        1      4.05 1203.5 532.36
- nursery       1      4.21 1203.6 532.41
- failures.y    1      5.17 1204.6 532.72
<none>                      1199.4 533.07
- sex           1      6.80 1206.2 533.23
- health.x      1      6.84 1206.3 533.25
- absences.y    1     14.66 1214.1 535.71
- traveltime.y  1     17.10 1216.5 536.48
- traveltime.x  1     17.32 1216.7 536.55
- G1.x          1     18.87 1218.3 537.04
- age           1     21.55 1221.0 537.88
+ Fjob          4      9.79 1189.6 537.94
+ Mjob          4      5.11 1194.3 539.44
- famrel.x      1     34.02 1233.4 541.76
- absences.x    1     54.96 1254.4 548.19
- G2.x          1    981.49 2180.9 759.47

Step:  AIC=530.92
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + freetime.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    paid.y + activities.y + higher.y + romantic.y + absences.y + 
    G1.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- G1.y          1      0.04 1211.6 528.93
- paid.y        1      0.11 1211.7 528.95
- paid.x        1      0.14 1211.7 528.96
- higher.y      1      0.21 1211.8 528.98
- higher.x      1      0.30 1211.8 529.01
- famsize       1      0.41 1212.0 529.05
- guardian.x    1      0.44 1212.0 529.06
- guardian.y    1      0.58 1212.1 529.10
- Medu          1      0.68 1212.2 529.13
- Pstatus       1      0.70 1212.2 529.14
- activities.y  1      0.70 1212.2 529.14
- studytime.x   1      0.78 1212.3 529.16
- famsup.x      1      0.85 1212.4 529.19
- studytime.y   1      0.86 1212.4 529.19
- activities.x  1      0.89 1212.4 529.20
- famsup.y      1      0.90 1212.5 529.20
- internet      1      1.23 1212.8 529.31
- G3.y          1      1.39 1212.9 529.36
- Dalc.x        1      1.52 1213.1 529.40
- romantic.y    1      1.79 1213.3 529.48
- schoolsup.y   1      1.81 1213.4 529.49
- freetime.x    1      2.04 1213.6 529.56
- failures.x    1      2.27 1213.8 529.63
- schoolsup.x   1      2.37 1213.9 529.66
- romantic.x    1      2.58 1214.1 529.73
- goout.x       1      2.67 1214.2 529.76
- address       1      3.02 1214.6 529.87
- G2.y          1      3.10 1214.7 529.90
- Fedu          1      3.52 1215.1 530.03
- school        1      3.87 1215.4 530.14
- nursery       1      4.18 1215.7 530.23
- Walc.x        1      4.47 1216.0 530.32
- sex           1      4.77 1216.3 530.42
- failures.y    1      5.08 1216.6 530.52
- health.x      1      5.42 1217.0 530.62
<none>                      1211.5 530.92
+ reason        3     12.13 1199.4 533.07
- absences.y    1     15.25 1226.8 533.70
- traveltime.y  1     17.31 1228.9 534.34
- traveltime.x  1     17.45 1229.0 534.38
- G1.x          1     18.66 1230.2 534.76
+ Fjob          4     10.70 1200.8 535.53
- age           1     22.37 1233.9 535.91
+ Mjob          4      5.06 1206.5 537.32
- famrel.x      1     35.75 1247.3 540.03
- absences.x    1     53.19 1264.7 545.33
- G2.x          1   1005.96 2217.5 759.83

Step:  AIC=528.93
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + freetime.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    paid.y + activities.y + higher.y + romantic.y + absences.y + 
    G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- paid.y        1      0.10 1211.7 526.96
- paid.x        1      0.13 1211.7 526.97
- higher.y      1      0.20 1211.8 526.99
- higher.x      1      0.30 1211.9 527.02
- famsize       1      0.38 1212.0 527.05
- guardian.x    1      0.45 1212.0 527.07
- guardian.y    1      0.59 1212.2 527.12
- Medu          1      0.67 1212.3 527.14
- activities.y  1      0.72 1212.3 527.16
- Pstatus       1      0.74 1212.3 527.16
- studytime.x   1      0.81 1212.4 527.18
- famsup.x      1      0.87 1212.5 527.20
- studytime.y   1      0.88 1212.5 527.21
- activities.x  1      0.91 1212.5 527.22
- famsup.y      1      0.93 1212.5 527.22
- internet      1      1.24 1212.8 527.32
- G3.y          1      1.36 1213.0 527.36
- Dalc.x        1      1.51 1213.1 527.41
- romantic.y    1      1.79 1213.4 527.49
- schoolsup.y   1      1.84 1213.4 527.51
- freetime.x    1      2.05 1213.6 527.57
- failures.x    1      2.36 1214.0 527.67
- schoolsup.x   1      2.41 1214.0 527.69
- romantic.x    1      2.59 1214.2 527.75
- goout.x       1      2.63 1214.2 527.76
- address       1      2.99 1214.6 527.87
- Fedu          1      3.50 1215.1 528.03
- school        1      3.94 1215.5 528.17
- nursery       1      4.15 1215.7 528.24
- G2.y          1      4.16 1215.7 528.24
- Walc.x        1      4.50 1216.1 528.34
- sex           1      4.83 1216.4 528.45
- failures.y    1      5.11 1216.7 528.54
- health.x      1      5.40 1217.0 528.63
<none>                      1211.6 528.93
+ G1.y          1      0.04 1211.5 530.92
+ reason        3     12.08 1199.5 531.10
- absences.y    1     15.22 1226.8 531.70
- traveltime.y  1     17.29 1228.9 532.34
- traveltime.x  1     17.43 1229.0 532.39
- G1.x          1     18.79 1230.4 532.81
+ Fjob          4     10.67 1200.9 533.55
- age           1     22.66 1234.2 534.01
+ Mjob          4      5.03 1206.6 535.34
- famrel.x      1     36.13 1247.7 538.15
- absences.x    1     53.38 1265.0 543.40
- G2.x          1   1011.84 2223.4 758.85

Step:  AIC=526.96
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + freetime.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    activities.y + higher.y + romantic.y + absences.y + G2.y + 
    G3.y

               Df Sum of Sq    RSS    AIC
- paid.x        1      0.12 1211.8 525.00
- higher.y      1      0.17 1211.9 525.02
- higher.x      1      0.27 1212.0 525.05
- famsize       1      0.39 1212.1 525.08
- guardian.x    1      0.53 1212.2 525.13
- Medu          1      0.66 1212.3 525.17
- guardian.y    1      0.68 1212.4 525.18
- Pstatus       1      0.73 1212.4 525.19
- activities.y  1      0.82 1212.5 525.22
- studytime.x   1      0.90 1212.6 525.24
- famsup.x      1      0.98 1212.7 525.27
- studytime.y   1      0.98 1212.7 525.27
- activities.x  1      1.03 1212.7 525.29
- famsup.y      1      1.03 1212.7 525.29
- internet      1      1.25 1212.9 525.36
- G3.y          1      1.37 1213.1 525.39
- Dalc.x        1      1.59 1213.3 525.46
- romantic.y    1      1.82 1213.5 525.54
- schoolsup.y   1      1.99 1213.7 525.59
- freetime.x    1      2.11 1213.8 525.63
- failures.x    1      2.36 1214.0 525.71
- schoolsup.x   1      2.58 1214.3 525.77
- goout.x       1      2.62 1214.3 525.79
- romantic.x    1      2.63 1214.3 525.79
- address       1      2.92 1214.6 525.88
- Fedu          1      3.59 1215.3 526.09
- school        1      3.85 1215.5 526.17
- nursery       1      4.17 1215.9 526.27
- G2.y          1      4.19 1215.9 526.28
- Walc.x        1      4.58 1216.3 526.40
- sex           1      4.73 1216.4 526.45
- failures.y    1      5.00 1216.7 526.54
- health.x      1      5.35 1217.0 526.64
<none>                      1211.7 526.96
+ paid.y        1      0.10 1211.6 528.93
+ G1.y          1      0.03 1211.7 528.95
+ reason        3     12.17 1199.5 529.11
- absences.y    1     15.13 1226.8 529.70
- traveltime.y  1     17.23 1228.9 530.36
- traveltime.x  1     17.39 1229.1 530.41
- G1.x          1     19.00 1230.7 530.91
+ Fjob          4     10.71 1201.0 531.57
- age           1     22.58 1234.3 532.02
+ Mjob          4      4.96 1206.7 533.39
- famrel.x      1     36.05 1247.7 536.16
- absences.x    1     53.27 1265.0 541.40
- G2.x          1   1012.62 2224.3 757.00

Step:  AIC=525
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + activities.x + higher.x + 
    romantic.x + famrel.x + freetime.x + goout.x + Dalc.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + activities.y + 
    higher.y + romantic.y + absences.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- higher.y      1      0.17 1212.0 523.05
- higher.x      1      0.27 1212.1 523.09
- famsize       1      0.39 1212.2 523.12
- guardian.x    1      0.53 1212.3 523.17
- guardian.y    1      0.68 1212.5 523.21
- Medu          1      0.68 1212.5 523.21
- Pstatus       1      0.68 1212.5 523.22
- activities.y  1      0.83 1212.6 523.26
- studytime.x   1      0.91 1212.7 523.29
- famsup.x      1      0.99 1212.8 523.31
- studytime.y   1      1.00 1212.8 523.31
- activities.x  1      1.04 1212.8 523.33
- famsup.y      1      1.04 1212.9 523.33
- internet      1      1.18 1213.0 523.37
- G3.y          1      1.33 1213.1 523.42
- Dalc.x        1      1.55 1213.4 523.49
- romantic.y    1      1.81 1213.6 523.57
- schoolsup.y   1      2.00 1213.8 523.63
- freetime.x    1      2.05 1213.9 523.65
- failures.x    1      2.46 1214.3 523.78
- goout.x       1      2.59 1214.4 523.82
- schoolsup.x   1      2.59 1214.4 523.82
- romantic.x    1      2.61 1214.4 523.82
- address       1      2.90 1214.7 523.91
- Fedu          1      3.64 1215.5 524.15
- school        1      3.88 1215.7 524.22
- nursery       1      4.07 1215.9 524.28
- G2.y          1      4.22 1216.0 524.33
- sex           1      4.64 1216.5 524.46
- Walc.x        1      4.83 1216.6 524.52
- failures.y    1      4.91 1216.7 524.55
- health.x      1      5.26 1217.1 524.66
<none>                      1211.8 525.00
+ paid.x        1      0.12 1211.7 526.96
+ paid.y        1      0.09 1211.7 526.97
+ G1.y          1      0.03 1211.8 526.99
+ reason        3     12.21 1199.6 527.13
- absences.y    1     15.80 1227.6 527.95
- traveltime.y  1     17.23 1229.0 528.39
- traveltime.x  1     17.38 1229.2 528.44
- G1.x          1     18.88 1230.7 528.91
+ Fjob          4     10.82 1201.0 529.57
- age           1     22.50 1234.3 530.03
+ Mjob          4      4.81 1207.0 531.48
- famrel.x      1     36.17 1248.0 534.24
- absences.x    1     53.45 1265.3 539.49
- G2.x          1   1023.49 2235.3 756.88

Step:  AIC=523.05
G3.x ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + activities.x + higher.x + 
    romantic.x + famrel.x + freetime.x + goout.x + Dalc.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + activities.y + 
    romantic.y + absences.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- famsize       1      0.38 1212.4 521.17
- higher.x      1      0.53 1212.5 521.22
- Medu          1      0.67 1212.7 521.26
- Pstatus       1      0.67 1212.7 521.27
- internet      1      1.11 1213.1 521.41
- G3.y          1      1.36 1213.3 521.48
- Dalc.x        1      1.57 1213.6 521.55
- freetime.x    1      2.13 1214.1 521.72
- failures.x    1      2.49 1214.5 521.84
- romantic.y    1      2.62 1214.6 521.88
- goout.x       1      2.77 1214.8 521.93
- address       1      2.99 1215.0 522.00
- Fedu          1      3.61 1215.6 522.19
- romantic.x    1      3.66 1215.7 522.21
- school        1      3.77 1215.8 522.24
- nursery       1      4.05 1216.0 522.33
- G2.y          1      4.25 1216.2 522.39
- sex           1      4.62 1216.6 522.51
- Walc.x        1      4.86 1216.8 522.58
- failures.y    1      4.96 1217.0 522.62
- health.x      1      5.30 1217.3 522.72
- activities.y  1      5.95 1217.9 522.93
<none>                      1212.0 523.05
- schoolsup.y   1      6.54 1218.5 523.11
- activities.x  1      7.05 1219.0 523.27
- guardian.x    1      7.08 1219.1 523.28
- studytime.x   1      7.11 1219.1 523.29
- studytime.y   1      7.58 1219.6 523.44
- schoolsup.x   1      8.16 1220.1 523.62
- guardian.y    1      8.32 1220.3 523.67
- famsup.x      1     10.33 1222.3 524.30
- famsup.y      1     10.75 1222.7 524.43
+ higher.y      1      0.17 1211.8 525.00
+ famrel.y      1      0.17 1211.8 525.00
+ freetime.y    1      0.17 1211.8 525.00
+ goout.y       1      0.17 1211.8 525.00
+ Dalc.y        1      0.17 1211.8 525.00
+ health.y      1      0.17 1211.8 525.00
+ paid.x        1      0.12 1211.9 525.02
+ paid.y        1      0.07 1211.9 525.03
+ G1.y          1      0.03 1212.0 525.05
+ reason        3     12.12 1199.9 525.21
- absences.y    1     16.42 1228.4 526.19
- G1.x          1     18.82 1230.8 526.94
- traveltime.y  1     18.92 1230.9 526.97
- traveltime.x  1     19.08 1231.1 527.02
+ Fjob          4     10.67 1201.3 527.68
- age           1     22.42 1234.4 528.06
+ Mjob          4      4.72 1207.3 529.56
- famrel.x      1     37.32 1249.3 532.64
- absences.x    1     54.07 1266.1 537.73
- G2.x          1   1023.51 2235.5 754.92

Step:  AIC=521.17
G3.x ~ school + sex + age + address + Pstatus + Medu + Fedu + 
    nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + activities.x + higher.x + 
    romantic.x + famrel.x + freetime.x + goout.x + Dalc.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + activities.y + 
    romantic.y + absences.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- higher.x      1      0.53 1212.9 519.34
- Medu          1      0.62 1213.0 519.37
- Pstatus       1      0.84 1213.2 519.44
- internet      1      1.06 1213.4 519.51
- G3.y          1      1.33 1213.7 519.59
- Dalc.x        1      1.51 1213.9 519.65
- freetime.x    1      2.16 1214.5 519.86
- failures.x    1      2.51 1214.9 519.97
- romantic.y    1      2.58 1214.9 519.99
- goout.x       1      2.73 1215.1 520.03
- address       1      2.86 1215.2 520.07
- romantic.x    1      3.60 1216.0 520.31
- Fedu          1      3.72 1216.1 520.34
- nursery       1      3.80 1216.2 520.37
- school        1      3.82 1216.2 520.38
- G2.y          1      4.37 1216.7 520.55
- sex           1      4.78 1217.1 520.68
- failures.y    1      4.84 1217.2 520.70
- Walc.x        1      4.99 1217.3 520.74
- health.x      1      5.21 1217.6 520.81
- activities.y  1      5.97 1218.3 521.05
<none>                      1212.4 521.17
- schoolsup.y   1      6.51 1218.9 521.22
- activities.x  1      7.08 1219.4 521.40
- guardian.x    1      7.11 1219.5 521.41
- studytime.x   1      7.16 1219.5 521.42
- studytime.y   1      7.64 1220.0 521.57
- schoolsup.x   1      8.13 1220.5 521.73
- guardian.y    1      8.37 1220.7 521.80
- famsup.x      1     10.37 1222.7 522.43
- famsup.y      1     10.77 1223.1 522.55
+ famsize       1      0.38 1212.0 523.05
+ higher.y      1      0.16 1212.2 523.12
+ famrel.y      1      0.16 1212.2 523.12
+ freetime.y    1      0.16 1212.2 523.12
+ goout.y       1      0.16 1212.2 523.12
+ Dalc.y        1      0.16 1212.2 523.12
+ health.y      1      0.16 1212.2 523.12
+ paid.x        1      0.12 1212.2 523.14
+ paid.y        1      0.07 1212.3 523.15
+ G1.y          1      0.01 1212.4 523.17
+ reason        3     12.08 1200.3 523.35
- absences.y    1     16.55 1228.9 524.36
- G1.x          1     18.84 1231.2 525.06
- traveltime.y  1     19.02 1231.4 525.12
- traveltime.x  1     19.24 1231.6 525.19
+ Fjob          4     10.88 1201.5 525.73
- age           1     22.36 1234.7 526.16
+ Mjob          4      4.44 1207.9 527.77
- famrel.x      1     37.26 1249.6 530.74
- absences.x    1     54.45 1266.8 535.96
- G2.x          1   1025.95 2238.3 753.40

Step:  AIC=519.34
G3.x ~ school + sex + age + address + Pstatus + Medu + Fedu + 
    nursery + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + activities.x + romantic.x + 
    famrel.x + freetime.x + goout.x + Dalc.x + Walc.x + health.x + 
    absences.x + G1.x + G2.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + activities.y + romantic.y + 
    absences.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- Medu          1      0.64 1213.5 517.54
- Pstatus       1      0.86 1213.8 517.61
- internet      1      1.17 1214.1 517.71
- G3.y          1      1.44 1214.3 517.80
- Dalc.x        1      1.45 1214.3 517.80
- freetime.x    1      2.20 1215.1 518.03
- romantic.y    1      2.68 1215.6 518.18
- goout.x       1      2.74 1215.6 518.20
- address       1      2.84 1215.7 518.24
- failures.x    1      3.05 1216.0 518.30
- Fedu          1      3.65 1216.5 518.49
- romantic.x    1      3.79 1216.7 518.53
- nursery       1      3.81 1216.7 518.54
- school        1      4.21 1217.1 518.66
- G2.y          1      4.47 1217.4 518.75
- sex           1      4.48 1217.4 518.75
- failures.y    1      4.66 1217.5 518.81
- Walc.x        1      5.11 1218.0 518.95
- health.x      1      5.21 1218.1 518.98
<none>                      1212.9 519.34
- activities.y  1      6.56 1219.5 519.40
- schoolsup.y   1      6.97 1219.9 519.53
- activities.x  1      7.70 1220.6 519.76
- studytime.x   1      7.88 1220.8 519.81
- guardian.x    1      7.96 1220.9 519.84
- studytime.y   1      8.37 1221.3 519.97
- schoolsup.x   1      8.65 1221.5 520.06
- guardian.y    1      9.29 1222.2 520.26
- famsup.x      1     11.48 1224.4 520.94
- famsup.y      1     11.93 1224.8 521.08
+ higher.x      1      0.53 1212.4 521.17
+ higher.y      1      0.44 1212.5 521.20
+ famsize       1      0.38 1212.5 521.22
+ famrel.y      1      0.19 1212.7 521.28
+ freetime.y    1      0.19 1212.7 521.28
+ goout.y       1      0.19 1212.7 521.28
+ Dalc.y        1      0.19 1212.7 521.28
+ health.y      1      0.19 1212.7 521.28
+ paid.x        1      0.18 1212.7 521.29
+ paid.y        1      0.05 1212.8 521.32
+ G1.y          1      0.01 1212.9 521.34
+ reason        3     11.70 1201.2 521.64
- absences.y    1     17.15 1230.0 522.71
- traveltime.y  1     18.64 1231.5 523.17
- traveltime.x  1     18.86 1231.8 523.24
- G1.x          1     19.07 1232.0 523.30
+ Fjob          4     11.11 1201.8 523.83
- age           1     24.75 1237.6 525.06
+ Mjob          4      4.58 1208.3 525.90
- famrel.x      1     37.53 1250.4 528.98
- absences.x    1     55.42 1268.3 534.41
- G2.x          1   1025.62 2238.5 751.43

Step:  AIC=517.54
G3.x ~ school + sex + age + address + Pstatus + Fedu + nursery + 
    internet + guardian.x + traveltime.x + studytime.x + failures.x + 
    schoolsup.x + famsup.x + activities.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + activities.y + romantic.y + absences.y + 
    G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- Pstatus       1      0.96 1214.5 515.85
- internet      1      1.03 1214.6 515.87
- Dalc.x        1      1.28 1214.8 515.95
- G3.y          1      1.41 1215.0 515.99
- freetime.x    1      2.24 1215.8 516.25
- romantic.y    1      2.63 1216.2 516.37
- address       1      2.69 1216.2 516.39
- goout.x       1      2.90 1216.4 516.46
- failures.x    1      3.13 1216.7 516.53
- Fedu          1      3.15 1216.7 516.53
- nursery       1      3.55 1217.1 516.66
- romantic.x    1      3.73 1217.3 516.72
- school        1      4.15 1217.7 516.85
- failures.y    1      4.55 1218.1 516.98
- G2.y          1      4.67 1218.2 517.01
- Walc.x        1      4.83 1218.4 517.06
- sex           1      4.99 1218.5 517.11
- health.x      1      5.07 1218.6 517.14
<none>                      1213.5 517.54
- activities.y  1      6.41 1220.0 517.56
- schoolsup.y   1      6.79 1220.3 517.68
- activities.x  1      7.53 1221.1 517.91
- studytime.x   1      7.76 1221.3 517.98
- guardian.x    1      7.85 1221.4 518.01
- studytime.y   1      8.24 1221.8 518.13
- schoolsup.x   1      8.42 1222.0 518.19
- guardian.y    1      9.26 1222.8 518.45
- famsup.x      1     11.33 1224.9 519.09
- famsup.y      1     11.78 1225.3 519.24
+ Medu          1      0.64 1212.9 519.34
+ higher.x      1      0.55 1213.0 519.37
+ higher.y      1      0.46 1213.1 519.40
+ famsize       1      0.33 1213.2 519.44
+ paid.x        1      0.20 1213.3 519.48
+ famrel.y      1      0.18 1213.3 519.49
+ freetime.y    1      0.18 1213.3 519.49
+ goout.y       1      0.18 1213.3 519.49
+ Dalc.y        1      0.18 1213.3 519.49
+ health.y      1      0.18 1213.3 519.49
+ paid.y        1      0.04 1213.5 519.53
+ G1.y          1      0.01 1213.5 519.54
+ reason        3     12.14 1201.4 519.70
- absences.y    1     17.37 1230.9 520.97
- traveltime.y  1     18.76 1232.3 521.40
- G1.x          1     18.91 1232.5 521.45
- traveltime.x  1     18.94 1232.5 521.46
+ Fjob          4     11.27 1202.3 521.98
- age           1     25.03 1238.6 523.34
+ Mjob          4      3.65 1209.9 524.39
- famrel.x      1     37.31 1250.8 527.11
- absences.x    1     57.42 1271.0 533.20
- G2.x          1   1028.02 2241.6 749.95

Step:  AIC=515.85
G3.x ~ school + sex + age + address + Fedu + nursery + internet + 
    guardian.x + traveltime.x + studytime.x + failures.x + schoolsup.x + 
    famsup.x + activities.x + romantic.x + famrel.x + freetime.x + 
    goout.x + Dalc.x + Walc.x + health.x + absences.x + G1.x + 
    G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + activities.y + romantic.y + absences.y + 
    G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- Dalc.x        1      1.14 1215.6 514.20
- internet      1      1.20 1215.7 514.22
- G3.y          1      1.58 1216.1 514.34
- freetime.x    1      2.14 1216.6 514.52
- address       1      2.60 1217.1 514.66
- romantic.y    1      2.62 1217.1 514.67
- Fedu          1      2.87 1217.4 514.75
- failures.x    1      2.93 1217.4 514.77
- goout.x       1      2.95 1217.5 514.77
- nursery       1      3.39 1217.9 514.91
- romantic.x    1      3.68 1218.2 515.00
- school        1      4.04 1218.5 515.12
- failures.y    1      4.40 1218.9 515.23
- Walc.x        1      4.53 1219.0 515.27
- G2.y          1      4.63 1219.1 515.30
- health.x      1      4.96 1219.5 515.40
- sex           1      5.19 1219.7 515.48
<none>                      1214.5 515.85
- activities.y  1      6.46 1221.0 515.87
- schoolsup.y   1      6.84 1221.3 515.99
- activities.x  1      7.62 1222.1 516.23
- studytime.x   1      7.86 1222.4 516.31
- guardian.x    1      7.94 1222.4 516.34
- studytime.y   1      8.34 1222.8 516.46
- schoolsup.x   1      8.50 1223.0 516.51
- guardian.y    1      9.42 1223.9 516.80
- famsup.x      1     11.45 1226.0 517.43
+ Pstatus       1      0.96 1213.5 517.54
- famsup.y      1     11.89 1226.4 517.57
+ Medu          1      0.75 1213.8 517.61
+ higher.x      1      0.58 1213.9 517.67
+ famsize       1      0.49 1214.0 517.69
+ higher.y      1      0.48 1214.0 517.69
+ famrel.y      1      0.17 1214.3 517.79
+ freetime.y    1      0.17 1214.3 517.79
+ goout.y       1      0.17 1214.3 517.79
+ Dalc.y        1      0.17 1214.3 517.79
+ health.y      1      0.17 1214.3 517.79
+ paid.x        1      0.13 1214.4 517.81
+ paid.y        1      0.04 1214.5 517.84
+ G1.y          1      0.03 1214.5 517.84
+ reason        3     12.32 1202.2 517.95
- absences.y    1     17.69 1232.2 519.37
- G1.x          1     18.49 1233.0 519.62
- traveltime.y  1     18.72 1233.2 519.69
- traveltime.x  1     18.91 1233.4 519.75
+ Fjob          4     11.70 1202.8 520.15
- age           1     25.72 1240.2 521.85
+ Mjob          4      4.02 1210.5 522.58
- famrel.x      1     37.02 1251.5 525.32
- absences.x    1     61.40 1275.9 532.69
- G2.x          1   1032.58 2247.1 748.89

Step:  AIC=514.2
G3.x ~ school + sex + age + address + Fedu + nursery + internet + 
    guardian.x + traveltime.x + studytime.x + failures.x + schoolsup.x + 
    famsup.x + activities.x + romantic.x + famrel.x + freetime.x + 
    goout.x + Walc.x + health.x + absences.x + G1.x + G2.x + 
    guardian.y + traveltime.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + activities.y + romantic.y + absences.y + G2.y + 
    G3.y

               Df Sum of Sq    RSS    AIC
- internet      1      1.33 1217.0 512.62
- G3.y          1      1.74 1217.4 512.75
- freetime.x    1      1.76 1217.4 512.76
- address       1      2.54 1218.2 513.00
- romantic.y    1      2.76 1218.4 513.07
- failures.x    1      2.83 1218.5 513.09
- Fedu          1      3.08 1218.7 513.17
- goout.x       1      3.10 1218.7 513.18
- nursery       1      3.32 1219.0 513.25
- Walc.x        1      3.41 1219.0 513.27
- romantic.x    1      3.89 1219.5 513.43
- school        1      3.97 1219.6 513.45
- failures.y    1      4.26 1219.9 513.54
- G2.y          1      4.79 1220.4 513.71
- sex           1      4.89 1220.5 513.74
- health.x      1      5.03 1220.7 513.78
<none>                      1215.6 514.20
- activities.y  1      6.55 1222.2 514.26
- schoolsup.y   1      6.91 1222.5 514.37
- activities.x  1      7.69 1223.3 514.61
- studytime.x   1      8.05 1223.7 514.73
- guardian.x    1      8.10 1223.7 514.74
- schoolsup.x   1      8.53 1224.2 514.88
- studytime.y   1      8.55 1224.2 514.88
- guardian.y    1      9.61 1225.2 515.21
+ Dalc.y        1      1.17 1214.5 515.84
+ Dalc.x        1      1.14 1214.5 515.85
- famsup.x      1     11.82 1227.5 515.90
+ Pstatus       1      0.82 1214.8 515.95
+ Medu          1      0.56 1215.1 516.03
- famsup.y      1     12.25 1227.9 516.03
+ higher.x      1      0.51 1215.1 516.04
+ famsize       1      0.43 1215.2 516.07
+ higher.y      1      0.42 1215.2 516.07
+ freetime.y    1      0.20 1215.4 516.14
+ goout.y       1      0.20 1215.4 516.14
+ health.y      1      0.20 1215.4 516.14
+ famrel.y      1      0.20 1215.4 516.14
+ paid.x        1      0.09 1215.5 516.18
+ paid.y        1      0.08 1215.6 516.18
+ G1.y          1      0.02 1215.6 516.20
+ reason        3     12.22 1203.4 516.35
- absences.y    1     18.24 1233.9 517.89
- G1.x          1     18.44 1234.1 517.96
- traveltime.y  1     19.18 1234.8 518.19
- traveltime.x  1     19.26 1234.9 518.21
+ Fjob          4     12.21 1203.4 518.35
- age           1     26.30 1241.9 520.38
+ Mjob          4      3.89 1211.7 520.98
- famrel.x      1     37.41 1253.0 523.78
- absences.x    1     61.49 1277.1 531.05
- G2.x          1   1032.12 2247.8 747.01

Step:  AIC=512.62
G3.x ~ school + sex + age + address + Fedu + nursery + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    activities.x + romantic.x + famrel.x + freetime.x + goout.x + 
    Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    activities.y + romantic.y + absences.y + G2.y + G3.y

               Df Sum of Sq    RSS    AIC
- G3.y          1      1.49 1218.5 511.09
- freetime.x    1      1.61 1218.6 511.13
- romantic.y    1      2.82 1219.8 511.51
- goout.x       1      2.92 1219.9 511.54
- nursery       1      3.07 1220.0 511.59
- failures.x    1      3.31 1220.3 511.66
- Walc.x        1      3.31 1220.3 511.66
- address       1      3.37 1220.3 511.68
- Fedu          1      3.41 1220.4 511.69
- school        1      3.82 1220.8 511.82
- romantic.x    1      4.02 1221.0 511.88
- sex           1      4.56 1221.5 512.05
- failures.y    1      4.88 1221.8 512.15
- G2.y          1      5.47 1222.5 512.34
- health.x      1      5.58 1222.5 512.37
<none>                      1217.0 512.62
- activities.y  1      6.51 1223.5 512.66
- schoolsup.y   1      6.92 1223.9 512.79
- activities.x  1      7.66 1224.6 513.02
- guardian.x    1      8.01 1225.0 513.13
- studytime.x   1      8.09 1225.1 513.15
- schoolsup.x   1      8.56 1225.5 513.30
- studytime.y   1      8.62 1225.6 513.32
- guardian.y    1      9.52 1226.5 513.60
+ internet      1      1.33 1215.6 514.20
+ Dalc.y        1      1.30 1215.7 514.21
+ Dalc.x        1      1.27 1215.7 514.22
+ Pstatus       1      0.98 1216.0 514.32
- famsup.x      1     11.84 1228.8 514.32
+ higher.x      1      0.61 1216.4 514.43
- famsup.y      1     12.24 1229.2 514.45
+ higher.y      1      0.53 1216.4 514.46
+ Medu          1      0.42 1216.5 514.49
+ famsize       1      0.39 1216.6 514.50
+ famrel.y      1      0.13 1216.8 514.58
+ freetime.y    1      0.13 1216.8 514.58
+ goout.y       1      0.13 1216.8 514.58
+ health.y      1      0.13 1216.8 514.58
+ paid.y        1      0.10 1216.9 514.59
+ G1.y          1      0.04 1216.9 514.61
+ paid.x        1      0.03 1217.0 514.62
+ reason        3     12.45 1204.5 514.70
- absences.y    1     18.40 1235.4 516.36
- G1.x          1     18.81 1235.8 516.48
+ Fjob          4     13.04 1203.9 516.51
- traveltime.y  1     19.07 1236.0 516.56
- traveltime.x  1     19.18 1236.2 516.60
- age           1     25.92 1242.9 518.68
+ Mjob          4      3.80 1213.2 519.43
- famrel.x      1     36.50 1253.5 521.91
- absences.x    1     60.42 1277.4 529.13
- G2.x          1   1035.55 2252.5 745.81

Step:  AIC=511.09
G3.x ~ school + sex + age + address + Fedu + nursery + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    activities.x + romantic.x + famrel.x + freetime.x + goout.x + 
    Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    activities.y + romantic.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- freetime.x    1      1.58 1220.0 509.59
- goout.x       1      2.81 1221.3 509.97
- romantic.y    1      3.09 1221.5 510.06
- nursery       1      3.10 1221.6 510.06
- address       1      3.11 1221.6 510.06
- school        1      3.12 1221.6 510.07
- Walc.x        1      3.32 1221.8 510.13
- Fedu          1      3.60 1222.0 510.22
- failures.x    1      3.61 1222.1 510.22
- sex           1      4.13 1222.6 510.38
- failures.y    1      4.21 1222.7 510.41
- romantic.x    1      4.33 1222.8 510.45
- health.x      1      5.30 1223.8 510.75
<none>                      1218.5 511.09
- activities.y  1      6.69 1225.2 511.18
- schoolsup.y   1      6.83 1225.3 511.22
- guardian.x    1      7.79 1226.2 511.52
- activities.x  1      7.83 1226.3 511.54
- studytime.x   1      8.12 1226.6 511.63
- schoolsup.x   1      8.43 1226.9 511.72
- studytime.y   1      8.65 1227.1 511.79
- guardian.y    1      9.31 1227.8 512.00
+ G3.y          1      1.49 1217.0 512.62
+ Dalc.y        1      1.45 1217.0 512.64
+ Dalc.x        1      1.41 1217.0 512.65
+ Pstatus       1      1.12 1217.3 512.74
+ internet      1      1.08 1217.4 512.75
- famsup.x      1     11.81 1230.3 512.78
+ higher.x      1      0.73 1217.7 512.86
+ higher.y      1      0.62 1217.8 512.90
- famsup.y      1     12.24 1230.7 512.91
+ Medu          1      0.41 1218.0 512.96
+ famsize       1      0.36 1218.1 512.98
+ famrel.y      1      0.17 1218.3 513.04
+ freetime.y    1      0.17 1218.3 513.04
+ health.y      1      0.17 1218.3 513.04
+ goout.y       1      0.17 1218.3 513.04
+ paid.y        1      0.10 1218.4 513.06
+ paid.x        1      0.01 1218.5 513.09
+ G1.y          1      0.01 1218.5 513.09
+ reason        3     11.34 1207.1 513.52
- absences.y    1     17.42 1235.9 514.51
+ Fjob          4     12.83 1205.6 515.05
- traveltime.y  1     19.20 1237.7 515.06
- traveltime.x  1     19.41 1237.9 515.13
- G1.x          1     20.54 1239.0 515.48
- age           1     25.44 1243.9 516.98
- G2.y          1     27.08 1245.5 517.49
+ Mjob          4      3.44 1215.0 518.01
- famrel.x      1     37.28 1255.7 520.60
- absences.x    1     59.21 1277.7 527.22
- G2.x          1   1034.35 2252.8 743.86

Step:  AIC=509.59
G3.x ~ school + sex + age + address + Fedu + nursery + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    activities.x + romantic.x + famrel.x + goout.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + activities.y + 
    romantic.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- romantic.y    1      2.93 1223.0 508.50
- nursery       1      3.03 1223.1 508.53
- address       1      3.06 1223.1 508.54
- Walc.x        1      3.31 1223.3 508.62
- school        1      3.44 1223.5 508.66
- failures.x    1      3.45 1223.5 508.66
- Fedu          1      3.93 1224.0 508.81
- romantic.x    1      4.11 1224.2 508.87
- failures.y    1      4.23 1224.3 508.91
- goout.x       1      4.37 1224.4 508.95
- sex           1      4.92 1225.0 509.12
- health.x      1      5.48 1225.5 509.30
<none>                      1220.0 509.59
- activities.y  1      6.49 1226.5 509.61
- schoolsup.y   1      6.77 1226.8 509.70
- activities.x  1      7.59 1227.6 509.95
- guardian.x    1      7.73 1227.8 510.00
- studytime.x   1      7.93 1228.0 510.06
- schoolsup.x   1      8.37 1228.4 510.20
- studytime.y   1      8.48 1228.5 510.23
- guardian.y    1      9.23 1229.3 510.47
+ freetime.x    1      1.58 1218.5 511.09
+ freetime.y    1      1.51 1218.5 511.11
+ G3.y          1      1.45 1218.6 511.13
- famsup.x      1     11.50 1231.5 511.17
+ Dalc.y        1      1.04 1219.0 511.26
+ Pstatus       1      1.03 1219.0 511.26
+ Dalc.x        1      1.00 1219.0 511.27
+ internet      1      0.95 1219.1 511.29
- famsup.y      1     11.94 1232.0 511.31
+ higher.x      1      0.76 1219.3 511.35
+ higher.y      1      0.63 1219.4 511.39
+ Medu          1      0.46 1219.6 511.44
+ famsize       1      0.39 1219.7 511.46
+ famrel.y      1      0.24 1219.8 511.51
+ goout.y       1      0.24 1219.8 511.51
+ health.y      1      0.24 1219.8 511.51
+ paid.y        1      0.14 1219.9 511.54
+ G1.y          1      0.01 1220.0 511.58
+ paid.x        1      0.00 1220.0 511.58
+ reason        3     11.72 1208.3 511.90
- absences.y    1     17.45 1237.5 513.01
+ Fjob          4     13.24 1206.8 513.42
- traveltime.y  1     19.62 1239.7 513.68
- traveltime.x  1     19.70 1239.7 513.71
- G1.x          1     21.46 1241.5 514.25
- age           1     26.30 1246.3 515.73
- G2.y          1     26.50 1246.5 515.79
+ Mjob          4      3.30 1216.7 516.55
- famrel.x      1     39.93 1260.0 519.89
- absences.x    1     58.44 1278.5 525.46
- G2.x          1   1032.99 2253.0 741.90

Step:  AIC=508.5
G3.x ~ school + sex + age + address + Fedu + nursery + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    activities.x + romantic.x + famrel.x + goout.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + activities.y + 
    absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- address       1      2.62 1225.6 507.32
- nursery       1      2.82 1225.8 507.38
- Walc.x        1      3.09 1226.1 507.47
- school        1      3.88 1226.8 507.71
- Fedu          1      3.91 1226.9 507.72
- failures.x    1      4.04 1227.0 507.76
- romantic.x    1      4.08 1227.0 507.77
- sex           1      4.44 1227.4 507.89
- goout.x       1      4.46 1227.4 507.89
- activities.y  1      4.81 1227.8 508.00
- failures.y    1      5.48 1228.5 508.21
- schoolsup.y   1      5.63 1228.6 508.26
- activities.x  1      5.77 1228.7 508.30
- health.x      1      6.41 1229.4 508.50
<none>                      1223.0 508.50
- schoolsup.x   1      7.08 1230.0 508.71
- studytime.x   1      7.51 1230.5 508.84
- studytime.y   1      8.04 1231.0 509.00
+ health.y      1      3.01 1220.0 509.56
+ romantic.y    1      2.93 1220.0 509.59
- guardian.x    1     10.26 1233.2 509.69
- famsup.x      1     10.86 1233.8 509.88
+ freetime.y    1      1.79 1221.2 509.94
+ G3.y          1      1.72 1221.2 509.96
- famsup.y      1     11.28 1234.2 510.01
+ freetime.x    1      1.42 1221.5 510.06
+ Dalc.x        1      1.17 1221.8 510.13
+ Pstatus       1      1.03 1221.9 510.18
+ internet      1      0.99 1222.0 510.19
+ higher.x      1      0.89 1222.1 510.22
+ Dalc.y        1      0.87 1222.1 510.23
- guardian.y    1     12.04 1235.0 510.24
+ higher.y      1      0.58 1222.4 510.32
+ goout.y       1      0.41 1222.5 510.37
+ Medu          1      0.41 1222.6 510.37
+ famsize       1      0.34 1222.6 510.40
+ paid.y        1      0.13 1222.8 510.46
+ G1.y          1      0.01 1223.0 510.50
+ famrel.y      1      0.00 1223.0 510.50
+ paid.x        1      0.00 1223.0 510.50
+ reason        3     11.56 1211.4 510.87
- traveltime.y  1     18.22 1241.2 512.15
- traveltime.x  1     18.37 1241.3 512.19
+ Fjob          4     13.21 1209.8 512.35
- absences.y    1     19.62 1242.6 512.58
- G1.x          1     21.46 1244.4 513.15
- G2.y          1     26.11 1249.1 514.57
- age           1     26.27 1249.2 514.62
+ Mjob          4      3.40 1219.6 515.44
- famrel.x      1     38.43 1261.4 518.32
- absences.x    1     61.71 1284.7 525.31
- G2.x          1   1030.30 2253.3 739.94

Step:  AIC=507.32
G3.x ~ school + sex + age + Fedu + nursery + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + activities.x + 
    romantic.x + famrel.x + goout.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- nursery       1      3.22 1228.8 506.32
- goout.x       1      3.48 1229.1 506.40
- Walc.x        1      3.74 1229.3 506.48
- Fedu          1      3.75 1229.3 506.49
- failures.x    1      3.84 1229.4 506.51
- sex           1      4.25 1229.8 506.64
- romantic.x    1      4.47 1230.1 506.71
- failures.y    1      5.10 1230.7 506.90
- activities.y  1      5.13 1230.7 506.91
- school        1      5.28 1230.9 506.96
- schoolsup.y   1      5.65 1231.2 507.08
- activities.x  1      6.07 1231.7 507.21
- health.x      1      6.38 1232.0 507.30
<none>                      1225.6 507.32
- schoolsup.x   1      7.11 1232.7 507.53
- studytime.x   1      7.77 1233.4 507.73
- studytime.y   1      8.26 1233.8 507.88
+ health.y      1      2.73 1222.8 508.47
+ address       1      2.62 1223.0 508.50
+ romantic.y    1      2.48 1223.1 508.54
- guardian.x    1     10.45 1236.0 508.56
- famsup.x      1     11.05 1236.6 508.75
+ freetime.y    1      1.72 1223.9 508.78
+ internet      1      1.64 1224.0 508.81
+ G3.y          1      1.43 1224.2 508.87
+ freetime.x    1      1.40 1224.2 508.88
- famsup.y      1     11.49 1237.1 508.88
+ Dalc.x        1      1.13 1224.5 508.97
+ Pstatus       1      0.97 1224.6 509.01
+ higher.x      1      0.88 1224.7 509.05
+ Dalc.y        1      0.86 1224.7 509.05
+ higher.y      1      0.57 1225.0 509.14
+ goout.y       1      0.49 1225.1 509.16
- guardian.y    1     12.42 1238.0 509.17
+ Medu          1      0.27 1225.3 509.24
+ famsize       1      0.21 1225.4 509.25
+ reason        3     12.94 1212.7 509.26
+ paid.y        1      0.05 1225.5 509.30
+ famrel.y      1      0.01 1225.6 509.32
+ paid.x        1      0.00 1225.6 509.32
+ G1.y          1      0.00 1225.6 509.32
+ Fjob          4     13.46 1212.1 511.10
- traveltime.y  1     19.12 1244.7 511.23
- absences.y    1     19.63 1245.2 511.39
- traveltime.x  1     19.85 1245.4 511.46
- G1.x          1     23.21 1248.8 512.49
- G2.y          1     24.15 1249.7 512.77
- age           1     24.93 1250.5 513.01
+ Mjob          4      3.29 1222.3 514.29
- famrel.x      1     38.72 1264.3 517.20
- absences.x    1     62.02 1287.6 524.18
- G2.x          1   1028.03 2253.6 738.00

Step:  AIC=506.32
G3.x ~ school + sex + age + Fedu + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + activities.x + 
    romantic.x + famrel.x + goout.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- goout.x       1      3.28 1232.1 505.34
- sex           1      3.97 1232.8 505.55
- failures.x    1      4.14 1233.0 505.60
- Walc.x        1      4.69 1233.5 505.77
- Fedu          1      4.71 1233.5 505.78
- romantic.x    1      4.73 1233.5 505.79
- activities.y  1      5.21 1234.0 505.94
- failures.y    1      5.23 1234.0 505.94
- schoolsup.y   1      5.65 1234.5 506.07
- school        1      5.87 1234.7 506.14
- activities.x  1      6.15 1235.0 506.23
<none>                      1228.8 506.32
- health.x      1      6.66 1235.5 506.38
- schoolsup.x   1      7.07 1235.9 506.51
- studytime.x   1      7.84 1236.6 506.75
- studytime.y   1      8.35 1237.2 506.91
+ nursery       1      3.22 1225.6 507.32
+ address       1      3.01 1225.8 507.38
+ health.y      1      2.51 1226.3 507.54
- guardian.x    1     10.64 1239.4 507.61
+ romantic.y    1      2.25 1226.5 507.62
- famsup.x      1     11.09 1239.9 507.75
+ freetime.y    1      1.63 1227.2 507.81
+ G3.y          1      1.43 1227.4 507.88
+ internet      1      1.42 1227.4 507.88
- famsup.y      1     11.52 1240.3 507.88
+ freetime.x    1      1.34 1227.5 507.90
+ Dalc.x        1      1.05 1227.8 507.99
+ higher.x      1      0.87 1227.9 508.05
+ Dalc.y        1      0.80 1228.0 508.07
+ Pstatus       1      0.80 1228.0 508.07
+ higher.y      1      0.57 1228.2 508.14
+ goout.y       1      0.48 1228.3 508.17
- guardian.y    1     12.54 1241.3 508.20
+ reason        3     12.93 1215.9 508.28
+ Medu          1      0.12 1228.7 508.28
+ paid.y        1      0.06 1228.7 508.30
+ famsize       1      0.05 1228.8 508.30
+ paid.x        1      0.05 1228.8 508.30
+ famrel.y      1      0.01 1228.8 508.32
+ G1.y          1      0.00 1228.8 508.32
+ Fjob          4     13.52 1215.3 510.09
- absences.y    1     19.67 1248.5 510.39
- traveltime.y  1     19.88 1248.7 510.45
- traveltime.x  1     20.54 1249.3 510.65
- G1.x          1     22.59 1251.4 511.28
- G2.y          1     24.70 1253.5 511.92
- age           1     25.85 1254.7 512.27
+ Mjob          4      3.85 1225.0 513.12
- famrel.x      1     38.86 1267.7 516.21
- absences.x    1     61.29 1290.1 522.91
- G2.x          1   1026.84 2255.6 736.34

Step:  AIC=505.34
G3.x ~ school + sex + age + Fedu + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + activities.x + 
    romantic.x + famrel.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- sex           1      3.68 1235.8 504.48
- failures.x    1      3.72 1235.8 504.49
- Fedu          1      4.14 1236.2 504.62
- failures.y    1      4.93 1237.0 504.86
- romantic.x    1      4.95 1237.0 504.87
- school        1      5.37 1237.5 505.00
- health.x      1      5.93 1238.0 505.17
- activities.y  1      6.25 1238.3 505.27
- schoolsup.y   1      6.34 1238.4 505.30
<none>                      1232.1 505.34
- activities.x  1      7.24 1239.3 505.58
- schoolsup.x   1      7.85 1239.9 505.76
- studytime.x   1      9.04 1241.1 506.13
- studytime.y   1      9.57 1241.7 506.29
+ goout.x       1      3.28 1228.8 506.32
+ nursery       1      3.02 1229.1 506.40
+ health.y      1      2.99 1229.1 506.41
+ freetime.y    1      2.95 1229.1 506.42
- Walc.x        1     10.23 1242.3 506.50
+ freetime.x    1      2.59 1229.5 506.53
+ goout.y       1      2.52 1229.6 506.55
+ romantic.y    1      2.40 1229.7 506.59
+ address       1      1.96 1230.1 506.73
+ G3.y          1      1.35 1230.7 506.92
- guardian.x    1     11.75 1243.8 506.96
+ internet      1      1.05 1231.0 507.01
+ Dalc.x        1      1.05 1231.0 507.01
+ higher.x      1      0.88 1231.2 507.06
+ Dalc.y        1      0.81 1231.3 507.09
+ Pstatus       1      0.81 1231.3 507.09
+ higher.y      1      0.52 1231.6 507.17
- famsup.x      1     12.47 1244.5 507.18
+ Medu          1      0.25 1231.8 507.26
+ famrel.y      1      0.09 1232.0 507.31
+ paid.x        1      0.08 1232.0 507.31
+ paid.y        1      0.07 1232.0 507.32
+ famsize       1      0.05 1232.0 507.32
- famsup.y      1     12.92 1245.0 507.32
+ G1.y          1      0.03 1232.0 507.33
+ reason        3     12.47 1219.6 507.45
- guardian.y    1     13.91 1246.0 507.63
+ Fjob          4     14.28 1217.8 508.89
- absences.y    1     18.90 1251.0 509.15
- traveltime.y  1     20.23 1252.3 509.56
- traveltime.x  1     20.83 1252.9 509.74
- G1.x          1     23.20 1255.3 510.46
- G2.y          1     24.21 1256.3 510.77
- age           1     24.28 1256.4 510.79
+ Mjob          4      4.08 1228.0 512.07
- famrel.x      1     42.89 1275.0 516.41
- absences.x    1     59.70 1291.8 521.41
- G2.x          1   1024.11 2256.2 734.44

Step:  AIC=504.48
G3.x ~ school + age + Fedu + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + activities.x + romantic.x + 
    famrel.x + Walc.x + health.x + absences.x + G1.x + G2.x + 
    guardian.y + traveltime.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- failures.x    1      3.64 1239.4 503.60
- Fedu          1      3.78 1239.5 503.64
- school        1      4.45 1240.2 503.85
- failures.y    1      5.05 1240.8 504.03
- romantic.x    1      5.49 1241.3 504.17
- schoolsup.y   1      6.21 1242.0 504.39
- activities.y  1      6.34 1242.1 504.43
<none>                      1235.8 504.48
- health.x      1      6.53 1242.3 504.49
- activities.x  1      7.25 1243.0 504.71
- schoolsup.x   1      7.58 1243.3 504.81
- studytime.x   1      8.72 1244.5 505.16
+ freetime.y    1      3.72 1232.0 505.33
+ sex           1      3.68 1232.1 505.34
- studytime.y   1      9.35 1245.1 505.36
+ freetime.x    1      3.34 1232.4 505.44
+ goout.x       1      2.99 1232.8 505.55
+ nursery       1      2.77 1233.0 505.62
+ health.y      1      2.55 1233.2 505.69
+ goout.y       1      2.31 1233.5 505.76
+ romantic.y    1      2.02 1233.7 505.85
+ address       1      1.83 1233.9 505.91
- guardian.x    1     11.65 1247.4 506.06
+ G3.y          1      0.95 1234.8 506.18
+ Pstatus       1      0.93 1234.8 506.19
+ internet      1      0.79 1235.0 506.23
- famsup.x      1     12.26 1248.0 506.25
+ Dalc.x        1      0.69 1235.1 506.26
+ Medu          1      0.61 1235.2 506.29
+ Dalc.y        1      0.52 1235.2 506.32
+ higher.x      1      0.49 1235.3 506.32
- famsup.y      1     12.67 1248.4 506.37
+ higher.y      1      0.25 1235.5 506.40
+ paid.x        1      0.19 1235.6 506.42
+ famsize       1      0.14 1235.6 506.43
+ famrel.y      1      0.09 1235.7 506.45
- Walc.x        1     12.93 1248.7 506.45
+ paid.y        1      0.01 1235.8 506.47
+ G1.y          1      0.00 1235.8 506.48
- guardian.y    1     13.76 1249.5 506.70
+ reason        3     10.74 1225.0 507.14
+ Fjob          4     14.81 1221.0 507.87
- absences.y    1     19.12 1254.9 508.34
- G2.y          1     20.85 1256.6 508.87
- traveltime.y  1     20.99 1256.8 508.91
- traveltime.x  1     21.66 1257.4 509.11
- age           1     23.76 1259.5 509.75
- G1.x          1     25.78 1261.5 510.36
+ Mjob          4      3.88 1231.9 511.28
- famrel.x      1     45.24 1281.0 516.21
- absences.x    1     56.92 1292.7 519.68
- G2.x          1   1039.47 2275.2 735.65

Step:  AIC=503.6
G3.x ~ school + age + Fedu + guardian.x + traveltime.x + studytime.x + 
    schoolsup.x + famsup.x + activities.x + romantic.x + famrel.x + 
    Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- failures.y    1      2.49 1241.9 502.36
- Fedu          1      3.03 1242.4 502.53
- school        1      5.07 1244.5 503.16
- romantic.x    1      6.15 1245.5 503.49
- health.x      1      6.42 1245.8 503.57
- schoolsup.y   1      6.49 1245.9 503.59
<none>                      1239.4 503.60
- activities.y  1      6.76 1246.2 503.68
- activities.x  1      7.70 1247.1 503.97
- schoolsup.x   1      7.93 1247.3 504.04
- studytime.x   1      9.21 1248.6 504.43
+ failures.x    1      3.64 1235.8 504.48
+ sex           1      3.60 1235.8 504.49
+ freetime.y    1      3.37 1236.0 504.56
- studytime.y   1      9.82 1249.2 504.61
+ health.y      1      3.07 1236.3 504.65
+ nursery       1      3.05 1236.3 504.66
+ freetime.x    1      2.96 1236.4 504.69
+ goout.x       1      2.60 1236.8 504.80
+ romantic.y    1      2.49 1236.9 504.83
+ goout.y       1      1.93 1237.5 505.00
+ address       1      1.73 1237.7 505.07
- guardian.x    1     11.57 1251.0 505.15
+ G3.y          1      1.23 1238.2 505.22
+ internet      1      1.15 1238.2 505.24
+ higher.x      1      1.13 1238.3 505.25
+ Pstatus       1      0.76 1238.6 505.37
+ higher.y      1      0.73 1238.7 505.37
+ Dalc.x        1      0.67 1238.7 505.39
+ Medu          1      0.62 1238.8 505.41
+ Dalc.y        1      0.48 1238.9 505.45
- Walc.x        1     12.67 1252.1 505.49
- famsup.x      1     12.88 1252.3 505.55
+ famsize       1      0.12 1239.3 505.56
+ famrel.y      1      0.08 1239.3 505.58
+ paid.x        1      0.07 1239.3 505.58
+ G1.y          1      0.02 1239.4 505.59
+ paid.y        1      0.00 1239.4 505.60
- famsup.y      1     13.32 1252.7 505.68
- guardian.y    1     13.80 1253.2 505.83
+ reason        3     11.03 1228.4 506.18
+ Fjob          4     16.34 1223.1 506.53
- traveltime.y  1     19.96 1259.4 507.70
- traveltime.x  1     20.57 1260.0 507.89
- G2.y          1     20.70 1260.1 507.93
- absences.y    1     21.37 1260.8 508.13
- age           1     23.31 1262.7 508.72
- G1.x          1     28.49 1267.9 510.28
+ Mjob          4      3.74 1235.7 510.44
- famrel.x      1     47.17 1286.6 515.87
- absences.x    1     59.34 1298.7 519.46
- G2.x          1   1056.01 2295.4 737.02

Step:  AIC=502.36
G3.x ~ school + age + Fedu + guardian.x + traveltime.x + studytime.x + 
    schoolsup.x + famsup.x + activities.x + romantic.x + famrel.x + 
    Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + schoolsup.y + famsup.y + activities.y + 
    absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- Fedu          1      4.21 1246.1 501.66
- school        1      4.58 1246.5 501.77
- schoolsup.y   1      6.51 1248.4 502.36
<none>                      1241.9 502.36
- romantic.x    1      6.74 1248.6 502.43
- health.x      1      6.82 1248.7 502.46
- activities.y  1      7.18 1249.1 502.57
- schoolsup.x   1      8.03 1249.9 502.83
- activities.x  1      8.13 1250.0 502.86
+ sex           1      3.72 1238.2 503.22
+ health.y      1      3.65 1238.2 503.24
+ freetime.y    1      3.53 1238.3 503.28
- studytime.x   1      9.57 1251.5 503.30
+ romantic.y    1      3.12 1238.8 503.40
+ freetime.x    1      3.04 1238.8 503.43
+ nursery       1      3.03 1238.8 503.43
- studytime.y   1     10.26 1252.1 503.51
+ goout.x       1      2.53 1239.4 503.59
+ failures.y    1      2.49 1239.4 503.60
+ goout.y       1      1.87 1240.0 503.79
+ address       1      1.56 1240.3 503.89
- guardian.x    1     11.51 1253.4 503.89
+ internet      1      1.45 1240.4 503.92
+ failures.x    1      1.08 1240.8 504.03
+ Pstatus       1      0.71 1241.2 504.15
+ G3.y          1      0.64 1241.2 504.17
+ higher.x      1      0.63 1241.2 504.17
+ Dalc.x        1      0.60 1241.3 504.18
+ Medu          1      0.51 1241.4 504.21
+ Dalc.y        1      0.39 1241.5 504.24
+ higher.y      1      0.34 1241.5 504.26
+ paid.x        1      0.22 1241.7 504.30
+ famsize       1      0.07 1241.8 504.34
+ famrel.y      1      0.04 1241.8 504.35
+ G1.y          1      0.03 1241.8 504.35
+ paid.y        1      0.03 1241.8 504.35
- Walc.x        1     13.41 1255.3 504.47
- famsup.x      1     13.43 1255.3 504.47
- guardian.y    1     13.78 1255.7 504.58
- famsup.y      1     13.92 1255.8 504.62
+ reason        3     10.73 1231.2 505.05
+ Fjob          4     16.63 1225.3 505.22
- traveltime.y  1     18.27 1260.2 505.94
- G2.y          1     18.35 1260.2 505.97
- traveltime.x  1     18.85 1260.7 506.12
- absences.y    1     20.50 1262.4 506.62
- age           1     20.86 1262.8 506.73
+ Mjob          4      3.80 1238.1 509.19
- G1.x          1     29.68 1271.6 509.39
- famrel.x      1     46.53 1288.4 514.42
- absences.x    1     57.65 1299.5 517.70
- G2.x          1   1063.51 2305.4 736.68

Step:  AIC=501.66
G3.x ~ school + age + guardian.x + traveltime.x + studytime.x + 
    schoolsup.x + famsup.x + activities.x + romantic.x + famrel.x + 
    Walc.x + health.x + absences.x + G1.x + G2.x + guardian.y + 
    traveltime.y + studytime.y + schoolsup.y + famsup.y + activities.y + 
    absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- school        1      4.15 1250.2 500.93
<none>                      1246.1 501.66
- health.x      1      6.72 1252.8 501.71
- romantic.x    1      7.05 1253.2 501.81
- schoolsup.y   1      7.64 1253.7 501.99
- activities.y  1      8.26 1254.3 502.18
+ Fedu          1      4.21 1241.9 502.36
+ nursery       1      3.92 1242.2 502.45
+ freetime.y    1      3.89 1242.2 502.46
- schoolsup.x   1      9.22 1255.3 502.47
- activities.x  1      9.37 1255.5 502.52
+ failures.y    1      3.66 1242.4 502.53
+ health.y      1      3.60 1242.5 502.55
+ sex           1      3.36 1242.7 502.63
+ freetime.x    1      3.35 1242.7 502.63
+ romantic.y    1      3.19 1242.9 502.68
- studytime.x   1     10.79 1256.9 502.95
+ goout.x       1      2.07 1244.0 503.02
+ internet      1      1.80 1244.3 503.10
- studytime.y   1     11.46 1257.6 503.16
+ address       1      1.52 1244.6 503.19
+ goout.y       1      1.51 1244.6 503.19
- guardian.x    1     12.31 1258.4 503.41
+ Dalc.x        1      0.77 1245.3 503.42
+ G3.y          1      0.66 1245.4 503.46
- Walc.x        1     12.53 1258.6 503.48
+ Dalc.y        1      0.53 1245.6 503.50
+ Medu          1      0.48 1245.6 503.51
+ failures.x    1      0.43 1245.7 503.53
+ Pstatus       1      0.41 1245.7 503.53
+ higher.x      1      0.37 1245.7 503.54
+ paid.x        1      0.29 1245.8 503.57
+ higher.y      1      0.16 1245.9 503.61
+ famsize       1      0.13 1246.0 503.62
+ famrel.y      1      0.02 1246.1 503.65
+ G1.y          1      0.00 1246.1 503.66
+ paid.y        1      0.00 1246.1 503.66
- famsup.x      1     14.82 1260.9 504.17
- guardian.y    1     14.89 1261.0 504.20
- famsup.y      1     15.18 1261.3 504.28
+ Fjob          4     17.29 1228.8 504.32
+ reason        3     10.67 1235.4 504.37
- G2.y          1     17.04 1263.1 504.85
- traveltime.y  1     17.95 1264.0 505.12
- traveltime.x  1     18.91 1265.0 505.41
- age           1     19.61 1265.7 505.62
- absences.y    1     21.27 1267.4 506.12
- G1.x          1     27.11 1273.2 507.88
+ Mjob          4      5.56 1240.5 507.95
- famrel.x      1     46.19 1292.3 513.56
- absences.x    1     56.88 1303.0 516.71
- G2.x          1   1076.92 2323.0 737.59

Step:  AIC=500.93
G3.x ~ age + guardian.x + traveltime.x + studytime.x + schoolsup.x + 
    famsup.x + activities.x + romantic.x + famrel.x + Walc.x + 
    health.x + absences.x + G1.x + G2.x + guardian.y + traveltime.y + 
    studytime.y + schoolsup.y + famsup.y + activities.y + absences.y + 
    G2.y

               Df Sum of Sq    RSS    AIC
- health.x      1      6.15 1256.4 500.80
<none>                      1250.2 500.93
- romantic.x    1      6.62 1256.9 500.95
- schoolsup.y   1      7.55 1257.8 501.23
- activities.y  1      8.07 1258.3 501.38
+ nursery       1      4.48 1245.8 501.55
+ freetime.y    1      4.17 1246.1 501.65
+ school        1      4.15 1246.1 501.66
- schoolsup.x   1      9.07 1259.3 501.69
- activities.x  1      9.21 1259.5 501.73
+ Fedu          1      3.78 1246.5 501.77
+ health.y      1      3.65 1246.6 501.81
+ romantic.y    1      3.55 1246.7 501.84
+ freetime.x    1      3.54 1246.7 501.84
+ failures.y    1      3.02 1247.2 502.00
+ address       1      2.60 1247.6 502.13
+ sex           1      2.51 1247.7 502.16
- studytime.x   1     10.71 1261.0 502.19
+ internet      1      1.91 1248.3 502.34
+ goout.x       1      1.75 1248.5 502.39
- studytime.y   1     11.41 1261.7 502.40
- Walc.x        1     11.47 1261.7 502.42
+ goout.y       1      1.33 1248.9 502.52
- guardian.x    1     12.02 1262.3 502.58
+ higher.x      1      0.81 1249.4 502.68
+ failures.x    1      0.75 1249.5 502.70
+ Dalc.x        1      0.67 1249.6 502.72
+ higher.y      1      0.51 1249.7 502.77
+ Medu          1      0.51 1249.7 502.77
+ Dalc.y        1      0.43 1249.8 502.80
+ Pstatus       1      0.29 1250.0 502.84
+ G3.y          1      0.23 1250.0 502.86
+ paid.x        1      0.17 1250.1 502.87
+ famsize       1      0.12 1250.1 502.89
+ G1.y          1      0.04 1250.2 502.91
+ paid.y        1      0.03 1250.2 502.92
+ famrel.y      1      0.00 1250.2 502.93
- guardian.y    1     14.51 1264.8 503.33
- famsup.x      1     14.79 1265.0 503.42
- famsup.y      1     15.09 1265.3 503.51
- G2.y          1     15.23 1265.5 503.55
+ reason        3     10.87 1239.4 503.59
- age           1     15.80 1266.0 503.72
- traveltime.y  1     16.96 1267.2 504.07
+ Fjob          4     15.49 1234.8 504.16
- traveltime.x  1     18.32 1268.6 504.48
- absences.y    1     22.43 1272.7 505.72
- G1.x          1     27.37 1277.6 507.20
+ Mjob          4      5.49 1244.8 507.25
- famrel.x      1     43.95 1294.2 512.12
- absences.x    1     54.72 1305.0 515.29
- G2.x          1   1084.72 2335.0 737.55

Step:  AIC=500.8
G3.x ~ age + guardian.x + traveltime.x + studytime.x + schoolsup.x + 
    famsup.x + activities.x + romantic.x + famrel.x + Walc.x + 
    absences.x + G1.x + G2.x + guardian.y + traveltime.y + studytime.y + 
    schoolsup.y + famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
- romantic.x    1      6.17 1262.6 500.67
<none>                      1256.4 500.80
+ health.x      1      6.15 1250.2 500.93
- schoolsup.y   1      7.47 1263.9 501.07
- activities.y  1      7.98 1264.4 501.22
+ health.y      1      4.94 1251.5 501.30
+ nursery       1      4.73 1251.7 501.36
+ romantic.y    1      4.48 1251.9 501.44
+ freetime.y    1      4.36 1252.0 501.47
- schoolsup.x   1      8.90 1265.3 501.50
- activities.x  1      9.09 1265.5 501.55
+ Fedu          1      3.72 1252.7 501.67
+ freetime.x    1      3.63 1252.8 501.70
+ school        1      3.57 1252.8 501.71
+ failures.y    1      3.47 1252.9 501.74
+ sex           1      3.06 1253.3 501.87
- studytime.x   1     10.32 1266.7 501.93
+ internet      1      2.61 1253.8 502.00
+ address       1      2.59 1253.8 502.01
- studytime.y   1     11.04 1267.4 502.14
+ goout.x       1      1.24 1255.2 502.42
- guardian.x    1     12.13 1268.5 502.47
+ goout.y       1      0.87 1255.5 502.54
+ higher.x      1      0.73 1255.7 502.58
+ Dalc.x        1      0.72 1255.7 502.58
- Walc.x        1     12.50 1268.9 502.58
- G2.y          1     12.52 1268.9 502.59
+ Medu          1      0.65 1255.7 502.60
+ failures.x    1      0.60 1255.8 502.62
+ Dalc.y        1      0.43 1256.0 502.67
+ higher.y      1      0.42 1256.0 502.67
+ paid.x        1      0.41 1256.0 502.68
+ Pstatus       1      0.24 1256.2 502.73
+ G3.y          1      0.13 1256.3 502.76
+ paid.y        1      0.08 1256.3 502.78
+ famsize       1      0.06 1256.3 502.78
+ G1.y          1      0.03 1256.4 502.79
+ famrel.y      1      0.01 1256.4 502.80
- guardian.y    1     14.51 1270.9 503.19
- famsup.x      1     14.54 1270.9 503.20
- famsup.y      1     14.90 1271.3 503.30
+ Fjob          4     16.86 1239.5 503.64
- traveltime.y  1     16.40 1272.8 503.76
+ reason        3      9.41 1247.0 503.93
- age           1     17.50 1273.9 504.09
- traveltime.x  1     17.66 1274.0 504.13
- absences.y    1     22.93 1279.3 505.71
+ Mjob          4      5.58 1250.8 507.10
- G1.x          1     29.20 1285.6 507.58
- famrel.x      1     48.12 1304.5 513.16
- absences.x    1     54.15 1310.5 514.92
- G2.x          1   1079.27 2335.7 735.66

Step:  AIC=500.67
G3.x ~ age + guardian.x + traveltime.x + studytime.x + schoolsup.x + 
    famsup.x + activities.x + famrel.x + Walc.x + absences.x + 
    G1.x + G2.x + guardian.y + traveltime.y + studytime.y + schoolsup.y + 
    famsup.y + activities.y + absences.y + G2.y

               Df Sum of Sq    RSS    AIC
<none>                      1262.6 500.67
+ romantic.x    1      6.17 1256.4 500.80
- schoolsup.y   1      7.33 1269.9 500.88
+ health.x      1      5.70 1256.9 500.95
- activities.y  1      7.77 1270.3 501.01
+ nursery       1      5.08 1257.5 501.13
- schoolsup.x   1      8.82 1271.4 501.33
+ health.y      1      4.40 1258.2 501.34
- activities.x  1      8.90 1271.5 501.36
+ romantic.y    1      4.34 1258.2 501.36
+ failures.y    1      4.18 1258.4 501.41
+ freetime.y    1      4.16 1258.4 501.41
+ Fedu          1      4.02 1258.5 501.45
+ sex           1      3.60 1259.0 501.58
+ internet      1      3.43 1259.1 501.63
+ freetime.x    1      3.36 1259.2 501.66
+ school        1      3.21 1259.3 501.70
- studytime.x   1     10.16 1272.7 501.73
+ address       1      2.90 1259.7 501.79
- studytime.y   1     10.90 1273.5 501.96
+ goout.x       1      1.37 1261.2 502.26
+ higher.x      1      1.32 1261.2 502.27
+ Dalc.x        1      1.00 1261.6 502.37
+ goout.y       1      0.95 1261.6 502.38
+ higher.y      1      0.86 1261.7 502.41
+ Medu          1      0.83 1261.7 502.42
+ failures.x    1      0.69 1261.9 502.46
- guardian.x    1     12.66 1275.2 502.48
+ Dalc.y        1      0.61 1262.0 502.49
- Walc.x        1     12.79 1275.3 502.52
+ paid.x        1      0.49 1262.1 502.52
- G2.y          1     13.07 1275.6 502.61
+ Pstatus       1      0.11 1262.5 502.64
+ G3.y          1      0.10 1262.5 502.64
+ G1.y          1      0.08 1262.5 502.65
+ paid.y        1      0.07 1262.5 502.65
+ famrel.y      1      0.02 1262.5 502.67
+ famsize       1      0.01 1262.5 502.67
- famsup.x      1     14.59 1277.2 503.06
- famsup.y      1     14.92 1277.5 503.16
- guardian.y    1     15.14 1277.7 503.23
+ Fjob          4     17.68 1244.9 503.29
- traveltime.y  1     16.03 1278.6 503.49
- traveltime.x  1     17.38 1279.9 503.89
+ reason        3      8.92 1253.6 503.96
- age           1     19.18 1281.7 504.43
- absences.y    1     22.02 1284.6 505.28
- G1.x          1     26.47 1289.0 506.60
+ Mjob          4      5.07 1257.5 507.13
- absences.x    1     50.89 1313.5 513.77
- famrel.x      1     51.20 1313.8 513.86
- G2.x          1   1132.45 2395.0 743.25

Call:
lm(formula = G3.x ~ age + guardian.x + traveltime.x + studytime.x + 
    schoolsup.x + famsup.x + activities.x + famrel.x + Walc.x + 
    absences.x + G1.x + G2.x + guardian.y + traveltime.y + studytime.y + 
    schoolsup.y + famsup.y + activities.y + absences.y + G2.y, 
    data = data)

Coefficients:
     (Intercept)               age  guardian.xmother   guardian.xother  
        -1.24333          -0.21277          -3.87959           0.11859  
    traveltime.x       studytime.x    schoolsup.xyes       famsup.xyes  
         2.75836           4.91618           5.87810          -9.70780  
 activities.xyes          famrel.x            Walc.x        absences.x  
        -6.14135           0.40737           0.15800           0.05756  
            G1.x              G2.x  guardian.ymother   guardian.yother  
         0.16538           0.93793           4.24692                NA  
    traveltime.y       studytime.y    schoolsup.yyes       famsup.yyes  
        -2.63578          -5.09303          -5.38131           9.83361  
 activities.yyes        absences.y              G2.y  
         5.74082          -0.05944           0.10228  

#+end_example

#+NAME: a39c612a-511d-42e6-8595-820f65872d86
#+begin_src ein-r :session localhost :results output
stepAIC_x <- stepAIC
#+end_src

#+RESULTS: a39c612a-511d-42e6-8595-820f65872d86

#+NAME: 3ca95e75-8afb-45ad-a06a-f0389c4f996e
#+begin_src ein-r :session localhost :results output :exports both :eval no
  stepAIC(modreg_trein_y, direction="both", keep=NULL)
#+end_src

#+RESULTS: 3ca95e75-8afb-45ad-a06a-f0389c4f996e
#+begin_example
Start:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + freetime.y + goout.y + 
    Dalc.y + Walc.y + health.y + absences.y + G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + freetime.y + goout.y + 
    Dalc.y + Walc.y + absences.y + G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + freetime.y + goout.y + 
    Dalc.y + absences.y + G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + freetime.y + goout.y + 
    absences.y + G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + freetime.y + absences.y + 
    G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + famrel.y + absences.y + G1.y + G2.y


Step:  AIC=233.6
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + Fjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- Fjob          4     6.117 531.30 230.03
- nursery       1     0.000 525.18 231.60
- activities.y  1     0.064 525.25 231.65
- paid.y        1     0.084 525.27 231.66
- activities.x  1     0.084 525.27 231.66
- Fedu          1     0.101 525.29 231.67
- traveltime.y  1     0.160 525.34 231.72
- freetime.x    1     0.250 525.43 231.78
- studytime.x   1     0.253 525.44 231.79
- studytime.y   1     0.259 525.44 231.79
- Walc.x        1     0.296 525.48 231.82
- Dalc.x        1     0.323 525.51 231.84
- traveltime.x  1     0.408 525.59 231.90
- famsup.y      1     0.422 525.61 231.91
- famsup.x      1     0.451 525.64 231.93
- higher.y      1     0.470 525.65 231.94
- romantic.x    1     0.567 525.75 232.01
- schoolsup.y   1     0.588 525.77 232.03
- schoolsup.x   1     0.631 525.82 232.06
- higher.x      1     0.755 525.94 232.15
- address       1     0.868 526.05 232.23
- romantic.y    1     0.871 526.06 232.23
- goout.x       1     0.876 526.06 232.24
- G2.x          1     0.884 526.07 232.24
- guardian.y    1     0.927 526.11 232.28
- guardian.x    1     1.008 526.19 232.33
- G3.x          1     1.412 526.60 232.63
- famrel.x      1     1.568 526.75 232.74
- paid.x        1     1.952 527.14 233.02
- Medu          1     1.989 527.17 233.05
- health.x      1     2.285 527.47 233.26
- G1.x          1     2.373 527.56 233.32
- internet      1     2.512 527.70 233.42
<none>                      525.18 233.60
- famsize       1     2.938 528.12 233.73
- age           1     3.155 528.34 233.89
- failures.x    1     4.175 529.36 234.63
- Pstatus       1     4.266 529.45 234.69
- sex           1     4.634 529.82 234.96
- reason        3    11.412 536.60 235.81
- absences.x    1     6.493 531.68 236.30
- Mjob          4    15.351 540.54 236.61
- absences.y    1     7.288 532.47 236.87
- G1.y          1     7.784 532.97 237.22
- failures.y    1     8.800 533.98 237.95
- school        1    14.117 539.30 241.73
- G2.y          1   230.355 755.54 370.53

Step:  AIC=230.03
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + nursery + internet + guardian.x + 
    traveltime.x + studytime.x + failures.x + schoolsup.x + famsup.x + 
    paid.x + activities.x + higher.x + romantic.x + famrel.x + 
    freetime.x + goout.x + Dalc.x + Walc.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + traveltime.y + studytime.y + 
    failures.y + schoolsup.y + famsup.y + paid.y + activities.y + 
    higher.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- nursery       1     0.014 531.32 228.04
- freetime.x    1     0.058 531.36 228.07
- activities.y  1     0.083 531.38 228.08
- activities.x  1     0.110 531.41 228.10
- paid.y        1     0.122 531.42 228.11
- traveltime.y  1     0.194 531.49 228.16
- studytime.x   1     0.292 531.59 228.24
- studytime.y   1     0.299 531.60 228.24
- Walc.x        1     0.358 531.66 228.28
- Dalc.x        1     0.362 531.66 228.29
- traveltime.x  1     0.423 531.72 228.33
- famsup.y      1     0.471 531.77 228.36
- higher.y      1     0.500 531.80 228.38
- famsup.x      1     0.505 531.81 228.39
- romantic.x    1     0.577 531.88 228.44
- schoolsup.y   1     0.670 531.97 228.51
- Fedu          1     0.687 531.99 228.52
- schoolsup.x   1     0.725 532.03 228.55
- higher.x      1     0.820 532.12 228.61
- address       1     0.835 532.14 228.63
- romantic.y    1     0.883 532.18 228.66
- guardian.y    1     1.001 532.30 228.74
- G2.x          1     1.095 532.40 228.81
- guardian.x    1     1.097 532.40 228.81
- goout.x       1     1.171 532.47 228.87
- famrel.x      1     1.339 532.64 228.99
- G3.x          1     1.495 532.80 229.10
- Medu          1     1.742 533.04 229.28
- paid.x        1     1.913 533.21 229.40
- famsize       1     2.265 533.57 229.65
- G1.x          1     2.620 533.92 229.90
- health.x      1     2.648 533.95 229.92
<none>                      531.30 230.03
- internet      1     3.457 534.76 230.50
- age           1     3.580 534.88 230.59
- Pstatus       1     4.325 535.63 231.12
- failures.x    1     4.554 535.85 231.29
- sex           1     4.976 536.28 231.59
- Mjob          4    14.792 546.09 232.52
- G1.y          1     7.206 538.51 233.17
- absences.x    1     7.318 538.62 233.25
- absences.y    1     7.800 539.10 233.59
+ Fjob          4     6.117 525.18 233.60
- reason        3    13.983 545.28 233.95
- failures.y    1     9.001 540.30 234.44
- school        1    13.653 544.95 237.72
- G2.y          1   233.935 765.24 367.40

Step:  AIC=228.04
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + freetime.x + 
    goout.x + Dalc.x + Walc.x + health.x + absences.x + G1.x + 
    G2.x + G3.x + guardian.y + traveltime.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + paid.y + activities.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- freetime.x    1     0.056 531.37 226.08
- activities.y  1     0.084 531.40 226.10
- activities.x  1     0.110 531.43 226.11
- paid.y        1     0.121 531.44 226.12
- traveltime.y  1     0.191 531.51 226.17
- studytime.x   1     0.294 531.61 226.25
- studytime.y   1     0.301 531.62 226.25
- Walc.x        1     0.348 531.66 226.29
- Dalc.x        1     0.367 531.68 226.30
- traveltime.x  1     0.420 531.74 226.34
- famsup.y      1     0.473 531.79 226.38
- higher.y      1     0.502 531.82 226.40
- famsup.x      1     0.507 531.82 226.40
- romantic.x    1     0.584 531.90 226.45
- schoolsup.y   1     0.671 531.99 226.52
- Fedu          1     0.679 531.99 226.52
- schoolsup.x   1     0.726 532.04 226.56
- higher.x      1     0.822 532.14 226.63
- address       1     0.848 532.16 226.64
- romantic.y    1     0.892 532.21 226.68
- guardian.y    1     1.004 532.32 226.76
- G2.x          1     1.087 532.40 226.82
- guardian.x    1     1.101 532.42 226.83
- goout.x       1     1.166 532.48 226.87
- famrel.x      1     1.343 532.66 227.00
- G3.x          1     1.484 532.80 227.10
- Medu          1     1.730 533.05 227.28
- paid.x        1     1.898 533.21 227.40
- famsize       1     2.255 533.57 227.65
- G1.x          1     2.654 533.97 227.94
- health.x      1     2.659 533.98 227.94
<none>                      531.32 228.04
- internet      1     3.444 534.76 228.50
- age           1     3.603 534.92 228.62
- Pstatus       1     4.346 535.66 229.15
- failures.x    1     4.539 535.86 229.29
- sex           1     4.968 536.28 229.59
+ nursery       1     0.014 531.30 230.03
- Mjob          4    14.910 546.23 230.61
- G1.y          1     7.192 538.51 231.17
- absences.x    1     7.310 538.63 231.26
+ Fjob          4     6.131 525.18 231.60
- absences.y    1     7.825 539.14 231.62
- reason        3    13.980 545.30 231.96
- failures.y    1     9.016 540.33 232.46
- school        1    13.750 545.07 235.80
- G2.y          1   233.963 765.28 365.42

Step:  AIC=226.08
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + G3.x + 
    guardian.y + traveltime.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + paid.y + activities.y + higher.y + romantic.y + 
    absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- activities.y  1     0.075 531.45 224.13
- activities.x  1     0.100 531.47 224.15
- paid.y        1     0.116 531.49 224.16
- traveltime.y  1     0.179 531.55 224.20
- studytime.x   1     0.279 531.65 224.28
- studytime.y   1     0.287 531.66 224.28
- Walc.x        1     0.373 531.75 224.34
- traveltime.x  1     0.406 531.78 224.37
- Dalc.x        1     0.416 531.79 224.37
- famsup.y      1     0.454 531.83 224.40
- higher.y      1     0.485 531.86 224.42
- famsup.x      1     0.487 531.86 224.43
- romantic.x    1     0.609 531.98 224.51
- schoolsup.y   1     0.654 532.03 224.55
- Fedu          1     0.657 532.03 224.55
- schoolsup.x   1     0.708 532.08 224.58
- higher.x      1     0.799 532.17 224.65
- address       1     0.842 532.21 224.68
- romantic.y    1     0.921 532.29 224.74
- guardian.y    1     0.981 532.35 224.78
- G2.x          1     1.069 532.44 224.84
- guardian.x    1     1.077 532.45 224.85
- famrel.x      1     1.297 532.67 225.01
- goout.x       1     1.398 532.77 225.08
- G3.x          1     1.465 532.84 225.13
- Medu          1     1.719 533.09 225.31
- paid.x        1     1.867 533.24 225.42
- famsize       1     2.265 533.64 225.70
- G1.x          1     2.616 533.99 225.95
- health.x      1     2.678 534.05 226.00
<none>                      531.37 226.08
- internet      1     3.420 534.79 226.53
- age           1     3.668 535.04 226.70
- Pstatus       1     4.398 535.77 227.22
- failures.x    1     4.608 535.98 227.37
- sex           1     5.135 536.51 227.75
+ freetime.y    1     0.056 531.32 228.04
+ freetime.x    1     0.056 531.32 228.04
+ nursery       1     0.013 531.36 228.07
- Mjob          4    14.890 546.26 228.63
- G1.y          1     7.230 538.60 229.24
- absences.x    1     7.272 538.64 229.27
- absences.y    1     7.829 539.20 229.66
+ Fjob          4     5.937 525.44 229.78
- reason        3    14.068 545.44 230.06
- failures.y    1     9.016 540.39 230.50
- school        1    13.908 545.28 233.95
- G2.y          1   234.011 765.38 363.47

Step:  AIC=224.13
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + G3.x + 
    guardian.y + traveltime.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + paid.y + higher.y + romantic.y + absences.y + 
    G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- paid.y        1     0.092 531.54 222.20
- traveltime.y  1     0.129 531.58 222.22
- traveltime.x  1     0.340 531.79 222.37
- Walc.x        1     0.390 531.84 222.41
- Dalc.x        1     0.424 531.87 222.43
- Fedu          1     0.647 532.09 222.59
- higher.y      1     0.791 532.24 222.70
- address       1     0.831 532.28 222.73
- romantic.x    1     1.011 532.46 222.86
- G2.x          1     1.072 532.52 222.90
- goout.x       1     1.368 532.82 223.11
- famrel.x      1     1.403 532.85 223.14
- romantic.y    1     1.448 532.90 223.17
- G3.x          1     1.453 532.90 223.17
- studytime.x   1     1.586 533.03 223.27
- higher.x      1     1.615 533.06 223.29
- studytime.y   1     1.670 533.12 223.33
- Medu          1     1.728 533.18 223.37
- paid.x        1     1.890 533.34 223.49
- famsize       1     2.287 533.73 223.77
- activities.x  1     2.550 534.00 223.96
- G1.x          1     2.623 534.07 224.01
- health.x      1     2.683 534.13 224.05
<none>                      531.45 224.13
- schoolsup.y   1     3.093 534.54 224.35
- internet      1     3.487 534.93 224.63
- schoolsup.x   1     3.523 534.97 224.65
- age           1     3.705 535.15 224.78
- famsup.y      1     3.796 535.24 224.85
- guardian.y    1     3.978 535.43 224.98
- famsup.x      1     4.228 535.68 225.16
- Pstatus       1     4.390 535.84 225.27
- guardian.x    1     4.474 535.92 225.33
- failures.x    1     4.611 536.06 225.43
- sex           1     5.187 536.63 225.84
+ famrel.y      1     0.075 531.37 226.08
+ goout.y       1     0.075 531.37 226.08
+ activities.y  1     0.075 531.37 226.08
+ Dalc.y        1     0.075 531.37 226.08
+ Walc.y        1     0.075 531.37 226.08
+ freetime.y    1     0.060 531.39 226.09
+ freetime.x    1     0.048 531.40 226.10
+ nursery       1     0.014 531.43 226.12
- Mjob          4    14.975 546.42 226.75
- absences.x    1     7.252 538.70 227.31
- G1.y          1     7.336 538.78 227.37
- absences.y    1     7.760 539.21 227.67
+ Fjob          4     5.965 525.48 227.82
- reason        3    14.052 545.50 228.10
- failures.y    1     9.135 540.58 228.64
- school        1    14.171 545.62 232.18
- G2.y          1   233.936 765.38 361.47

Step:  AIC=222.2
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + G3.x + 
    guardian.y + traveltime.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + higher.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- traveltime.y  1     0.136 531.68 220.29
- traveltime.x  1     0.353 531.89 220.45
- Walc.x        1     0.406 531.95 220.49
- Dalc.x        1     0.456 532.00 220.52
- Fedu          1     0.674 532.21 220.68
- higher.y      1     0.809 532.35 220.78
- address       1     0.897 532.44 220.84
- romantic.x    1     0.983 532.52 220.90
- G2.x          1     1.093 532.63 220.98
- famrel.x      1     1.351 532.89 221.17
- goout.x       1     1.362 532.90 221.17
- romantic.y    1     1.415 532.95 221.21
- G3.x          1     1.455 532.99 221.24
- higher.x      1     1.639 533.18 221.37
- studytime.x   1     1.684 533.22 221.40
- studytime.y   1     1.767 533.31 221.46
- Medu          1     1.832 533.37 221.51
- paid.x        1     1.948 533.49 221.59
- famsize       1     2.294 533.83 221.84
- activities.x  1     2.489 534.03 221.98
- G1.x          1     2.700 534.24 222.13
- health.x      1     2.719 534.26 222.15
<none>                      531.54 222.20
- schoolsup.y   1     3.150 534.69 222.45
- internet      1     3.452 534.99 222.67
- schoolsup.x   1     3.585 535.12 222.76
- famsup.y      1     3.857 535.40 222.96
- age           1     3.868 535.41 222.97
- guardian.y    1     3.932 535.47 223.01
- famsup.x      1     4.282 535.82 223.26
- Pstatus       1     4.369 535.91 223.32
- guardian.x    1     4.418 535.96 223.36
- failures.x    1     4.594 536.13 223.48
- sex           1     5.379 536.92 224.04
+ paid.y        1     0.092 531.45 224.13
+ freetime.y    1     0.054 531.48 224.16
+ activities.y  1     0.052 531.49 224.16
+ famrel.y      1     0.052 531.49 224.16
+ goout.y       1     0.052 531.49 224.16
+ Dalc.y        1     0.052 531.49 224.16
+ Walc.y        1     0.052 531.49 224.16
+ freetime.x    1     0.044 531.49 224.16
+ nursery       1     0.013 531.53 224.19
- Mjob          4    14.951 546.49 224.79
- absences.x    1     7.344 538.88 225.44
- G1.y          1     7.366 538.91 225.45
- absences.y    1     7.939 539.48 225.86
+ Fjob          4     5.996 525.54 225.86
- reason        3    13.967 545.51 226.10
- failures.y    1     9.590 541.13 227.03
- school        1    14.512 546.05 230.49
- G2.y          1   233.990 765.53 359.55

Step:  AIC=220.29
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    Dalc.x + Walc.x + health.x + absences.x + G1.x + G2.x + G3.x + 
    guardian.y + studytime.y + failures.y + schoolsup.y + famsup.y + 
    higher.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- Walc.x        1     0.418 532.09 218.59
- Dalc.x        1     0.477 532.15 218.64
- Fedu          1     0.682 532.36 218.78
- higher.y      1     0.683 532.36 218.78
- address       1     0.860 532.53 218.91
- romantic.x    1     0.930 532.61 218.96
- G2.x          1     1.146 532.82 219.12
- goout.x       1     1.315 532.99 219.24
- romantic.y    1     1.353 533.03 219.26
- famrel.x      1     1.392 533.07 219.29
- higher.x      1     1.505 533.18 219.37
- studytime.x   1     1.579 533.25 219.43
- G3.x          1     1.607 533.28 219.45
- studytime.y   1     1.668 533.34 219.49
- Medu          1     1.807 533.48 219.59
- paid.x        1     1.962 533.64 219.70
- famsize       1     2.278 533.95 219.93
- activities.x  1     2.432 534.11 220.04
- G1.x          1     2.696 534.37 220.23
- health.x      1     2.720 534.40 220.24
<none>                      531.68 220.29
- schoolsup.y   1     3.096 534.77 220.51
- internet      1     3.519 535.19 220.81
- schoolsup.x   1     3.567 535.24 220.85
- traveltime.x  1     3.733 535.41 220.97
- guardian.y    1     3.879 535.55 221.07
- age           1     3.889 535.56 221.08
- famsup.y      1     4.153 535.83 221.27
- guardian.x    1     4.355 536.03 221.41
- Pstatus       1     4.358 536.03 221.41
- failures.x    1     4.566 536.24 221.56
- famsup.x      1     4.638 536.31 221.61
- sex           1     5.347 537.02 222.12
+ famrel.y      1     0.171 531.50 222.17
+ goout.y       1     0.140 531.53 222.19
+ health.y      1     0.136 531.54 222.20
+ traveltime.y  1     0.136 531.54 222.20
+ paid.y        1     0.098 531.58 222.22
+ freetime.y    1     0.063 531.61 222.25
+ freetime.x    1     0.038 531.64 222.27
+ Walc.y        1     0.032 531.64 222.27
+ activities.y  1     0.012 531.66 222.28
+ Dalc.y        1     0.012 531.66 222.28
+ nursery       1     0.011 531.66 222.29
- Mjob          4    15.005 546.68 222.93
- absences.x    1     7.256 538.93 223.47
- G1.y          1     7.396 539.07 223.57
- absences.y    1     7.859 539.53 223.90
+ Fjob          4     6.025 525.65 223.94
- reason        3    13.946 545.62 224.18
- failures.y    1     9.993 541.67 225.41
- school        1    14.800 546.47 228.78
- G2.y          1   233.866 765.54 357.55

Step:  AIC=218.59
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    Dalc.x + health.x + absences.x + G1.x + G2.x + G3.x + guardian.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- Dalc.x        1     0.163 532.26 216.71
- Fedu          1     0.613 532.71 217.03
- higher.y      1     0.636 532.73 217.05
- address       1     0.787 532.88 217.16
- romantic.x    1     0.937 533.03 217.27
- goout.x       1     0.969 533.06 217.29
- G2.x          1     1.142 533.23 217.41
- famrel.x      1     1.211 533.30 217.46
- romantic.y    1     1.360 533.45 217.57
- higher.x      1     1.445 533.54 217.63
- studytime.x   1     1.487 533.58 217.66
- studytime.y   1     1.554 533.65 217.71
- G3.x          1     1.732 533.82 217.84
- paid.x        1     1.796 533.89 217.88
- Medu          1     2.046 534.14 218.06
- famsize       1     2.244 534.34 218.20
- activities.x  1     2.376 534.47 218.30
- G1.x          1     2.499 534.59 218.38
- health.x      1     2.606 534.70 218.46
<none>                      532.09 218.59
- schoolsup.y   1     3.150 535.24 218.85
- internet      1     3.487 535.58 219.09
- schoolsup.x   1     3.686 535.78 219.23
- guardian.y    1     3.775 535.87 219.29
- traveltime.x  1     3.850 535.94 219.35
- famsup.y      1     3.930 536.02 219.41
- age           1     3.974 536.07 219.44
- Pstatus       1     4.221 536.31 219.61
- guardian.x    1     4.236 536.33 219.62
- famsup.x      1     4.387 536.48 219.73
- failures.x    1     4.530 536.62 219.83
- sex           1     5.065 537.16 220.21
+ Walc.x        1     0.418 531.68 220.29
+ Walc.y        1     0.382 531.71 220.32
+ famrel.y      1     0.196 531.90 220.45
+ goout.y       1     0.164 531.93 220.48
+ traveltime.y  1     0.147 531.95 220.49
+ health.y      1     0.147 531.95 220.49
+ paid.y        1     0.116 531.98 220.51
+ freetime.y    1     0.091 532.00 220.53
+ freetime.x    1     0.058 532.04 220.55
+ activities.y  1     0.017 532.08 220.58
+ Dalc.y        1     0.017 532.08 220.58
+ nursery       1     0.002 532.09 220.59
- absences.x    1     6.912 539.00 221.52
- Mjob          4    15.594 547.69 221.63
- G1.y          1     7.367 539.46 221.85
- absences.y    1     7.805 539.90 222.16
+ Fjob          4     6.061 526.03 222.22
- reason        3    13.971 546.06 222.49
- failures.y    1     9.894 541.99 223.63
- school        1    15.183 547.28 227.34
- G2.y          1   234.699 766.79 356.18

Step:  AIC=216.71
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Fedu + Mjob + reason + internet + guardian.x + traveltime.x + 
    studytime.x + failures.x + schoolsup.x + famsup.x + paid.x + 
    activities.x + higher.x + romantic.x + famrel.x + goout.x + 
    health.x + absences.x + G1.x + G2.x + G3.x + guardian.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + higher.y + 
    romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- Fedu          1     0.611 532.87 215.15
- higher.y      1     0.675 532.93 215.20
- address       1     0.858 533.11 215.33
- romantic.x    1     0.980 533.24 215.41
- G2.x          1     1.201 533.46 215.57
- goout.x       1     1.263 533.52 215.62
- famrel.x      1     1.338 533.59 215.67
- romantic.y    1     1.404 533.66 215.72
- studytime.x   1     1.465 533.72 215.76
- higher.x      1     1.481 533.74 215.77
- studytime.y   1     1.538 533.79 215.81
- G3.x          1     1.740 534.00 215.96
- paid.x        1     1.942 534.20 216.10
- Medu          1     2.138 534.39 216.24
- famsize       1     2.359 534.62 216.40
- activities.x  1     2.511 534.77 216.51
- G1.x          1     2.530 534.79 216.52
- health.x      1     2.694 534.95 216.64
<none>                      532.26 216.71
- schoolsup.y   1     3.127 535.38 216.95
- internet      1     3.403 535.66 217.15
- schoolsup.x   1     3.668 535.92 217.33
- traveltime.x  1     3.732 535.99 217.38
- guardian.y    1     3.822 536.08 217.44
- age           1     3.893 536.15 217.49
- famsup.y      1     3.902 536.16 217.50
- Pstatus       1     4.199 536.45 217.71
- guardian.x    1     4.308 536.56 217.79
- famsup.x      1     4.357 536.61 217.82
- failures.x    1     4.527 536.78 217.95
+ famrel.y      1     0.201 532.06 218.57
+ Dalc.y        1     0.169 532.09 218.59
+ goout.y       1     0.165 532.09 218.59
+ Dalc.x        1     0.163 532.09 218.59
+ health.y      1     0.158 532.10 218.60
+ traveltime.y  1     0.158 532.10 218.60
+ paid.y        1     0.133 532.12 218.62
+ freetime.y    1     0.119 532.14 218.63
+ Walc.x        1     0.104 532.15 218.64
- sex           1     5.502 537.76 218.64
+ Walc.y        1     0.089 532.17 218.65
+ freetime.x    1     0.081 532.18 218.65
+ activities.y  1     0.015 532.24 218.70
+ nursery       1     0.007 532.25 218.71
- absences.x    1     7.067 539.32 219.75
- Mjob          4    15.703 547.96 219.82
- G1.y          1     7.425 539.68 220.00
- absences.y    1     7.726 539.98 220.22
+ Fjob          4     6.046 526.21 220.35
- reason        3    14.739 546.99 221.15
- failures.y    1    10.264 542.52 222.01
- school        1    15.111 547.37 225.41
- G2.y          1   236.213 768.47 355.01

Step:  AIC=215.15
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Mjob + reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + goout.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + higher.y + romantic.y + absences.y + 
    G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- higher.y      1     0.719 533.59 213.66
- romantic.x    1     0.932 533.80 213.82
- address       1     0.964 533.83 213.84
- G2.x          1     1.193 534.06 214.00
- romantic.y    1     1.345 534.21 214.11
- famrel.x      1     1.351 534.22 214.12
- goout.x       1     1.380 534.25 214.14
- studytime.x   1     1.427 534.29 214.17
- higher.x      1     1.525 534.39 214.24
- studytime.y   1     1.531 534.40 214.25
- G3.x          1     1.858 534.73 214.48
- paid.x        1     1.895 534.76 214.51
- famsize       1     2.298 535.17 214.79
- G1.x          1     2.302 535.17 214.80
- activities.x  1     2.387 535.25 214.86
<none>                      532.87 215.15
- health.x      1     2.889 535.76 215.21
- schoolsup.y   1     3.045 535.91 215.33
- internet      1     3.308 536.18 215.51
- schoolsup.x   1     3.630 536.50 215.74
- guardian.y    1     3.800 536.67 215.86
- age           1     3.941 536.81 215.96
- famsup.y      1     3.983 536.85 215.99
- Pstatus       1     4.086 536.95 216.07
- traveltime.x  1     4.196 537.06 216.15
- failures.x    1     4.289 537.16 216.21
- guardian.x    1     4.377 537.24 216.27
- famsup.x      1     4.402 537.27 216.29
- Medu          1     4.987 537.85 216.71
+ Fedu          1     0.611 532.26 216.71
- sex           1     5.391 538.26 217.00
+ famrel.y      1     0.188 532.68 217.01
+ Dalc.y        1     0.166 532.70 217.03
+ traveltime.y  1     0.165 532.70 217.03
+ health.y      1     0.165 532.70 217.03
+ paid.y        1     0.162 532.71 217.03
+ Dalc.x        1     0.161 532.71 217.03
+ goout.y       1     0.149 532.72 217.04
+ freetime.y    1     0.084 532.78 217.09
+ Walc.x        1     0.077 532.79 217.09
+ Walc.y        1     0.064 532.80 217.10
+ freetime.x    1     0.053 532.81 217.11
+ activities.y  1     0.009 532.86 217.14
+ nursery       1     0.002 532.87 217.15
- absences.x    1     6.927 539.79 218.08
- Mjob          4    15.513 548.38 218.11
+ Fjob          4     6.599 526.27 218.39
- absences.y    1     7.594 540.46 218.55
- G1.y          1     7.627 540.49 218.58
- reason        3    14.662 547.53 219.52
- failures.y    1    10.067 542.93 220.30
- school        1    15.317 548.18 223.97
- G2.y          1   235.615 768.48 353.02

Step:  AIC=213.66
G3.y ~ school + sex + age + address + famsize + Pstatus + Medu + 
    Mjob + reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + goout.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + romantic.y + absences.y + G1.y + 
    G2.y

               Df Sum of Sq    RSS    AIC
- address       1     0.922 534.51 212.32
- romantic.x    1     0.963 534.55 212.35
- studytime.x   1     1.102 534.69 212.45
- goout.x       1     1.130 534.72 212.47
- studytime.y   1     1.195 534.78 212.52
- G2.x          1     1.270 534.86 212.57
- famrel.x      1     1.371 534.96 212.65
- romantic.y    1     1.391 534.98 212.66
- G3.x          1     1.924 535.51 213.04
- paid.x        1     1.966 535.55 213.07
- higher.x      1     2.021 535.61 213.11
- G1.x          1     2.255 535.84 213.28
- activities.x  1     2.293 535.88 213.30
- famsize       1     2.302 535.89 213.31
- health.x      1     2.795 536.38 213.66
<none>                      533.59 213.66
- guardian.y    1     3.283 536.87 214.01
- famsup.y      1     3.401 536.99 214.09
- internet      1     3.482 537.07 214.15
- famsup.x      1     3.884 537.47 214.44
- guardian.x    1     3.976 537.56 214.50
- age           1     3.979 537.57 214.50
- Pstatus       1     4.105 537.69 214.59
- traveltime.x  1     4.260 537.85 214.70
- failures.x    1     4.478 538.06 214.86
+ famrel.y      1     0.843 532.74 215.06
+ health.y      1     0.822 532.76 215.08
+ higher.y      1     0.719 532.87 215.15
+ goout.y       1     0.680 532.91 215.18
+ Fedu          1     0.655 532.93 215.20
+ activities.y  1     0.440 533.15 215.35
- Medu          1     5.362 538.95 215.48
+ Dalc.x        1     0.201 533.39 215.52
+ paid.y        1     0.182 533.40 215.53
+ Dalc.y        1     0.180 533.41 215.54
- sex           1     5.541 539.13 215.61
+ freetime.x    1     0.058 533.53 215.62
+ freetime.y    1     0.054 533.53 215.63
+ Walc.x        1     0.047 533.54 215.63
+ traveltime.y  1     0.016 533.57 215.65
+ Walc.y        1     0.016 533.57 215.65
+ nursery       1     0.005 533.58 215.66
- absences.x    1     6.760 540.35 216.47
- Mjob          4    15.529 549.12 216.62
- absences.y    1     7.251 540.84 216.82
- G1.y          1     7.365 540.95 216.90
+ Fjob          4     6.569 527.02 216.93
- schoolsup.y   1     8.852 542.44 217.95
- reason        3    14.689 548.28 218.04
- failures.y    1     9.512 543.10 218.41
- schoolsup.x   1    10.196 543.78 218.90
- school        1    15.646 549.23 222.71
- G2.y          1   239.621 773.21 353.36

Step:  AIC=212.32
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + goout.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + romantic.y + absences.y + G1.y + 
    G2.y

               Df Sum of Sq    RSS    AIC
- goout.x       1     0.913 535.42 210.98
- romantic.x    1     1.152 535.66 211.15
- G2.x          1     1.157 535.67 211.15
- studytime.x   1     1.160 535.67 211.15
- studytime.y   1     1.234 535.74 211.20
- famrel.x      1     1.373 535.88 211.30
- romantic.y    1     1.640 536.15 211.49
- G3.x          1     1.805 536.31 211.61
- paid.x        1     1.959 536.47 211.72
- higher.x      1     1.990 536.50 211.74
- activities.x  1     2.010 536.52 211.76
- G1.x          1     2.073 536.58 211.80
- famsize       1     2.101 536.61 211.82
<none>                      534.51 212.32
- health.x      1     2.833 537.34 212.34
- famsup.y      1     3.419 537.93 212.76
- guardian.y    1     3.423 537.93 212.76
- traveltime.x  1     3.533 538.04 212.84
- age           1     3.648 538.16 212.92
- famsup.x      1     3.872 538.38 213.08
- guardian.x    1     4.063 538.57 213.22
- internet      1     4.096 538.60 213.24
- Pstatus       1     4.171 538.68 213.29
- failures.x    1     4.665 539.17 213.64
+ address       1     0.922 533.59 213.66
+ Fedu          1     0.761 533.75 213.78
+ famrel.y      1     0.725 533.78 213.81
+ health.y      1     0.724 533.79 213.81
+ higher.y      1     0.678 533.83 213.84
+ goout.y       1     0.573 533.94 213.91
+ activities.y  1     0.431 534.08 214.02
- Medu          1     5.271 539.78 214.07
+ Dalc.x        1     0.280 534.23 214.12
+ paid.y        1     0.277 534.23 214.13
+ Dalc.y        1     0.255 534.25 214.14
+ freetime.x    1     0.052 534.46 214.29
+ freetime.y    1     0.046 534.46 214.29
+ nursery       1     0.016 534.49 214.31
+ Walc.x        1     0.013 534.50 214.31
+ traveltime.y  1     0.007 534.50 214.32
+ Walc.y        1     0.001 534.51 214.32
- sex           1     5.701 540.21 214.38
- Mjob          4    15.592 550.10 215.31
- absences.x    1     7.097 541.61 215.36
- G1.y          1     7.194 541.70 215.43
- absences.y    1     7.270 541.78 215.49
+ Fjob          4     6.614 527.89 215.57
- schoolsup.y   1     8.573 543.08 216.40
- failures.y    1     9.140 543.65 216.80
- reason        3    15.431 549.94 217.20
- schoolsup.x   1     9.883 544.39 217.32
- school        1    17.733 552.24 222.79
- G2.y          1   247.466 781.98 355.67

Step:  AIC=210.98
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + health.x + absences.x + 
    G1.x + G2.x + G3.x + guardian.y + studytime.y + failures.y + 
    schoolsup.y + famsup.y + romantic.y + absences.y + G1.y + 
    G2.y

               Df Sum of Sq    RSS    AIC
- G2.x          1     0.970 536.39 209.67
- romantic.x    1     1.173 536.59 209.81
- studytime.x   1     1.227 536.65 209.85
- famrel.x      1     1.257 536.68 209.87
- studytime.y   1     1.303 536.72 209.90
- G3.x          1     1.588 537.01 210.11
- romantic.y    1     1.682 537.10 210.17
- activities.x  1     1.864 537.29 210.30
- higher.x      1     1.887 537.31 210.32
- paid.x        1     2.052 537.47 210.44
- G1.x          1     2.131 537.55 210.49
- famsize       1     2.155 537.58 210.51
- health.x      1     2.645 538.07 210.86
<none>                      535.42 210.98
- age           1     3.138 538.56 211.21
- traveltime.x  1     3.410 538.83 211.40
- guardian.y    1     3.439 538.86 211.42
- famsup.y      1     3.441 538.86 211.42
- internet      1     3.784 539.21 211.67
- famsup.x      1     3.913 539.33 211.76
- guardian.x    1     4.042 539.46 211.85
- Pstatus       1     4.236 539.66 211.99
+ goout.y       1     1.225 534.20 212.10
+ goout.x       1     0.913 534.51 212.32
+ Fedu          1     0.845 534.58 212.37
- failures.x    1     4.888 540.31 212.45
+ address       1     0.705 534.72 212.47
+ Dalc.x        1     0.553 534.87 212.58
+ Dalc.y        1     0.520 534.90 212.60
+ health.y      1     0.490 534.93 212.63
+ famrel.y      1     0.460 534.96 212.65
+ higher.y      1     0.460 534.96 212.65
+ activities.y  1     0.319 535.10 212.75
+ paid.y        1     0.253 535.17 212.80
+ freetime.x    1     0.246 535.18 212.80
+ freetime.y    1     0.231 535.19 212.81
+ Walc.y        1     0.120 535.30 212.89
+ Walc.x        1     0.081 535.34 212.92
+ nursery       1     0.020 535.40 212.96
+ traveltime.y  1     0.005 535.42 212.97
- Medu          1     5.770 541.19 213.07
- sex           1     5.886 541.31 213.15
- G1.y          1     6.864 542.29 213.84
- absences.y    1     6.918 542.34 213.88
- absences.x    1     6.932 542.35 213.89
- Mjob          4    15.732 551.15 214.04
+ Fjob          4     6.792 528.63 214.10
- schoolsup.y   1     8.166 543.59 214.76
- failures.y    1     9.098 544.52 215.41
- schoolsup.x   1     9.431 544.85 215.65
- reason        3    15.381 550.80 215.80
- school        1    17.243 552.66 221.08
- G2.y          1   252.643 788.06 356.63

Step:  AIC=209.67
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + health.x + absences.x + 
    G1.x + G3.x + guardian.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- G3.x          1     0.658 537.05 208.14
- studytime.x   1     1.183 537.57 208.51
- romantic.x    1     1.210 537.60 208.53
- studytime.y   1     1.250 537.64 208.56
- G1.x          1     1.277 537.67 208.58
- activities.x  1     1.636 538.03 208.83
- romantic.y    1     1.770 538.16 208.93
- famrel.x      1     1.799 538.19 208.95
- higher.x      1     2.064 538.46 209.13
- famsize       1     2.274 538.67 209.28
- paid.x        1     2.291 538.68 209.30
- health.x      1     2.446 538.84 209.41
<none>                      536.39 209.67
- famsup.y      1     3.231 539.62 209.96
- age           1     3.256 539.65 209.98
- guardian.y    1     3.498 539.89 210.15
- internet      1     3.538 539.93 210.18
- famsup.x      1     3.711 540.10 210.30
- traveltime.x  1     3.866 540.26 210.41
- guardian.x    1     4.170 540.56 210.63
- Pstatus       1     4.207 540.60 210.65
+ goout.y       1     1.038 535.35 210.93
+ G2.x          1     0.970 535.42 210.98
- failures.x    1     4.754 541.15 211.04
+ Fedu          1     0.824 535.57 211.08
+ goout.x       1     0.726 535.67 211.15
+ address       1     0.634 535.76 211.22
+ health.y      1     0.617 535.77 211.23
+ Dalc.x        1     0.604 535.79 211.24
+ famrel.y      1     0.566 535.83 211.26
+ Dalc.y        1     0.565 535.83 211.27
+ higher.y      1     0.535 535.86 211.29
+ activities.y  1     0.380 536.01 211.40
+ paid.y        1     0.288 536.10 211.46
+ freetime.x    1     0.186 536.21 211.53
+ freetime.y    1     0.176 536.22 211.54
+ Walc.y        1     0.119 536.27 211.58
+ Walc.x        1     0.075 536.32 211.61
+ traveltime.y  1     0.015 536.38 211.66
+ nursery       1     0.012 536.38 211.66
- Medu          1     5.827 542.22 211.79
- sex           1     5.847 542.24 211.81
- absences.x    1     6.541 542.93 212.30
- absences.y    1     6.881 543.27 212.54
+ Fjob          4     6.974 529.42 212.67
- G1.y          1     7.265 543.66 212.81
- Mjob          4    16.126 552.52 212.98
- schoolsup.y   1     8.313 544.70 213.54
- failures.y    1     9.303 545.70 214.24
- schoolsup.x   1     9.550 545.94 214.41
- reason        3    15.552 551.94 214.59
- school        1    17.176 553.57 219.71
- G2.y          1   251.817 788.21 354.70

Step:  AIC=208.14
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + studytime.x + 
    failures.x + schoolsup.x + famsup.x + paid.x + activities.x + 
    higher.x + romantic.x + famrel.x + health.x + absences.x + 
    G1.x + guardian.y + studytime.y + failures.y + schoolsup.y + 
    famsup.y + romantic.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- studytime.x   1     1.019 538.07 206.86
- studytime.y   1     1.070 538.12 206.90
- romantic.x    1     1.238 538.29 207.02
- activities.x  1     1.478 538.53 207.19
- romantic.y    1     1.741 538.79 207.37
- famrel.x      1     1.939 538.99 207.51
- higher.x      1     2.035 539.08 207.58
- paid.x        1     2.103 539.15 207.63
- famsize       1     2.132 539.18 207.65
- health.x      1     2.350 539.40 207.80
<none>                      537.05 208.14
- age           1     2.830 539.88 208.14
- famsup.y      1     2.901 539.95 208.19
- guardian.y    1     3.347 540.40 208.51
- famsup.x      1     3.365 540.41 208.52
- internet      1     3.694 540.74 208.75
- traveltime.x  1     3.720 540.77 208.77
- guardian.x    1     4.015 541.06 208.98
- Pstatus       1     4.256 541.31 209.15
+ goout.y       1     0.994 536.06 209.43
+ Fedu          1     0.931 536.12 209.47
- G1.x          1     4.853 541.90 209.57
+ health.y      1     0.732 536.32 209.61
+ goout.x       1     0.677 536.37 209.65
+ G3.x          1     0.658 536.39 209.67
+ famrel.y      1     0.631 536.42 209.69
+ address       1     0.623 536.43 209.69
- failures.x    1     5.036 542.09 209.70
+ higher.y      1     0.543 536.51 209.75
+ Dalc.x        1     0.536 536.51 209.75
+ Dalc.y        1     0.495 536.55 209.78
+ activities.y  1     0.418 536.63 209.84
+ paid.y        1     0.274 536.78 209.94
- sex           1     5.468 542.52 210.01
+ freetime.x    1     0.167 536.88 210.02
+ freetime.y    1     0.164 536.89 210.02
+ Walc.y        1     0.072 536.98 210.08
+ traveltime.y  1     0.049 537.00 210.10
+ G2.x          1     0.040 537.01 210.11
+ Walc.x        1     0.035 537.01 210.11
+ nursery       1     0.003 537.05 210.13
- Medu          1     5.803 542.85 210.24
- absences.x    1     5.936 542.99 210.33
- absences.y    1     6.402 543.45 210.66
- Mjob          4    15.640 552.69 211.10
- G1.y          1     7.050 544.10 211.12
+ Fjob          4     6.977 530.07 211.14
- schoolsup.y   1     7.746 544.80 211.61
- failures.y    1     8.900 545.95 212.41
- schoolsup.x   1     8.928 545.98 212.43
- reason        3    14.988 552.04 212.65
- school        1    16.866 553.92 217.95
- G2.y          1   265.121 802.17 359.41

Step:  AIC=206.86
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    romantic.x + famrel.x + health.x + absences.x + G1.x + guardian.y + 
    studytime.y + failures.y + schoolsup.y + famsup.y + romantic.y + 
    absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- studytime.y   1     0.072 538.14 204.91
- romantic.x    1     0.540 538.61 205.24
- romantic.y    1     0.929 539.00 205.52
- activities.x  1     1.433 539.50 205.88
- famrel.x      1     1.839 539.91 206.16
- famsup.y      1     1.898 539.97 206.21
- higher.x      1     1.996 540.06 206.27
- health.x      1     2.101 540.17 206.35
- famsize       1     2.214 540.28 206.43
- famsup.x      1     2.410 540.48 206.57
- paid.x        1     2.426 540.49 206.58
- age           1     2.764 540.83 206.82
<none>                      538.07 206.86
- guardian.y    1     3.207 541.28 207.13
- traveltime.x  1     3.783 541.85 207.54
- internet      1     3.828 541.90 207.57
- guardian.x    1     3.891 541.96 207.61
+ health.y      1     1.703 536.37 207.65
- Pstatus       1     4.227 542.30 207.85
+ activities.y  1     1.387 536.68 207.87
- G1.x          1     4.327 542.40 207.92
+ studytime.x   1     1.019 537.05 208.14
+ Fedu          1     0.870 537.20 208.24
+ goout.y       1     0.853 537.22 208.25
+ goout.x       1     0.739 537.33 208.34
+ address       1     0.664 537.40 208.39
+ Dalc.x        1     0.509 537.56 208.50
+ G3.x          1     0.494 537.57 208.51
+ Dalc.y        1     0.494 537.57 208.51
+ famrel.y      1     0.383 537.69 208.59
+ paid.y        1     0.380 537.69 208.59
- sex           1     5.291 543.36 208.60
+ higher.y      1     0.270 537.80 208.67
+ freetime.x    1     0.192 537.88 208.72
- failures.x    1     5.478 543.55 208.73
+ freetime.y    1     0.113 537.96 208.78
+ G2.x          1     0.064 538.01 208.82
+ Walc.y        1     0.059 538.01 208.82
+ Walc.x        1     0.055 538.01 208.82
+ traveltime.y  1     0.026 538.04 208.84
+ nursery       1     0.014 538.06 208.85
- Medu          1     5.677 543.75 208.87
- absences.x    1     5.777 543.85 208.94
- absences.y    1     5.872 543.94 209.01
- schoolsup.y   1     6.738 544.81 209.61
- Mjob          4    15.543 553.61 209.74
+ Fjob          4     6.968 531.10 209.88
- G1.y          1     7.651 545.72 210.25
- schoolsup.x   1     7.909 545.98 210.43
- failures.y    1     8.235 546.30 210.66
- reason        3    15.192 553.26 211.50
- school        1    16.499 554.57 216.40
- G2.y          1   264.869 802.94 357.77

Step:  AIC=204.91
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    romantic.x + famrel.x + health.x + absences.x + G1.x + guardian.y + 
    failures.y + schoolsup.y + famsup.y + romantic.y + absences.y + 
    G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- romantic.x    1     0.535 538.68 203.29
- romantic.y    1     0.926 539.07 203.57
- activities.x  1     1.495 539.64 203.97
- famrel.x      1     1.846 539.99 204.22
- famsup.y      1     1.869 540.01 204.24
- higher.x      1     2.028 540.17 204.35
- health.x      1     2.086 540.23 204.39
- famsize       1     2.253 540.39 204.51
- famsup.x      1     2.385 540.53 204.60
- paid.x        1     2.388 540.53 204.60
<none>                      538.14 204.91
- age           1     2.863 541.00 204.94
- guardian.y    1     3.225 541.37 205.19
- traveltime.x  1     3.741 541.88 205.56
- internet      1     3.893 542.03 205.66
- guardian.x    1     3.907 542.05 205.68
+ health.y      1     1.724 536.42 205.69
- Pstatus       1     4.199 542.34 205.88
+ activities.y  1     1.423 536.72 205.90
- G1.x          1     4.408 542.55 206.03
+ Fedu          1     0.920 537.22 206.26
+ goout.y       1     0.850 537.29 206.31
+ goout.x       1     0.743 537.40 206.38
+ address       1     0.626 537.51 206.47
+ Dalc.x        1     0.526 537.61 206.54
+ Dalc.y        1     0.512 537.63 206.55
+ G3.x          1     0.463 537.68 206.58
+ famrel.y      1     0.373 537.77 206.65
+ paid.y        1     0.370 537.77 206.65
+ higher.y      1     0.267 537.87 206.72
+ freetime.x    1     0.211 537.93 206.76
+ freetime.y    1     0.127 538.01 206.82
- failures.x    1     5.547 543.69 206.83
+ Walc.y        1     0.074 538.07 206.86
+ studytime.y   1     0.072 538.07 206.86
+ Walc.x        1     0.071 538.07 206.86
+ G2.x          1     0.067 538.07 206.86
+ traveltime.y  1     0.030 538.11 206.89
+ studytime.x   1     0.021 538.12 206.90
+ nursery       1     0.019 538.12 206.90
- Medu          1     5.654 543.79 206.90
- absences.y    1     5.800 543.94 207.01
- sex           1     5.815 543.96 207.02
- absences.x    1     5.840 543.98 207.03
- schoolsup.y   1     6.706 544.85 207.64
- Mjob          4    15.476 553.62 207.74
+ Fjob          4     6.995 531.15 207.91
- G1.y          1     7.710 545.85 208.35
- schoolsup.x   1     7.867 546.01 208.46
- failures.y    1     8.352 546.49 208.79
- reason        3    15.356 553.50 209.66
- school        1    16.708 554.85 214.59
- G2.y          1   265.003 803.14 355.87

Step:  AIC=203.29
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    famrel.x + health.x + absences.x + G1.x + guardian.y + failures.y + 
    schoolsup.y + famsup.y + romantic.y + absences.y + G1.y + 
    G2.y

               Df Sum of Sq    RSS    AIC
- romantic.y    1     1.511 540.19 202.36
- famsup.y      1     1.515 540.19 202.36
- activities.x  1     1.614 540.29 202.43
- famrel.x      1     1.755 540.43 202.53
- famsup.x      1     1.995 540.67 202.70
- health.x      1     2.012 540.69 202.72
- higher.x      1     2.146 540.82 202.81
- famsize       1     2.316 540.99 202.93
- paid.x        1     2.336 541.01 202.94
<none>                      538.68 203.29
- age           1     2.852 541.53 203.31
- guardian.y    1     2.911 541.59 203.35
+ health.y      1     2.089 536.59 203.81
- guardian.x    1     3.737 542.41 203.93
- traveltime.x  1     3.765 542.44 203.95
- internet      1     3.770 542.45 203.95
- Pstatus       1     4.198 542.87 204.26
- G1.x          1     4.493 543.17 204.46
+ goout.y       1     0.912 537.76 204.64
+ Fedu          1     0.902 537.77 204.65
+ goout.x       1     0.730 537.95 204.77
+ address       1     0.726 537.95 204.78
+ Dalc.x        1     0.607 538.07 204.86
+ romantic.x    1     0.535 538.14 204.91
+ G3.x          1     0.533 538.14 204.91
+ Dalc.y        1     0.502 538.17 204.93
+ activities.y  1     0.446 538.23 204.97
+ higher.y      1     0.360 538.32 205.04
+ paid.y        1     0.290 538.39 205.09
+ freetime.x    1     0.238 538.44 205.12
+ freetime.y    1     0.120 538.56 205.21
+ famrel.y      1     0.100 538.58 205.22
+ Walc.y        1     0.078 538.60 205.24
+ Walc.x        1     0.074 538.60 205.24
+ studytime.y   1     0.066 538.61 205.24
+ G2.x          1     0.058 538.62 205.25
+ studytime.x   1     0.032 538.64 205.27
- absences.y    1     5.641 544.32 205.27
+ nursery       1     0.025 538.65 205.27
+ traveltime.y  1     0.010 538.67 205.28
- absences.x    1     5.684 544.36 205.30
- failures.x    1     5.693 544.37 205.31
- Medu          1     5.820 544.50 205.40
- sex           1     6.209 544.88 205.67
- schoolsup.y   1     6.580 545.26 205.93
- Mjob          4    15.617 554.29 206.21
+ Fjob          4     6.997 531.68 206.30
- G1.y          1     7.530 546.21 206.59
- schoolsup.x   1     7.762 546.44 206.76
- failures.y    1     8.008 546.68 206.93
- reason        3    15.522 554.20 208.14
- school        1    16.569 555.25 212.86
- G2.y          1   264.835 803.51 354.04

Step:  AIC=202.36
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    famrel.x + health.x + absences.x + G1.x + guardian.y + failures.y + 
    schoolsup.y + famsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- famsup.y      1     1.480 541.67 201.41
- famrel.x      1     1.530 541.72 201.44
- health.x      1     1.735 541.92 201.59
- higher.x      1     1.778 541.96 201.62
- famsup.x      1     1.980 542.17 201.76
- activities.x  1     1.995 542.18 201.77
- famsize       1     2.149 542.34 201.88
- paid.x        1     2.311 542.50 201.99
- guardian.y    1     2.619 542.81 202.21
<none>                      540.19 202.36
- age           1     3.293 543.48 202.68
- guardian.x    1     3.414 543.60 202.77
+ health.y      1     2.119 538.07 202.86
- traveltime.x  1     3.688 543.87 202.96
+ romantic.y    1     1.511 538.68 203.29
- internet      1     4.216 544.40 203.33
- Pstatus       1     4.477 544.66 203.51
+ romantic.x    1     1.120 539.07 203.57
+ goout.y       1     1.013 539.17 203.64
- G1.x          1     4.731 544.92 203.69
+ Fedu          1     0.883 539.30 203.74
+ address       1     0.815 539.37 203.78
+ goout.x       1     0.801 539.39 203.79
+ Dalc.x        1     0.603 539.58 203.93
+ Dalc.y        1     0.478 539.71 204.02
+ higher.y      1     0.419 539.77 204.06
- Medu          1     5.319 545.51 204.10
- absences.x    1     5.327 545.51 204.11
+ activities.y  1     0.327 539.86 204.13
- absences.y    1     5.394 545.58 204.16
+ G3.x          1     0.286 539.90 204.16
+ paid.y        1     0.279 539.91 204.16
+ freetime.x    1     0.206 539.98 204.22
+ G2.x          1     0.201 539.99 204.22
- failures.x    1     5.518 545.70 204.24
+ Walc.y        1     0.098 540.09 204.29
+ studytime.y   1     0.092 540.09 204.30
+ Walc.x        1     0.092 540.09 204.30
+ freetime.y    1     0.091 540.10 204.30
+ famrel.y      1     0.071 540.12 204.31
+ studytime.x   1     0.057 540.13 204.32
+ nursery       1     0.046 540.14 204.33
+ traveltime.y  1     0.012 540.17 204.35
- Mjob          4    14.752 554.94 204.65
- schoolsup.y   1     6.888 547.07 205.20
- sex           1     7.032 547.22 205.30
+ Fjob          4     7.042 533.14 205.35
- G1.y          1     7.791 547.98 205.83
- schoolsup.x   1     8.260 548.45 206.16
- failures.y    1     8.601 548.79 206.39
- reason        3    15.004 555.19 206.83
- school        1    16.181 556.37 211.63
- G2.y          1   263.328 803.51 352.05

Step:  AIC=201.41
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    famrel.x + health.x + absences.x + G1.x + guardian.y + failures.y + 
    schoolsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- guardian.y    1     1.144 542.81 200.21
- famrel.x      1     1.383 543.05 200.38
- famsup.x      1     1.400 543.07 200.39
- higher.x      1     1.435 543.10 200.42
- health.x      1     1.762 543.43 200.65
- activities.x  1     1.803 543.47 200.67
- guardian.x    1     1.964 543.63 200.79
- famsize       1     2.056 543.72 200.85
- paid.x        1     2.462 544.13 201.14
<none>                      541.67 201.41
- age           1     3.207 544.87 201.66
+ health.y      1     2.461 539.20 201.67
- traveltime.x  1     3.700 545.37 202.01
- internet      1     4.196 545.86 202.35
+ famsup.y      1     1.480 540.19 202.36
+ romantic.y    1     1.475 540.19 202.36
- G1.x          1     4.456 546.12 202.54
+ activities.y  1     1.225 540.44 202.54
+ romantic.x    1     1.212 540.45 202.55
- Pstatus       1     4.494 546.16 202.56
+ Fedu          1     0.936 540.73 202.74
+ goout.y       1     0.827 540.84 202.82
+ goout.x       1     0.785 540.88 202.85
+ address       1     0.752 540.91 202.88
+ Dalc.y        1     0.490 541.18 203.06
- absences.y    1     5.213 546.88 203.06
+ Dalc.x        1     0.463 541.20 203.08
- absences.x    1     5.270 546.94 203.10
+ paid.y        1     0.236 541.43 203.24
+ G2.x          1     0.218 541.45 203.25
+ traveltime.y  1     0.178 541.49 203.28
+ freetime.x    1     0.172 541.49 203.28
+ G3.x          1     0.165 541.50 203.29
- Medu          1     5.544 547.21 203.30
+ Walc.x        1     0.113 541.55 203.33
- failures.x    1     5.602 547.27 203.34
+ studytime.x   1     0.088 541.58 203.34
+ freetime.y    1     0.069 541.60 203.36
+ Walc.y        1     0.069 541.60 203.36
+ studytime.y   1     0.063 541.60 203.36
+ higher.y      1     0.060 541.61 203.36
+ nursery       1     0.038 541.63 203.38
+ famrel.y      1     0.015 541.65 203.39
- Mjob          4    14.809 556.48 203.71
- schoolsup.y   1     6.918 548.58 204.25
- sex           1     7.073 548.74 204.36
+ Fjob          4     7.093 534.57 204.37
- G1.y          1     7.600 549.27 204.73
- schoolsup.x   1     8.291 549.96 205.21
- failures.y    1     8.582 550.25 205.41
- reason        3    14.914 556.58 205.78
- school        1    16.008 557.67 210.53
- G2.y          1   267.376 809.04 352.66

Step:  AIC=200.21
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + famsup.x + paid.x + activities.x + higher.x + 
    famrel.x + health.x + absences.x + G1.x + failures.y + schoolsup.y + 
    absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- famsup.x      1     1.097 543.91 198.98
- higher.x      1     1.134 543.94 199.01
- guardian.x    2     3.991 546.80 199.01
- famrel.x      1     1.184 543.99 199.04
- activities.x  1     1.671 544.48 199.39
- health.x      1     1.690 544.50 199.40
- famsize       1     2.153 544.96 199.72
- paid.x        1     2.165 544.97 199.73
<none>                      542.81 200.21
- age           1     2.961 545.77 200.29
+ activities.y  1     2.045 540.76 200.77
- G1.x          1     3.760 546.57 200.85
+ health.y      1     1.741 541.07 200.98
- traveltime.x  1     3.979 546.79 201.00
- internet      1     4.214 547.02 201.17
+ romantic.x    1     1.402 541.41 201.22
- Pstatus       1     4.395 547.20 201.29
+ romantic.y    1     1.223 541.59 201.35
+ guardian.y    1     1.144 541.67 201.41
- absences.y    1     4.874 547.68 201.63
+ goout.x       1     0.827 541.98 201.63
- absences.x    1     4.884 547.69 201.63
+ goout.y       1     0.812 542.00 201.64
+ Fedu          1     0.794 542.02 201.65
+ famrel.y      1     0.771 542.04 201.67
+ address       1     0.737 542.07 201.69
+ higher.y      1     0.524 542.29 201.84
+ Dalc.y        1     0.479 542.33 201.87
+ Dalc.x        1     0.458 542.35 201.89
+ G2.x          1     0.298 542.51 202.00
- Medu          1     5.437 548.25 202.02
+ paid.y        1     0.233 542.58 202.05
+ freetime.x    1     0.185 542.63 202.08
+ G3.x          1     0.128 542.68 202.12
+ studytime.y   1     0.119 542.69 202.13
+ Walc.y        1     0.114 542.70 202.13
+ Walc.x        1     0.110 542.70 202.13
+ studytime.x   1     0.050 542.76 202.18
+ nursery       1     0.043 542.77 202.18
+ freetime.y    1     0.021 542.79 202.20
+ traveltime.y  1     0.008 542.80 202.21
+ famsup.y      1     0.005 542.81 202.21
- failures.x    1     6.109 548.92 202.49
- Mjob          4    14.921 557.73 202.57
- sex           1     6.730 549.54 202.92
- schoolsup.y   1     6.922 549.73 203.05
+ Fjob          4     7.098 535.71 203.18
- failures.y    1     8.251 551.06 203.97
- G1.y          1     8.254 551.06 203.98
- schoolsup.x   1     8.283 551.09 204.00
- reason        3    15.145 557.96 204.72
- school        1    15.782 558.59 209.16
- G2.y          1   268.904 811.71 351.92

Step:  AIC=198.98
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + guardian.x + traveltime.x + failures.x + 
    schoolsup.x + paid.x + activities.x + higher.x + famrel.x + 
    health.x + absences.x + G1.x + failures.y + schoolsup.y + 
    absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- guardian.x    2     4.004 547.91 197.78
- higher.x      1     1.150 545.06 197.79
- famrel.x      1     1.196 545.10 197.82
- health.x      1     1.467 545.37 198.01
- activities.x  1     1.528 545.44 198.05
- paid.x        1     1.573 545.48 198.09
- famsize       1     2.411 546.32 198.67
- age           1     2.733 546.64 198.90
<none>                      543.91 198.98
- G1.x          1     3.303 547.21 199.30
+ activities.y  1     1.887 542.02 199.65
+ health.y      1     1.709 542.20 199.78
+ romantic.x    1     1.492 542.42 199.93
- traveltime.x  1     4.256 548.16 199.96
- internet      1     4.354 548.26 200.03
+ romantic.y    1     1.349 542.56 200.03
- Pstatus       1     4.373 548.28 200.04
+ famsup.x      1     1.097 542.81 200.21
+ famsup.y      1     0.990 542.92 200.29
+ goout.x       1     0.876 543.03 200.37
+ goout.y       1     0.862 543.04 200.38
+ guardian.y    1     0.841 543.07 200.39
- Medu          1     5.005 548.91 200.48
+ Fedu          1     0.628 543.28 200.54
+ famrel.y      1     0.627 543.28 200.54
- absences.x    1     5.108 549.02 200.55
+ address       1     0.601 543.31 200.56
+ higher.y      1     0.546 543.36 200.60
- absences.y    1     5.227 549.13 200.64
+ Dalc.y        1     0.485 543.42 200.64
+ Dalc.x        1     0.449 543.46 200.67
+ G2.x          1     0.326 543.58 200.75
+ Walc.x        1     0.174 543.73 200.86
+ Walc.y        1     0.166 543.74 200.87
+ studytime.y   1     0.164 543.74 200.87
+ paid.y        1     0.146 543.76 200.88
+ G3.x          1     0.129 543.78 200.89
+ freetime.x    1     0.128 543.78 200.89
+ studytime.x   1     0.103 543.80 200.91
+ nursery       1     0.055 543.85 200.94
+ freetime.y    1     0.012 543.90 200.97
+ traveltime.y  1     0.004 543.90 200.98
- failures.x    1     6.250 550.16 201.35
+ Fjob          4     7.292 536.62 201.83
- schoolsup.y   1     7.050 550.96 201.90
- Mjob          4    15.912 559.82 202.00
- sex           1     7.394 551.30 202.14
- failures.y    1     7.875 551.78 202.47
- schoolsup.x   1     8.341 552.25 202.80
- G1.y          1     8.536 552.44 202.93
- reason        3    15.910 559.82 204.00
- school        1    16.633 560.54 208.49
- G2.y          1   269.218 813.13 350.59

Step:  AIC=197.78
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    paid.x + activities.x + higher.x + famrel.x + health.x + 
    absences.x + G1.x + failures.y + schoolsup.y + absences.y + 
    G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- paid.x        1     1.308 549.22 196.70
- famrel.x      1     1.325 549.24 196.71
- higher.x      1     1.362 549.27 196.73
- activities.x  1     1.569 549.48 196.88
- health.x      1     1.570 549.48 196.88
- famsize       1     2.576 550.49 197.58
<none>                      547.91 197.78
- G1.x          1     2.951 550.86 197.84
+ activities.y  1     2.143 545.77 198.29
- age           1     3.837 551.75 198.45
+ romantic.x    1     1.657 546.25 198.63
+ health.y      1     1.586 546.33 198.68
+ romantic.y    1     1.408 546.50 198.80
- internet      1     4.604 552.52 198.98
+ guardian.x    2     4.004 543.91 198.98
- traveltime.x  1     4.615 552.53 198.99
+ famsup.x      1     1.111 546.80 199.01
+ famsup.y      1     1.092 546.82 199.02
+ famrel.y      1     0.908 547.00 199.15
+ Fedu          1     0.899 547.01 199.16
- Medu          1     4.917 552.83 199.20
+ goout.x       1     0.812 547.10 199.22
+ goout.y       1     0.767 547.14 199.25
+ higher.y      1     0.765 547.15 199.25
+ address       1     0.556 547.36 199.40
+ Dalc.y        1     0.539 547.37 199.41
- absences.x    1     5.247 553.16 199.43
+ Dalc.x        1     0.496 547.42 199.44
+ guardian.y    2     3.315 544.60 199.47
+ G2.x          1     0.405 547.51 199.50
- absences.y    1     5.440 553.35 199.56
+ Walc.x        1     0.277 547.63 199.59
+ Walc.y        1     0.277 547.63 199.59
+ studytime.y   1     0.193 547.72 199.65
- Pstatus       1     5.613 553.52 199.68
+ G3.x          1     0.137 547.77 199.69
+ studytime.x   1     0.100 547.81 199.72
+ paid.y        1     0.090 547.82 199.72
+ freetime.x    1     0.046 547.87 199.75
+ traveltime.y  1     0.028 547.88 199.77
+ nursery       1     0.005 547.91 199.78
+ freetime.y    1     0.003 547.91 199.78
- failures.x    1     6.043 553.95 199.97
+ Fjob          4     7.734 540.18 200.35
- schoolsup.y   1     6.763 554.67 200.47
- failures.y    1     6.990 554.90 200.63
- Mjob          4    16.150 564.06 200.88
- sex           1     7.898 555.81 201.25
- schoolsup.x   1     8.187 556.10 201.45
- G1.y          1     8.331 556.24 201.55
- reason        3    16.029 563.94 202.80
- school        1    18.048 565.96 208.16
- G2.y          1   270.150 818.06 348.90

Step:  AIC=196.7
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    activities.x + higher.x + famrel.x + health.x + absences.x + 
    G1.x + failures.y + schoolsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- higher.x      1     1.105 550.32 195.46
- famrel.x      1     1.404 550.62 195.67
- health.x      1     1.483 550.70 195.73
- activities.x  1     1.785 551.00 195.93
- famsize       1     2.639 551.86 196.53
<none>                      549.22 196.70
- G1.x          1     3.226 552.44 196.93
+ activities.y  1     2.360 546.86 197.05
- age           1     3.727 552.95 197.28
+ health.y      1     1.878 547.34 197.39
- internet      1     4.040 553.26 197.49
+ romantic.x    1     1.600 547.62 197.58
+ romantic.y    1     1.379 547.84 197.73
+ paid.x        1     1.308 547.91 197.78
- traveltime.x  1     4.584 553.80 197.87
+ guardian.x    2     3.739 545.48 198.09
+ goout.x       1     0.874 548.34 198.09
+ Fedu          1     0.853 548.37 198.10
+ goout.y       1     0.820 548.40 198.12
+ famrel.y      1     0.757 548.46 198.17
+ Dalc.y        1     0.754 548.46 198.17
- Medu          1     5.070 554.29 198.21
+ Dalc.x        1     0.693 548.53 198.21
+ higher.y      1     0.688 548.53 198.22
+ address       1     0.591 548.63 198.28
+ famsup.x      1     0.563 548.66 198.30
+ G2.x          1     0.563 548.66 198.30
+ famsup.y      1     0.512 548.71 198.34
+ Walc.x        1     0.460 548.76 198.37
+ Walc.y        1     0.440 548.78 198.39
+ guardian.y    2     3.158 546.06 198.49
- failures.x    1     5.524 554.74 198.52
+ paid.y        1     0.179 549.04 198.57
- absences.x    1     5.603 554.82 198.57
+ studytime.y   1     0.119 549.10 198.61
+ G3.x          1     0.068 549.15 198.65
+ studytime.x   1     0.049 549.17 198.66
+ freetime.x    1     0.030 549.19 198.67
+ freetime.y    1     0.009 549.21 198.69
+ traveltime.y  1     0.005 549.21 198.69
+ nursery       1     0.000 549.22 198.70
- Pstatus       1     6.098 555.32 198.91
- absences.y    1     6.458 555.68 199.16
- Mjob          4    15.308 564.53 199.20
+ Fjob          4     7.577 541.64 199.39
- schoolsup.y   1     6.810 556.03 199.40
- failures.y    1     6.863 556.08 199.44
- sex           1     7.303 556.52 199.74
- schoolsup.x   1     8.160 557.38 200.33
- G1.y          1     8.337 557.56 200.45
- reason        3    16.560 565.78 202.04
- school        1    17.761 566.98 206.85
- G2.y          1   270.465 819.68 347.66

Step:  AIC=195.46
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    activities.x + famrel.x + health.x + absences.x + G1.x + 
    failures.y + schoolsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- health.x      1     1.494 551.82 194.50
- famrel.x      1     1.508 551.83 194.51
- activities.x  1     2.151 552.48 194.95
- famsize       1     2.688 553.01 195.32
<none>                      550.32 195.46
- age           1     3.132 553.46 195.63
- G1.x          1     3.370 553.69 195.80
+ health.y      1     2.090 548.23 196.01
+ activities.y  1     2.019 548.30 196.06
- internet      1     3.769 554.09 196.07
+ higher.y      1     1.712 548.61 196.27
+ romantic.x    1     1.235 549.09 196.60
+ romantic.y    1     1.135 549.19 196.67
+ higher.x      1     1.105 549.22 196.70
+ guardian.x    2     3.954 546.37 196.71
+ paid.x        1     1.051 549.27 196.73
- traveltime.x  1     4.740 555.06 196.74
- Medu          1     4.941 555.26 196.88
+ Fedu          1     0.794 549.53 196.91
+ goout.y       1     0.786 549.54 196.92
+ goout.x       1     0.774 549.55 196.93
+ famsup.x      1     0.626 549.70 197.03
+ Dalc.y        1     0.594 549.73 197.05
+ address       1     0.583 549.74 197.06
+ G2.x          1     0.576 549.75 197.06
+ Dalc.x        1     0.573 549.75 197.07
+ guardian.y    2     3.443 546.88 197.07
+ famsup.y      1     0.569 549.76 197.07
+ famrel.y      1     0.470 549.85 197.14
+ Walc.x        1     0.360 549.96 197.21
+ Walc.y        1     0.353 549.97 197.22
- absences.x    1     5.474 555.80 197.24
+ paid.y        1     0.159 550.16 197.35
+ studytime.y   1     0.149 550.18 197.36
+ G3.x          1     0.089 550.23 197.40
+ studytime.x   1     0.077 550.25 197.41
+ freetime.x    1     0.019 550.31 197.45
+ freetime.y    1     0.018 550.31 197.45
+ nursery       1     0.001 550.32 197.46
+ traveltime.y  1     0.000 550.32 197.46
- Pstatus       1     6.169 556.49 197.72
- absences.y    1     6.184 556.51 197.73
- Mjob          4    15.304 565.63 197.94
+ Fjob          4     7.787 542.54 198.02
- failures.x    1     6.841 557.16 198.18
- failures.y    1     7.143 557.47 198.39
- schoolsup.y   1     7.897 558.22 198.91
- G1.y          1     8.206 558.53 199.12
- sex           1     8.316 558.64 199.19
- schoolsup.x   1     9.392 559.72 199.93
- reason        3    17.541 567.87 201.45
- school        1    17.105 567.43 205.16
- G2.y          1   274.497 824.82 348.04

Step:  AIC=194.5
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    activities.x + famrel.x + absences.x + G1.x + failures.y + 
    schoolsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- famrel.x      1     1.223 553.04 193.34
- activities.x  1     2.022 553.84 193.90
- famsize       1     2.449 554.27 194.19
<none>                      551.82 194.50
- G1.x          1     3.323 555.14 194.79
- age           1     3.373 555.19 194.83
+ health.y      1     2.132 549.69 195.02
+ activities.y  1     1.862 549.96 195.21
+ higher.y      1     1.734 550.08 195.30
+ health.x      1     1.494 550.32 195.46
- internet      1     4.491 556.31 195.59
- Medu          1     4.516 556.33 195.61
+ guardian.x    2     4.049 547.77 195.69
+ higher.x      1     1.116 550.70 195.73
- traveltime.x  1     4.772 556.59 195.79
+ romantic.x    1     1.015 550.80 195.80
+ Fedu          1     0.980 550.84 195.82
+ paid.x        1     0.972 550.85 195.82
+ romantic.y    1     0.906 550.91 195.87
+ Dalc.y        1     0.675 551.14 196.03
+ Dalc.x        1     0.646 551.17 196.05
+ goout.y       1     0.645 551.17 196.05
+ guardian.y    2     3.512 548.31 196.06
+ goout.x       1     0.629 551.19 196.06
+ address       1     0.614 551.20 196.07
+ G2.x          1     0.492 551.33 196.16
+ famsup.x      1     0.473 551.34 196.17
+ famrel.y      1     0.454 551.36 196.18
+ famsup.y      1     0.421 551.40 196.21
+ Walc.x        1     0.413 551.41 196.21
+ Walc.y        1     0.410 551.41 196.21
- absences.x    1     5.581 557.40 196.34
+ paid.y        1     0.196 551.62 196.36
+ studytime.y   1     0.122 551.70 196.41
+ G3.x          1     0.079 551.74 196.44
+ studytime.x   1     0.063 551.76 196.46
+ freetime.x    1     0.021 551.80 196.48
+ freetime.y    1     0.012 551.81 196.49
+ traveltime.y  1     0.000 551.82 196.50
+ nursery       1     0.000 551.82 196.50
- Mjob          4    14.657 566.48 196.51
- absences.y    1     6.168 557.99 196.74
+ Fjob          4     8.109 543.71 196.84
- Pstatus       1     6.327 558.14 196.85
- failures.x    1     6.928 558.75 197.26
- failures.y    1     7.135 558.95 197.41
- schoolsup.y   1     7.715 559.53 197.80
- G1.y          1     8.048 559.87 198.03
- sex           1     8.782 560.60 198.53
- schoolsup.x   1     9.081 560.90 198.73
- reason        3    17.269 569.09 200.27
- school        1    16.581 568.40 203.81
- G2.y          1   280.899 832.72 349.68

Step:  AIC=193.34
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    activities.x + absences.x + G1.x + failures.y + schoolsup.y + 
    absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- activities.x  1     2.164 555.20 192.84
- famsize       1     2.486 555.53 193.06
<none>                      553.04 193.34
- G1.x          1     3.357 556.40 193.66
- age           1     3.719 556.76 193.90
+ health.y      1     1.811 551.23 194.09
+ higher.y      1     1.726 551.31 194.15
+ activities.y  1     1.674 551.37 194.19
+ famrel.y      1     1.527 551.51 194.29
- Medu          1     4.415 557.46 194.38
+ guardian.x    2     4.167 548.87 194.45
+ famrel.x      1     1.223 551.82 194.50
+ higher.x      1     1.210 551.83 194.51
+ health.x      1     1.208 551.83 194.51
+ paid.x        1     1.034 552.01 194.63
- traveltime.x  1     4.801 557.84 194.65
+ Fedu          1     0.993 552.05 194.66
- internet      1     4.881 557.92 194.70
+ Dalc.y        1     0.888 552.15 194.73
+ romantic.x    1     0.866 552.17 194.75
+ Dalc.x        1     0.843 552.20 194.76
+ guardian.y    2     3.677 549.36 194.80
+ romantic.y    1     0.782 552.26 194.80
+ G2.x          1     0.650 552.39 194.90
+ Walc.x        1     0.614 552.43 194.92
+ Walc.y        1     0.609 552.43 194.92
+ address       1     0.595 552.45 194.93
+ goout.y       1     0.582 552.46 194.94
+ goout.x       1     0.498 552.54 195.00
+ famsup.x      1     0.485 552.56 195.01
- Mjob          4    14.217 567.26 195.04
+ famsup.y      1     0.424 552.62 195.05
+ G3.x          1     0.135 552.91 195.25
+ studytime.y   1     0.127 552.91 195.26
+ paid.y        1     0.127 552.91 195.26
+ studytime.x   1     0.071 552.97 195.30
+ freetime.y    1     0.060 552.98 195.30
+ traveltime.y  1     0.001 553.04 195.34
+ freetime.x    1     0.001 553.04 195.34
+ nursery       1     0.000 553.04 195.34
- absences.x    1     5.877 558.92 195.38
- absences.y    1     6.019 559.06 195.48
- Pstatus       1     6.101 559.14 195.54
+ Fjob          4     7.898 545.14 195.85
- failures.y    1     7.222 560.26 196.30
- failures.x    1     7.302 560.34 196.35
- G1.y          1     7.675 560.72 196.61
- schoolsup.y   1     7.746 560.79 196.66
- sex           1     8.491 561.53 197.16
- schoolsup.x   1     9.109 562.15 197.58
- reason        3    17.218 570.26 199.06
- school        1    17.899 570.94 203.51
- G2.y          1   283.283 836.32 349.33

Step:  AIC=192.84
G3.y ~ school + sex + age + famsize + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    absences.x + G1.x + failures.y + schoolsup.y + absences.y + 
    G1.y + G2.y

               Df Sum of Sq    RSS    AIC
- famsize       1     2.632 557.84 192.64
<none>                      555.20 192.84
+ activities.y  1     2.877 552.33 192.85
- G1.x          1     3.222 558.43 193.05
- age           1     3.555 558.76 193.27
+ activities.x  1     2.164 553.04 193.34
+ higher.y      1     2.049 553.16 193.42
+ famrel.y      1     1.667 553.54 193.69
+ health.y      1     1.634 553.57 193.71
+ higher.x      1     1.597 553.61 193.74
- Medu          1     4.264 559.47 193.76
+ famrel.x      1     1.365 553.84 193.90
+ guardian.x    2     4.238 550.97 193.91
+ paid.x        1     1.218 553.99 194.00
+ Dalc.y        1     1.086 554.12 194.09
+ health.x      1     1.075 554.13 194.10
+ Dalc.x        1     1.072 554.13 194.10
+ romantic.x    1     1.063 554.14 194.10
+ romantic.y    1     1.055 554.15 194.11
+ guardian.y    2     3.810 551.39 194.21
+ Fedu          1     0.813 554.39 194.28
- traveltime.x  1     5.039 560.24 194.29
- internet      1     5.087 560.29 194.32
+ Walc.x        1     0.735 554.47 194.33
+ Walc.y        1     0.719 554.49 194.34
+ G2.x          1     0.676 554.53 194.37
+ goout.y       1     0.482 554.72 194.50
- absences.x    1     5.423 560.63 194.55
- Pstatus       1     5.429 560.63 194.55
+ address       1     0.408 554.80 194.56
+ goout.x       1     0.401 554.80 194.56
+ famsup.x      1     0.366 554.84 194.58
+ famsup.y      1     0.315 554.89 194.62
+ studytime.y   1     0.225 554.98 194.68
- absences.y    1     5.656 560.86 194.71
+ studytime.x   1     0.157 555.05 194.73
+ freetime.y    1     0.118 555.09 194.75
+ G3.x          1     0.055 555.15 194.80
+ paid.y        1     0.045 555.16 194.80
+ freetime.x    1     0.015 555.19 194.83
+ traveltime.y  1     0.002 555.20 194.83
+ nursery       1     0.000 555.20 194.84
+ Fjob          4     8.415 546.79 195.00
- Mjob          4    15.194 570.40 195.15
- schoolsup.y   1     7.055 562.26 195.66
- failures.y    1     7.127 562.33 195.71
- failures.x    1     7.345 562.55 195.86
- G1.y          1     7.546 562.75 195.99
- sex           1     7.578 562.78 196.01
- schoolsup.x   1     8.255 563.46 196.47
- reason        3    17.151 572.36 198.46
- school        1    18.654 573.86 203.46
- G2.y          1   287.407 842.61 350.19

Step:  AIC=192.64
G3.y ~ school + sex + age + Pstatus + Medu + Mjob + reason + 
    internet + traveltime.x + failures.x + schoolsup.x + absences.x + 
    G1.x + failures.y + schoolsup.y + absences.y + G1.y + G2.y

               Df Sum of Sq    RSS    AIC
+ activities.y  1     3.046 554.79 192.55
<none>                      557.84 192.64
- G1.x          1     3.023 560.86 192.71
+ famsize       1     2.632 555.20 192.84
- age           1     3.353 561.19 192.93
- Medu          1     3.484 561.32 193.02
+ activities.x  1     2.310 555.53 193.06
+ higher.y      1     2.123 555.71 193.19
+ famrel.y      1     1.726 556.11 193.46
+ higher.x      1     1.670 556.17 193.50
- Pstatus       1     4.338 562.17 193.60
+ guardian.x    2     4.416 553.42 193.61
+ famrel.x      1     1.410 556.43 193.68
+ Dalc.y        1     1.386 556.45 193.69
+ health.y      1     1.378 556.46 193.70
+ Dalc.x        1     1.374 556.46 193.70
+ paid.x        1     1.288 556.55 193.76
- traveltime.x  1     4.625 562.46 193.80
+ guardian.y    2     3.983 553.85 193.91
- internet      1     4.878 562.71 193.97
+ Walc.x        1     0.946 556.89 193.99
+ romantic.y    1     0.934 556.90 194.00
+ romantic.x    1     0.930 556.91 194.01
+ Walc.y        1     0.920 556.92 194.01
+ G2.x          1     0.878 556.96 194.04
+ health.x      1     0.862 556.97 194.05
- Mjob          4    14.058 571.89 194.15
+ Fedu          1     0.672 557.16 194.18
+ goout.y       1     0.542 557.29 194.27
+ famsup.x      1     0.530 557.31 194.28
+ famsup.y      1     0.484 557.35 194.31
+ goout.x       1     0.451 557.39 194.33
+ studytime.y   1     0.314 557.52 194.43
+ address       1     0.247 557.59 194.47
+ studytime.x   1     0.223 557.61 194.49
+ freetime.y    1     0.101 557.74 194.57
- absences.y    1     5.789 563.63 194.59
+ paid.y        1     0.040 557.80 194.61
+ nursery       1     0.035 557.80 194.62
+ G3.x          1     0.020 557.82 194.63
+ freetime.x    1     0.008 557.83 194.64
+ traveltime.y  1     0.004 557.83 194.64
- absences.x    1     5.921 563.76 194.68
- schoolsup.y   1     6.737 564.57 195.23
- failures.y    1     6.793 564.63 195.27
- G1.y          1     6.800 564.64 195.27
+ Fjob          4     7.441 550.40 195.51
- failures.x    1     7.304 565.14 195.61
- schoolsup.x   1     7.976 565.81 196.07
- sex           1     8.574 566.41 196.47
- reason        3    16.932 574.77 198.06
- school        1    19.199 577.04 203.57
- G2.y          1   291.148 848.98 351.07

Step:  AIC=192.55
G3.y ~ school + sex + age + Pstatus + Medu + Mjob + reason + 
    internet + traveltime.x + failures.x + schoolsup.x + absences.x + 
    G1.x + failures.y + schoolsup.y + absences.y + G1.y + G2.y + 
    activities.y

               Df Sum of Sq    RSS    AIC
<none>                      554.79 192.55
- activities.y  1     3.046 557.84 192.64
+ famsize       1     2.463 552.33 192.85
- G1.x          1     3.433 558.22 192.91
- age           1     3.585 558.38 193.01
- Medu          1     3.655 558.45 193.06
+ higher.y      1     1.667 553.12 193.40
- Mjob          4    13.054 567.84 193.44
+ famrel.y      1     1.549 553.24 193.48
+ health.y      1     1.547 553.24 193.48
- traveltime.x  1     4.328 559.12 193.52
+ guardian.x    2     4.280 550.51 193.59
+ famrel.x      1     1.287 553.50 193.66
+ higher.x      1     1.282 553.51 193.67
- internet      1     4.611 559.40 193.71
+ Dalc.y        1     1.109 553.68 193.79
+ Dalc.x        1     1.102 553.69 193.79
+ health.x      1     1.035 553.76 193.84
+ paid.x        1     1.016 553.77 193.85
+ guardian.y    2     3.858 550.93 193.89
+ activities.x  1     0.956 553.83 193.89
+ Fedu          1     0.867 553.92 193.95
+ G2.x          1     0.789 554.00 194.01
+ Walc.y        1     0.753 554.04 194.03
+ Walc.x        1     0.749 554.04 194.03
+ famsup.x      1     0.731 554.06 194.05
+ goout.y       1     0.729 554.06 194.05
- Pstatus       1     5.110 559.90 194.05
+ romantic.y    1     0.688 554.10 194.08
+ famsup.y      1     0.676 554.11 194.09
+ romantic.x    1     0.674 554.12 194.09
+ goout.x       1     0.561 554.23 194.16
+ address       1     0.448 554.34 194.24
+ studytime.y   1     0.163 554.63 194.44
+ G3.x          1     0.123 554.67 194.47
+ studytime.x   1     0.117 554.67 194.47
+ paid.y        1     0.106 554.68 194.48
+ freetime.y    1     0.028 554.76 194.53
+ nursery       1     0.027 554.76 194.53
+ traveltime.y  1     0.010 554.78 194.54
+ freetime.x    1     0.000 554.79 194.55
- absences.y    1     6.380 561.17 194.92
- absences.x    1     6.543 561.33 195.03
- schoolsup.y   1     6.613 561.40 195.08
- G1.y          1     6.810 561.60 195.21
- failures.y    1     7.117 561.91 195.42
- failures.x    1     7.135 561.93 195.43
+ Fjob          4     6.893 547.90 195.77
- schoolsup.x   1     7.983 562.77 196.01
- sex           1     9.879 564.67 197.29
- reason        3    17.009 571.80 198.09
- school        1    18.401 573.19 203.02
- G2.y          1   285.332 840.12 349.06

Call:
lm(formula = G3.y ~ school + sex + age + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    absences.x + G1.x + failures.y + schoolsup.y + absences.y + 
    G1.y + G2.y + activities.y, data = data)

Coefficients:
     (Intercept)          schoolMS              sexM               age  
        -0.87412          -0.83115          -0.37189           0.09974  
        PstatusT              Medu        Mjobhealth         Mjobother  
        -0.40567          -0.12478           0.18039          -0.29048  
    Mjobservices       Mjobteacher        reasonhome       reasonother  
         0.09746           0.26072           0.15733          -0.67047  
reasonreputation       internetyes      traveltime.x        failures.x  
        -0.03474           0.32879           0.16532          -0.24495  
  schoolsup.xyes        absences.x              G1.x        failures.y  
        -1.70934          -0.02110           0.04075          -0.34366  
  schoolsup.yyes        absences.y              G1.y              G2.y  
         1.59120           0.03221           0.12161           0.84698  
 activities.yyes  
         0.18731  

#+end_example


Assim, utilizaremos a seguinte fórmula:
#+NAME: e79cedbb-e7b0-40da-b14b-f53f27ac4b28
#+begin_src ein-r :session localhost :results output :exports both :eval no
modreg_trein_AIC_y <- lm(formula = G3.y ~ school + sex + age + Pstatus + Medu + Mjob + 
    reason + internet + traveltime.x + failures.x + schoolsup.x + 
    absences.x + G1.x + failures.y + schoolsup.y + absences.y + 
    G1.y + G2.y + activities.y, data = data)
#+end_src

**** Teste de Shapiro 
Finalmente, aplicar o teste de =shapiro= nos resíduos

#+NAME: 12369004-4b59-4327-899e-2326570ed0b0
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC_x$residuals)
#+end_src

#+RESULTS: 12369004-4b59-4327-899e-2326570ed0b0
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC_x$residuals
: W = 0.80768, p-value < 2.2e-16
: 

#+NAME: e89f74dd-0cb9-41a3-87c1-fa3b47a8cf1f
#+begin_src ein-r :session localhost :results output :exports both :eval no 
  shapiro.test(modreg_trein_AIC_y$residuals)
#+end_src

#+RESULTS: e89f74dd-0cb9-41a3-87c1-fa3b47a8cf1f
: 
: 	Shapiro-Wilk normality test
: 
: data:  modreg_trein_AIC_y$residuals
: W = 0.82087, p-value < 2.2e-16
: 

Para ambas análises, p-value < 2.2e-16 <=> p-value muito menor que 0.05 => rejeitamos H0, em que, H0: resíduo distribuido normalmente.

Portanto, o resíduo não é distribuido normalmente.

